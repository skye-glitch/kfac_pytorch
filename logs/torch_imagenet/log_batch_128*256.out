
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0001 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0001 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.9646) train/accuracy tensor(0.0017) train/lr 0.58864 val/loss tensor(6.8979) val/accuracy tensor(0.0023)
epoch 2 train/loss tensor(6.8324) train/accuracy tensor(0.0048) train/lr 1.16596 val/loss tensor(6.7803) val/accuracy tensor(0.0076)
epoch 3 train/loss tensor(6.6743) train/accuracy tensor(0.0110) train/lr 1.74328 val/loss tensor(6.5047) val/accuracy tensor(0.0151)
epoch 4 train/loss tensor(6.3277) train/accuracy tensor(0.0230) train/lr 2.3206 val/loss tensor(6.3099) val/accuracy tensor(0.0249)
epoch 5 train/loss tensor(6.0754) train/accuracy tensor(0.0373) train/lr 2.584873086419753 val/loss tensor(5.9609) val/accuracy tensor(0.0465)
epoch 6 train/loss tensor(5.9205) train/accuracy tensor(0.0485) train/lr 2.524410311111111 val/loss tensor(5.7756) val/accuracy tensor(0.0616)
epoch 7 train/loss tensor(5.7898) train/accuracy tensor(0.0596) train/lr 2.4646630716049387 val/loss tensor(5.6632) val/accuracy tensor(0.0722)
epoch 8 train/loss tensor(5.6805) train/accuracy tensor(0.0691) train/lr 2.4056313679012344 val/loss tensor(5.5427) val/accuracy tensor(0.0799)
epoch 9 train/loss tensor(5.5854) train/accuracy tensor(0.0783) train/lr 2.3473152 val/loss tensor(5.4755) val/accuracy tensor(0.0895)
epoch 10 train/loss tensor(5.4988) train/accuracy tensor(0.0874) train/lr 2.2897145679012345 val/loss tensor(5.3498) val/accuracy tensor(0.1050)
epoch 11 train/loss tensor(5.4247) train/accuracy tensor(0.0956) train/lr 2.2328294716049384 val/loss tensor(5.2577) val/accuracy tensor(0.1129)
epoch 12 train/loss tensor(5.3535) train/accuracy tensor(0.1038) train/lr 2.1766599111111113 val/loss tensor(5.1872) val/accuracy tensor(0.1194)
epoch 13 train/loss tensor(5.2904) train/accuracy tensor(0.1113) train/lr 2.1212058864197534 val/loss tensor(5.1041) val/accuracy tensor(0.1308)
epoch 14 train/loss tensor(5.2293) train/accuracy tensor(0.1184) train/lr 2.066467397530864 val/loss tensor(5.0249) val/accuracy tensor(0.1394)
epoch 15 train/loss tensor(5.1708) train/accuracy tensor(0.1262) train/lr 2.0124444444444447 val/loss tensor(4.9887) val/accuracy tensor(0.1471)
epoch 16 train/loss tensor(5.1199) train/accuracy tensor(0.1331) train/lr 1.9591370271604935 val/loss tensor(4.9000) val/accuracy tensor(0.1579)
epoch 17 train/loss tensor(5.0683) train/accuracy tensor(0.1396) train/lr 1.9065451456790126 val/loss tensor(4.8853) val/accuracy tensor(0.1587)
epoch 18 train/loss tensor(5.0219) train/accuracy tensor(0.1457) train/lr 1.8546688000000005 val/loss tensor(4.8015) val/accuracy tensor(0.1697)
epoch 19 train/loss tensor(4.9776) train/accuracy tensor(0.1519) train/lr 1.8035079901234565 val/loss tensor(4.7831) val/accuracy tensor(0.1757)
epoch 20 train/loss tensor(4.9356) train/accuracy tensor(0.1576) train/lr 1.7530627160493828 val/loss tensor(4.7257) val/accuracy tensor(0.1807)
epoch 21 train/loss tensor(4.8963) train/accuracy tensor(0.1631) train/lr 1.7033329777777777 val/loss tensor(4.7016) val/accuracy tensor(0.1841)
epoch 22 train/loss tensor(4.8603) train/accuracy tensor(0.1686) train/lr 1.654318775308642 val/loss tensor(4.6420) val/accuracy tensor(0.1932)
epoch 23 train/loss tensor(4.8231) train/accuracy tensor(0.1740) train/lr 1.6060201086419754 val/loss tensor(4.6009) val/accuracy tensor(0.1989)
epoch 24 train/loss tensor(4.7896) train/accuracy tensor(0.1785) train/lr 1.5584369777777782 val/loss tensor(4.5546) val/accuracy tensor(0.2072)
epoch 25 train/loss tensor(4.7573) train/accuracy tensor(0.1835) train/lr 1.5115693827160495 val/loss tensor(4.5201) val/accuracy tensor(0.2122)
epoch 26 train/loss tensor(4.7263) train/accuracy tensor(0.1887) train/lr 1.4654173234567902 val/loss tensor(4.4939) val/accuracy tensor(0.2182)
epoch 27 train/loss tensor(4.6971) train/accuracy tensor(0.1935) train/lr 1.4199807999999998 val/loss tensor(4.4675) val/accuracy tensor(0.2213)
epoch 28 train/loss tensor(4.6688) train/accuracy tensor(0.1972) train/lr 1.375259812345679 val/loss tensor(4.4145) val/accuracy tensor(0.2313)
epoch 29 train/loss tensor(4.6411) train/accuracy tensor(0.2020) train/lr 1.3312543604938272 val/loss tensor(4.4038) val/accuracy tensor(0.2316)
epoch 30 train/loss tensor(4.6177) train/accuracy tensor(0.2055) train/lr 1.2879644444444447 val/loss tensor(4.3734) val/accuracy tensor(0.2365)
epoch 31 train/loss tensor(4.5913) train/accuracy tensor(0.2095) train/lr 1.2453900641975308 val/loss tensor(4.3476) val/accuracy tensor(0.2409)
epoch 32 train/loss tensor(4.5696) train/accuracy tensor(0.2131) train/lr 1.203531219753086 val/loss tensor(4.3217) val/accuracy tensor(0.2445)
epoch 33 train/loss tensor(4.5447) train/accuracy tensor(0.2170) train/lr 1.162387911111111 val/loss tensor(4.2945) val/accuracy tensor(0.2512)
epoch 34 train/loss tensor(4.5244) train/accuracy tensor(0.2207) train/lr 1.121960138271605 val/loss tensor(4.2972) val/accuracy tensor(0.2507)
epoch 35 train/loss tensor(4.5058) train/accuracy tensor(0.2238) train/lr 1.082247901234568 val/loss tensor(4.2537) val/accuracy tensor(0.2559)
epoch 36 train/loss tensor(4.4833) train/accuracy tensor(0.2279) train/lr 1.0432512 val/loss tensor(4.2607) val/accuracy tensor(0.2550)
epoch 37 train/loss tensor(4.4651) train/accuracy tensor(0.2301) train/lr 1.0049700345679013 val/loss tensor(4.2164) val/accuracy tensor(0.2620)
epoch 38 train/loss tensor(4.4459) train/accuracy tensor(0.2335) train/lr 0.9674044049382714 val/loss tensor(4.1932) val/accuracy tensor(0.2671)
epoch 39 train/loss tensor(4.4283) train/accuracy tensor(0.2368) train/lr 0.930554311111111 val/loss tensor(4.1875) val/accuracy tensor(0.2683)
epoch 40 train/loss tensor(4.4124) train/accuracy tensor(0.2390) train/lr 0.8944197530864199 val/loss tensor(4.1679) val/accuracy tensor(0.2719)
epoch 41 train/loss tensor(4.3973) train/accuracy tensor(0.2417) train/lr 0.8590007308641977 val/loss tensor(4.1569) val/accuracy tensor(0.2740)
epoch 42 train/loss tensor(4.3805) train/accuracy tensor(0.2448) train/lr 0.8242972444444444 val/loss tensor(4.1331) val/accuracy tensor(0.2765)
epoch 43 train/loss tensor(4.3689) train/accuracy tensor(0.2466) train/lr 0.7903092938271603 val/loss tensor(4.1159) val/accuracy tensor(0.2815)
epoch 44 train/loss tensor(4.3527) train/accuracy tensor(0.2493) train/lr 0.7570368790123455 val/loss tensor(4.0930) val/accuracy tensor(0.2856)
epoch 45 train/loss tensor(4.3382) train/accuracy tensor(0.2519) train/lr 0.72448 val/loss tensor(4.0931) val/accuracy tensor(0.2848)
epoch 46 train/loss tensor(4.3270) train/accuracy tensor(0.2536) train/lr 0.6926386567901236 val/loss tensor(4.0873) val/accuracy tensor(0.2864)
epoch 47 train/loss tensor(4.3174) train/accuracy tensor(0.2554) train/lr 0.6615128493827159 val/loss tensor(4.0682) val/accuracy tensor(0.2896)
epoch 48 train/loss tensor(4.3030) train/accuracy tensor(0.2578) train/lr 0.6311025777777778 val/loss tensor(4.0461) val/accuracy tensor(0.2941)
epoch 49 train/loss tensor(4.2943) train/accuracy tensor(0.2594) train/lr 0.6014078419753088 val/loss tensor(4.0420) val/accuracy tensor(0.2952)
epoch 50 train/loss tensor(4.2836) train/accuracy tensor(0.2612) train/lr 0.5724286419753086 val/loss tensor(4.0435) val/accuracy tensor(0.2935)
epoch 51 train/loss tensor(4.2736) train/accuracy tensor(0.2633) train/lr 0.5441649777777778 val/loss tensor(4.0173) val/accuracy tensor(0.2997)
epoch 52 train/loss tensor(4.2634) train/accuracy tensor(0.2648) train/lr 0.5166168493827162 val/loss tensor(4.0213) val/accuracy tensor(0.2978)
epoch 53 train/loss tensor(4.2572) train/accuracy tensor(0.2661) train/lr 0.4897842567901234 val/loss tensor(4.0009) val/accuracy tensor(0.3010)
epoch 54 train/loss tensor(4.2473) train/accuracy tensor(0.2675) train/lr 0.4636672000000001 val/loss tensor(3.9960) val/accuracy tensor(0.3029)
epoch 55 train/loss tensor(4.2388) train/accuracy tensor(0.2691) train/lr 0.43826567901234553 val/loss tensor(3.9834) val/accuracy tensor(0.3052)
epoch 56 train/loss tensor(4.2314) train/accuracy tensor(0.2706) train/lr 0.4135796938271605 val/loss tensor(3.9702) val/accuracy tensor(0.3073)
epoch 57 train/loss tensor(4.2253) train/accuracy tensor(0.2718) train/lr 0.38960924444444456 val/loss tensor(3.9692) val/accuracy tensor(0.3083)
epoch 58 train/loss tensor(4.2188) train/accuracy tensor(0.2731) train/lr 0.36635433086419744 val/loss tensor(3.9579) val/accuracy tensor(0.3082)
epoch 59 train/loss tensor(4.2110) train/accuracy tensor(0.2738) train/lr 0.34381495308641974 val/loss tensor(3.9537) val/accuracy tensor(0.3108)
epoch 60 train/loss tensor(4.2052) train/accuracy tensor(0.2755) train/lr 0.3219911111111112 val/loss tensor(3.9493) val/accuracy tensor(0.3105)
epoch 61 train/loss tensor(4.2024) train/accuracy tensor(0.2758) train/lr 0.3008828049382715 val/loss tensor(3.9442) val/accuracy tensor(0.3100)
epoch 62 train/loss tensor(4.1942) train/accuracy tensor(0.2771) train/lr 0.2804900345679012 val/loss tensor(3.9431) val/accuracy tensor(0.3104)
epoch 63 train/loss tensor(4.1897) train/accuracy tensor(0.2780) train/lr 0.26081280000000007 val/loss tensor(3.9286) val/accuracy tensor(0.3139)
epoch 64 train/loss tensor(4.1863) train/accuracy tensor(0.2787) train/lr 0.24185110123456785 val/loss tensor(3.9327) val/accuracy tensor(0.3132)
epoch 65 train/loss tensor(4.1814) train/accuracy tensor(0.2796) train/lr 0.22360493827160496 val/loss tensor(3.9218) val/accuracy tensor(0.3157)
epoch 66 train/loss tensor(4.1775) train/accuracy tensor(0.2803) train/lr 0.20607431111111119 val/loss tensor(3.9192) val/accuracy tensor(0.3172)
epoch 67 train/loss tensor(4.1724) train/accuracy tensor(0.2809) train/lr 0.18925921975308638 val/loss tensor(3.9178) val/accuracy tensor(0.3160)
epoch 68 train/loss tensor(4.1705) train/accuracy tensor(0.2816) train/lr 0.1731596641975309 val/loss tensor(3.9159) val/accuracy tensor(0.3151)
epoch 69 train/loss tensor(4.1677) train/accuracy tensor(0.2817) train/lr 0.1577756444444444 val/loss tensor(3.9129) val/accuracy tensor(0.3177)
epoch 70 train/loss tensor(4.1650) train/accuracy tensor(0.2821) train/lr 0.14310716049382716 val/loss tensor(3.9046) val/accuracy tensor(0.3175)
epoch 71 train/loss tensor(4.1602) train/accuracy tensor(0.2837) train/lr 0.12915421234567906 val/loss tensor(3.9071) val/accuracy tensor(0.3186)
epoch 72 train/loss tensor(4.1601) train/accuracy tensor(0.2833) train/lr 0.11591679999999994 val/loss tensor(3.9017) val/accuracy tensor(0.3190)
epoch 73 train/loss tensor(4.1578) train/accuracy tensor(0.2840) train/lr 0.10339492345679012 val/loss tensor(3.9001) val/accuracy tensor(0.3179)
epoch 74 train/loss tensor(4.1536) train/accuracy tensor(0.2846) train/lr 0.09158858271604943 val/loss tensor(3.8998) val/accuracy tensor(0.3207)
epoch 75 train/loss tensor(4.1537) train/accuracy tensor(0.2846) train/lr 0.08049777777777775 val/loss tensor(3.8971) val/accuracy tensor(0.3190)
epoch 76 train/loss tensor(4.1530) train/accuracy tensor(0.2846) train/lr 0.0701225086419753 val/loss tensor(3.9014) val/accuracy tensor(0.3198)
epoch 77 train/loss tensor(4.1522) train/accuracy tensor(0.2849) train/lr 0.06046277530864202 val/loss tensor(3.8916) val/accuracy tensor(0.3203)
epoch 78 train/loss tensor(4.1481) train/accuracy tensor(0.2854) train/lr 0.05151857777777776 val/loss tensor(3.8906) val/accuracy tensor(0.3196)
epoch 79 train/loss tensor(4.1483) train/accuracy tensor(0.2855) train/lr 0.043289916049382725 val/loss tensor(3.8940) val/accuracy tensor(0.3201)
epoch 80 train/loss tensor(4.1479) train/accuracy tensor(0.2860) train/lr 0.035776790123456824 val/loss tensor(3.8873) val/accuracy tensor(0.3211)
epoch 81 train/loss tensor(4.1474) train/accuracy tensor(0.2852) train/lr 0.028979199999999986 val/loss tensor(3.8873) val/accuracy tensor(0.3210)
epoch 82 train/loss tensor(4.1459) train/accuracy tensor(0.2858) train/lr 0.022897145679012357 val/loss tensor(3.8895) val/accuracy tensor(0.3209)
epoch 83 train/loss tensor(4.1457) train/accuracy tensor(0.2856) train/lr 0.017530627160493802 val/loss tensor(3.8856) val/accuracy tensor(0.3204)
epoch 84 train/loss tensor(4.1445) train/accuracy tensor(0.2864) train/lr 0.01287964444444444 val/loss tensor(3.8876) val/accuracy tensor(0.3206)
epoch 85 train/loss tensor(4.1459) train/accuracy tensor(0.2861) train/lr 0.008944197530864206 val/loss tensor(3.8910) val/accuracy tensor(0.3208)
epoch 86 train/loss tensor(4.1433) train/accuracy tensor(0.2865) train/lr 0.005724286419753074 val/loss tensor(3.8870) val/accuracy tensor(0.3223)
epoch 87 train/loss tensor(4.1450) train/accuracy tensor(0.2864) train/lr 0.00321991111111111 val/loss tensor(3.8899) val/accuracy tensor(0.3210)
epoch 88 train/loss tensor(4.1449) train/accuracy tensor(0.2860) train/lr 0.0014310716049382758 val/loss tensor(3.8841) val/accuracy tensor(0.3212)
epoch 89 train/loss tensor(4.1474) train/accuracy tensor(0.2855) train/lr 0.00035776790123456543 val/loss tensor(3.8936) val/accuracy tensor(0.3210)
epoch 90 train/loss tensor(4.1447) train/accuracy tensor(0.2861) train/lr 0.0 val/loss tensor(3.8900) val/accuracy tensor(0.3207)

Training time: 0:36:49.592984
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0001 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0001 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.9648) train/accuracy tensor(0.0020) train/lr 0.58864 val/loss tensor(6.8902) val/accuracy tensor(0.0020)
epoch 2 train/loss tensor(6.8216) train/accuracy tensor(0.0046) train/lr 1.16596 val/loss tensor(6.7625) val/accuracy tensor(0.0058)
epoch 3 train/loss tensor(6.6615) train/accuracy tensor(0.0098) train/lr 1.74328 val/loss tensor(6.5485) val/accuracy tensor(0.0133)
epoch 4 train/loss tensor(6.3656) train/accuracy tensor(0.0213) train/lr 2.3206 val/loss tensor(6.2413) val/accuracy tensor(0.0273)
epoch 5 train/loss tensor(6.0998) train/accuracy tensor(0.0355) train/lr 2.39497520661157 val/loss tensor(6.0064) val/accuracy tensor(0.0433)
epoch 6 train/loss tensor(5.9318) train/accuracy tensor(0.0482) train/lr 2.3001341884297517 val/loss tensor(5.7930) val/accuracy tensor(0.0592)
epoch 7 train/loss tensor(5.8105) train/accuracy tensor(0.0584) train/lr 2.2072091504132234 val/loss tensor(5.6723) val/accuracy tensor(0.0731)
epoch 8 train/loss tensor(5.7111) train/accuracy tensor(0.0675) train/lr 2.116200092561983 val/loss tensor(5.5562) val/accuracy tensor(0.0820)
epoch 9 train/loss tensor(5.6203) train/accuracy tensor(0.0762) train/lr 2.0271070148760333 val/loss tensor(5.4574) val/accuracy tensor(0.0923)
epoch 10 train/loss tensor(5.5384) train/accuracy tensor(0.0837) train/lr 1.9399299173553717 val/loss tensor(5.3555) val/accuracy tensor(0.1027)
epoch 11 train/loss tensor(5.4663) train/accuracy tensor(0.0917) train/lr 1.8546688000000005 val/loss tensor(5.3125) val/accuracy tensor(0.1083)
epoch 12 train/loss tensor(5.4000) train/accuracy tensor(0.0990) train/lr 1.7713236628099176 val/loss tensor(5.2297) val/accuracy tensor(0.1157)
epoch 13 train/loss tensor(5.3420) train/accuracy tensor(0.1059) train/lr 1.689894505785124 val/loss tensor(5.1353) val/accuracy tensor(0.1282)
epoch 14 train/loss tensor(5.2896) train/accuracy tensor(0.1119) train/lr 1.61038132892562 val/loss tensor(5.0781) val/accuracy tensor(0.1333)
epoch 15 train/loss tensor(5.2398) train/accuracy tensor(0.1178) train/lr 1.532784132231405 val/loss tensor(5.0208) val/accuracy tensor(0.1435)
epoch 16 train/loss tensor(5.1965) train/accuracy tensor(0.1237) train/lr 1.4571029157024795 val/loss tensor(4.9734) val/accuracy tensor(0.1445)
epoch 17 train/loss tensor(5.1537) train/accuracy tensor(0.1296) train/lr 1.383337679338843 val/loss tensor(4.9433) val/accuracy tensor(0.1500)
epoch 18 train/loss tensor(5.1125) train/accuracy tensor(0.1342) train/lr 1.311488423140496 val/loss tensor(4.8720) val/accuracy tensor(0.1568)
epoch 19 train/loss tensor(5.0766) train/accuracy tensor(0.1390) train/lr 1.2415551471074382 val/loss tensor(4.8815) val/accuracy tensor(0.1573)
epoch 20 train/loss tensor(5.0406) train/accuracy tensor(0.1439) train/lr 1.1735378512396695 val/loss tensor(4.8392) val/accuracy tensor(0.1636)
epoch 21 train/loss tensor(5.0084) train/accuracy tensor(0.1481) train/lr 1.10743653553719 val/loss tensor(4.7733) val/accuracy tensor(0.1726)
epoch 22 train/loss tensor(4.9777) train/accuracy tensor(0.1527) train/lr 1.0432512 val/loss tensor(4.7539) val/accuracy tensor(0.1737)
epoch 23 train/loss tensor(4.9483) train/accuracy tensor(0.1560) train/lr 0.9809818446280991 val/loss tensor(4.7225) val/accuracy tensor(0.1800)
epoch 24 train/loss tensor(4.9229) train/accuracy tensor(0.1604) train/lr 0.9206284694214879 val/loss tensor(4.6934) val/accuracy tensor(0.1840)
epoch 25 train/loss tensor(4.8978) train/accuracy tensor(0.1641) train/lr 0.8621910743801652 val/loss tensor(4.6799) val/accuracy tensor(0.1866)
epoch 26 train/loss tensor(4.8774) train/accuracy tensor(0.1667) train/lr 0.8056696595041324 val/loss tensor(4.6374) val/accuracy tensor(0.1941)
epoch 27 train/loss tensor(4.8542) train/accuracy tensor(0.1703) train/lr 0.7510642247933882 val/loss tensor(4.6171) val/accuracy tensor(0.1941)
epoch 28 train/loss tensor(4.8342) train/accuracy tensor(0.1731) train/lr 0.698374770247934 val/loss tensor(4.6034) val/accuracy tensor(0.1982)
epoch 29 train/loss tensor(4.8162) train/accuracy tensor(0.1756) train/lr 0.6476012958677687 val/loss tensor(4.5678) val/accuracy tensor(0.2040)
epoch 30 train/loss tensor(4.8004) train/accuracy tensor(0.1773) train/lr 0.5987438016528926 val/loss tensor(4.5606) val/accuracy tensor(0.2054)
epoch 31 train/loss tensor(4.7844) train/accuracy tensor(0.1802) train/lr 0.5518022876033059 val/loss tensor(4.5412) val/accuracy tensor(0.2065)
epoch 32 train/loss tensor(4.7721) train/accuracy tensor(0.1825) train/lr 0.5067767537190083 val/loss tensor(4.5256) val/accuracy tensor(0.2090)
epoch 33 train/loss tensor(4.7566) train/accuracy tensor(0.1846) train/lr 0.4636672000000001 val/loss tensor(4.5081) val/accuracy tensor(0.2132)
epoch 34 train/loss tensor(4.7454) train/accuracy tensor(0.1863) train/lr 0.422473626446281 val/loss tensor(4.4989) val/accuracy tensor(0.2138)
epoch 35 train/loss tensor(4.7357) train/accuracy tensor(0.1878) train/lr 0.38319603305785127 val/loss tensor(4.4976) val/accuracy tensor(0.2151)
epoch 36 train/loss tensor(4.7238) train/accuracy tensor(0.1896) train/lr 0.34583441983471075 val/loss tensor(4.4847) val/accuracy tensor(0.2173)
epoch 37 train/loss tensor(4.7144) train/accuracy tensor(0.1907) train/lr 0.31038878677685955 val/loss tensor(4.4694) val/accuracy tensor(0.2192)
epoch 38 train/loss tensor(4.7074) train/accuracy tensor(0.1925) train/lr 0.2768591338842975 val/loss tensor(4.4620) val/accuracy tensor(0.2192)
epoch 39 train/loss tensor(4.7001) train/accuracy tensor(0.1933) train/lr 0.24524546115702478 val/loss tensor(4.4538) val/accuracy tensor(0.2206)
epoch 40 train/loss tensor(4.6928) train/accuracy tensor(0.1942) train/lr 0.2155477685950413 val/loss tensor(4.4443) val/accuracy tensor(0.2236)
epoch 41 train/loss tensor(4.6861) train/accuracy tensor(0.1952) train/lr 0.18776605619834705 val/loss tensor(4.4414) val/accuracy tensor(0.2253)
epoch 42 train/loss tensor(4.6810) train/accuracy tensor(0.1959) train/lr 0.1619003239669421 val/loss tensor(4.4358) val/accuracy tensor(0.2236)
epoch 43 train/loss tensor(4.6768) train/accuracy tensor(0.1971) train/lr 0.1379505719008264 val/loss tensor(4.4282) val/accuracy tensor(0.2245)
epoch 44 train/loss tensor(4.6713) train/accuracy tensor(0.1980) train/lr 0.11591679999999994 val/loss tensor(4.4264) val/accuracy tensor(0.2248)
epoch 45 train/loss tensor(4.6695) train/accuracy tensor(0.1985) train/lr 0.09579900826446275 val/loss tensor(4.4255) val/accuracy tensor(0.2265)
epoch 46 train/loss tensor(4.6670) train/accuracy tensor(0.1981) train/lr 0.07759719669421493 val/loss tensor(4.4262) val/accuracy tensor(0.2262)
epoch 47 train/loss tensor(4.6661) train/accuracy tensor(0.1986) train/lr 0.061311365289256244 val/loss tensor(4.4214) val/accuracy tensor(0.2252)
epoch 48 train/loss tensor(4.6635) train/accuracy tensor(0.1992) train/lr 0.04694151404958682 val/loss tensor(4.4164) val/accuracy tensor(0.2272)
epoch 49 train/loss tensor(4.6637) train/accuracy tensor(0.1991) train/lr 0.03448764297520664 val/loss tensor(4.4154) val/accuracy tensor(0.2260)
epoch 50 train/loss tensor(4.6605) train/accuracy tensor(0.1996) train/lr 0.02394975206611572 val/loss tensor(4.4208) val/accuracy tensor(0.2284)
epoch 51 train/loss tensor(4.6589) train/accuracy tensor(0.1994) train/lr 0.015327841322314061 val/loss tensor(4.4164) val/accuracy tensor(0.2265)
epoch 52 train/loss tensor(4.6575) train/accuracy tensor(0.2002) train/lr 0.00862191074380166 val/loss tensor(4.4121) val/accuracy tensor(0.2286)
epoch 53 train/loss tensor(4.6579) train/accuracy tensor(0.1996) train/lr 0.0038319603305785152 val/loss tensor(4.4116) val/accuracy tensor(0.2272)
epoch 54 train/loss tensor(4.6596) train/accuracy tensor(0.1999) train/lr 0.0009579900826446288 val/loss tensor(4.4175) val/accuracy tensor(0.2259)
epoch 55 train/loss tensor(4.6589) train/accuracy tensor(0.1996) train/lr 0.0 val/loss tensor(4.4138) val/accuracy tensor(0.2286)

Training time: 0:21:50.782855
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0005 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0005 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8694) train/accuracy tensor(0.0042) train/lr 0.58864 val/loss tensor(6.8155) val/accuracy tensor(0.0054)
epoch 2 train/loss tensor(6.4235) train/accuracy tensor(0.0194) train/lr 1.16596 val/loss tensor(6.3161) val/accuracy tensor(0.0232)
epoch 3 train/loss tensor(5.9806) train/accuracy tensor(0.0433) train/lr 1.74328 val/loss tensor(5.9846) val/accuracy tensor(0.0458)
epoch 4 train/loss tensor(5.6931) train/accuracy tensor(0.0670) train/lr 2.3206 val/loss tensor(5.5841) val/accuracy tensor(0.0730)
epoch 5 train/loss tensor(5.4604) train/accuracy tensor(0.0913) train/lr 2.584873086419753 val/loss tensor(5.3545) val/accuracy tensor(0.0977)
epoch 6 train/loss tensor(5.2421) train/accuracy tensor(0.1169) train/lr 2.524410311111111 val/loss tensor(5.1443) val/accuracy tensor(0.1266)
epoch 7 train/loss tensor(5.0297) train/accuracy tensor(0.1442) train/lr 2.4646630716049387 val/loss tensor(4.9103) val/accuracy tensor(0.1523)
epoch 8 train/loss tensor(4.8689) train/accuracy tensor(0.1673) train/lr 2.4056313679012344 val/loss tensor(4.7470) val/accuracy tensor(0.1770)
epoch 9 train/loss tensor(4.7081) train/accuracy tensor(0.1914) train/lr 2.3473152 val/loss tensor(4.6383) val/accuracy tensor(0.1947)
epoch 10 train/loss tensor(4.5699) train/accuracy tensor(0.2136) train/lr 2.2897145679012345 val/loss tensor(4.5218) val/accuracy tensor(0.2134)
epoch 11 train/loss tensor(4.4409) train/accuracy tensor(0.2347) train/lr 2.2328294716049384 val/loss tensor(4.2622) val/accuracy tensor(0.2555)
epoch 12 train/loss tensor(4.3352) train/accuracy tensor(0.2530) train/lr 2.1766599111111113 val/loss tensor(4.2184) val/accuracy tensor(0.2662)
epoch 13 train/loss tensor(4.2287) train/accuracy tensor(0.2711) train/lr 2.1212058864197534 val/loss tensor(4.1439) val/accuracy tensor(0.2757)
epoch 14 train/loss tensor(4.1369) train/accuracy tensor(0.2877) train/lr 2.066467397530864 val/loss tensor(4.0484) val/accuracy tensor(0.2934)
epoch 15 train/loss tensor(4.0576) train/accuracy tensor(0.3027) train/lr 2.0124444444444447 val/loss tensor(3.9846) val/accuracy tensor(0.3034)
epoch 16 train/loss tensor(3.9778) train/accuracy tensor(0.3172) train/lr 1.9591370271604935 val/loss tensor(3.9353) val/accuracy tensor(0.3083)
epoch 17 train/loss tensor(3.9040) train/accuracy tensor(0.3314) train/lr 1.9065451456790126 val/loss tensor(3.7760) val/accuracy tensor(0.3501)
epoch 18 train/loss tensor(3.8455) train/accuracy tensor(0.3428) train/lr 1.8546688000000005 val/loss tensor(3.7375) val/accuracy tensor(0.3517)
epoch 19 train/loss tensor(3.7806) train/accuracy tensor(0.3552) train/lr 1.8035079901234565 val/loss tensor(3.6619) val/accuracy tensor(0.3655)
epoch 20 train/loss tensor(3.7301) train/accuracy tensor(0.3652) train/lr 1.7530627160493828 val/loss tensor(3.5604) val/accuracy tensor(0.3861)
epoch 21 train/loss tensor(3.6862) train/accuracy tensor(0.3741) train/lr 1.7033329777777777 val/loss tensor(3.5777) val/accuracy tensor(0.3845)
epoch 22 train/loss tensor(3.6324) train/accuracy tensor(0.3851) train/lr 1.654318775308642 val/loss tensor(3.4896) val/accuracy tensor(0.4071)
epoch 23 train/loss tensor(3.5877) train/accuracy tensor(0.3942) train/lr 1.6060201086419754 val/loss tensor(3.4478) val/accuracy tensor(0.4144)
epoch 24 train/loss tensor(3.5472) train/accuracy tensor(0.4021) train/lr 1.5584369777777782 val/loss tensor(3.4735) val/accuracy tensor(0.4063)
epoch 25 train/loss tensor(3.5110) train/accuracy tensor(0.4097) train/lr 1.5115693827160495 val/loss tensor(3.3876) val/accuracy tensor(0.4274)
epoch 26 train/loss tensor(3.4786) train/accuracy tensor(0.4165) train/lr 1.4654173234567902 val/loss tensor(3.3360) val/accuracy tensor(0.4381)
epoch 27 train/loss tensor(3.4419) train/accuracy tensor(0.4250) train/lr 1.4199807999999998 val/loss tensor(3.3433) val/accuracy tensor(0.4330)
epoch 28 train/loss tensor(3.4127) train/accuracy tensor(0.4299) train/lr 1.375259812345679 val/loss tensor(3.3024) val/accuracy tensor(0.4402)
epoch 29 train/loss tensor(3.3809) train/accuracy tensor(0.4376) train/lr 1.3312543604938272 val/loss tensor(3.2536) val/accuracy tensor(0.4550)
epoch 30 train/loss tensor(3.3540) train/accuracy tensor(0.4428) train/lr 1.2879644444444447 val/loss tensor(3.2436) val/accuracy tensor(0.4559)
epoch 31 train/loss tensor(3.3267) train/accuracy tensor(0.4493) train/lr 1.2453900641975308 val/loss tensor(3.2568) val/accuracy tensor(0.4525)
epoch 32 train/loss tensor(3.3029) train/accuracy tensor(0.4538) train/lr 1.203531219753086 val/loss tensor(3.1287) val/accuracy tensor(0.4800)
epoch 33 train/loss tensor(3.2796) train/accuracy tensor(0.4593) train/lr 1.162387911111111 val/loss tensor(3.1211) val/accuracy tensor(0.4825)
epoch 34 train/loss tensor(3.2566) train/accuracy tensor(0.4638) train/lr 1.121960138271605 val/loss tensor(3.1245) val/accuracy tensor(0.4887)
epoch 35 train/loss tensor(3.2358) train/accuracy tensor(0.4690) train/lr 1.082247901234568 val/loss tensor(3.0578) val/accuracy tensor(0.4955)
epoch 36 train/loss tensor(3.2159) train/accuracy tensor(0.4728) train/lr 1.0432512 val/loss tensor(3.0507) val/accuracy tensor(0.4958)
epoch 37 train/loss tensor(3.1975) train/accuracy tensor(0.4769) train/lr 1.0049700345679013 val/loss tensor(3.0650) val/accuracy tensor(0.4968)
epoch 38 train/loss tensor(3.1811) train/accuracy tensor(0.4802) train/lr 0.9674044049382714 val/loss tensor(2.9979) val/accuracy tensor(0.5108)
epoch 39 train/loss tensor(3.1610) train/accuracy tensor(0.4846) train/lr 0.930554311111111 val/loss tensor(3.0182) val/accuracy tensor(0.5086)
epoch 40 train/loss tensor(3.1473) train/accuracy tensor(0.4880) train/lr 0.8944197530864199 val/loss tensor(2.9914) val/accuracy tensor(0.5152)
epoch 41 train/loss tensor(3.1328) train/accuracy tensor(0.4914) train/lr 0.8590007308641977 val/loss tensor(2.9655) val/accuracy tensor(0.5193)
epoch 42 train/loss tensor(3.1141) train/accuracy tensor(0.4953) train/lr 0.8242972444444444 val/loss tensor(2.9438) val/accuracy tensor(0.5222)
epoch 43 train/loss tensor(3.1013) train/accuracy tensor(0.4986) train/lr 0.7903092938271603 val/loss tensor(2.9615) val/accuracy tensor(0.5206)
epoch 44 train/loss tensor(3.0883) train/accuracy tensor(0.5013) train/lr 0.7570368790123455 val/loss tensor(2.9115) val/accuracy tensor(0.5298)
epoch 45 train/loss tensor(3.0714) train/accuracy tensor(0.5048) train/lr 0.72448 val/loss tensor(2.9151) val/accuracy tensor(0.5306)
epoch 46 train/loss tensor(3.0610) train/accuracy tensor(0.5069) train/lr 0.6926386567901236 val/loss tensor(2.8932) val/accuracy tensor(0.5395)
epoch 47 train/loss tensor(3.0514) train/accuracy tensor(0.5099) train/lr 0.6615128493827159 val/loss tensor(2.8771) val/accuracy tensor(0.5389)
epoch 48 train/loss tensor(3.0401) train/accuracy tensor(0.5121) train/lr 0.6311025777777778 val/loss tensor(2.8820) val/accuracy tensor(0.5396)
epoch 49 train/loss tensor(3.0325) train/accuracy tensor(0.5138) train/lr 0.6014078419753088 val/loss tensor(2.8627) val/accuracy tensor(0.5419)
epoch 50 train/loss tensor(3.0201) train/accuracy tensor(0.5162) train/lr 0.5724286419753086 val/loss tensor(2.8545) val/accuracy tensor(0.5449)
epoch 51 train/loss tensor(3.0101) train/accuracy tensor(0.5184) train/lr 0.5441649777777778 val/loss tensor(2.8532) val/accuracy tensor(0.5446)
epoch 52 train/loss tensor(2.9996) train/accuracy tensor(0.5213) train/lr 0.5166168493827162 val/loss tensor(2.8483) val/accuracy tensor(0.5454)
epoch 53 train/loss tensor(2.9914) train/accuracy tensor(0.5233) train/lr 0.4897842567901234 val/loss tensor(2.8274) val/accuracy tensor(0.5513)
epoch 54 train/loss tensor(2.9854) train/accuracy tensor(0.5243) train/lr 0.4636672000000001 val/loss tensor(2.8089) val/accuracy tensor(0.5538)
epoch 55 train/loss tensor(2.9771) train/accuracy tensor(0.5262) train/lr 0.43826567901234553 val/loss tensor(2.8025) val/accuracy tensor(0.5543)
epoch 56 train/loss tensor(2.9667) train/accuracy tensor(0.5289) train/lr 0.4135796938271605 val/loss tensor(2.7949) val/accuracy tensor(0.5588)
epoch 57 train/loss tensor(2.9601) train/accuracy tensor(0.5299) train/lr 0.38960924444444456 val/loss tensor(2.7868) val/accuracy tensor(0.5611)
epoch 58 train/loss tensor(2.9526) train/accuracy tensor(0.5315) train/lr 0.36635433086419744 val/loss tensor(2.7741) val/accuracy tensor(0.5625)
epoch 59 train/loss tensor(2.9456) train/accuracy tensor(0.5328) train/lr 0.34381495308641974 val/loss tensor(2.7712) val/accuracy tensor(0.5631)
epoch 60 train/loss tensor(2.9408) train/accuracy tensor(0.5346) train/lr 0.3219911111111112 val/loss tensor(2.7788) val/accuracy tensor(0.5610)
epoch 61 train/loss tensor(2.9360) train/accuracy tensor(0.5353) train/lr 0.3008828049382715 val/loss tensor(2.7478) val/accuracy tensor(0.5685)
epoch 62 train/loss tensor(2.9299) train/accuracy tensor(0.5369) train/lr 0.2804900345679012 val/loss tensor(2.7650) val/accuracy tensor(0.5650)
epoch 63 train/loss tensor(2.9248) train/accuracy tensor(0.5380) train/lr 0.26081280000000007 val/loss tensor(2.7538) val/accuracy tensor(0.5679)
epoch 64 train/loss tensor(2.9184) train/accuracy tensor(0.5395) train/lr 0.24185110123456785 val/loss tensor(2.7447) val/accuracy tensor(0.5709)
epoch 65 train/loss tensor(2.9146) train/accuracy tensor(0.5406) train/lr 0.22360493827160496 val/loss tensor(2.7363) val/accuracy tensor(0.5707)
epoch 66 train/loss tensor(2.9105) train/accuracy tensor(0.5414) train/lr 0.20607431111111119 val/loss tensor(2.7374) val/accuracy tensor(0.5700)
epoch 67 train/loss tensor(2.9068) train/accuracy tensor(0.5425) train/lr 0.18925921975308638 val/loss tensor(2.7287) val/accuracy tensor(0.5735)
epoch 68 train/loss tensor(2.9026) train/accuracy tensor(0.5438) train/lr 0.1731596641975309 val/loss tensor(2.7251) val/accuracy tensor(0.5736)
epoch 69 train/loss tensor(2.8962) train/accuracy tensor(0.5450) train/lr 0.1577756444444444 val/loss tensor(2.7231) val/accuracy tensor(0.5738)
epoch 70 train/loss tensor(2.8952) train/accuracy tensor(0.5450) train/lr 0.14310716049382716 val/loss tensor(2.7202) val/accuracy tensor(0.5733)
epoch 71 train/loss tensor(2.8921) train/accuracy tensor(0.5461) train/lr 0.12915421234567906 val/loss tensor(2.7115) val/accuracy tensor(0.5773)
epoch 72 train/loss tensor(2.8904) train/accuracy tensor(0.5464) train/lr 0.11591679999999994 val/loss tensor(2.7082) val/accuracy tensor(0.5779)
epoch 73 train/loss tensor(2.8868) train/accuracy tensor(0.5473) train/lr 0.10339492345679012 val/loss tensor(2.7096) val/accuracy tensor(0.5781)
epoch 74 train/loss tensor(2.8832) train/accuracy tensor(0.5476) train/lr 0.09158858271604943 val/loss tensor(2.7080) val/accuracy tensor(0.5782)
epoch 75 train/loss tensor(2.8836) train/accuracy tensor(0.5481) train/lr 0.08049777777777775 val/loss tensor(2.7063) val/accuracy tensor(0.5796)
epoch 76 train/loss tensor(2.8795) train/accuracy tensor(0.5487) train/lr 0.0701225086419753 val/loss tensor(2.7070) val/accuracy tensor(0.5790)
epoch 77 train/loss tensor(2.8763) train/accuracy tensor(0.5496) train/lr 0.06046277530864202 val/loss tensor(2.6989) val/accuracy tensor(0.5822)
epoch 78 train/loss tensor(2.8749) train/accuracy tensor(0.5501) train/lr 0.05151857777777776 val/loss tensor(2.6979) val/accuracy tensor(0.5816)
epoch 79 train/loss tensor(2.8756) train/accuracy tensor(0.5494) train/lr 0.043289916049382725 val/loss tensor(2.6989) val/accuracy tensor(0.5804)
epoch 80 train/loss tensor(2.8751) train/accuracy tensor(0.5500) train/lr 0.035776790123456824 val/loss tensor(2.6942) val/accuracy tensor(0.5817)
epoch 81 train/loss tensor(2.8737) train/accuracy tensor(0.5501) train/lr 0.028979199999999986 val/loss tensor(2.6942) val/accuracy tensor(0.5811)
epoch 82 train/loss tensor(2.8721) train/accuracy tensor(0.5505) train/lr 0.022897145679012357 val/loss tensor(2.6945) val/accuracy tensor(0.5818)
epoch 83 train/loss tensor(2.8714) train/accuracy tensor(0.5508) train/lr 0.017530627160493802 val/loss tensor(2.6934) val/accuracy tensor(0.5808)
epoch 84 train/loss tensor(2.8696) train/accuracy tensor(0.5509) train/lr 0.01287964444444444 val/loss tensor(2.6924) val/accuracy tensor(0.5817)
epoch 85 train/loss tensor(2.8701) train/accuracy tensor(0.5507) train/lr 0.008944197530864206 val/loss tensor(2.6934) val/accuracy tensor(0.5829)
epoch 86 train/loss tensor(2.8687) train/accuracy tensor(0.5516) train/lr 0.005724286419753074 val/loss tensor(2.6919) val/accuracy tensor(0.5824)
epoch 87 train/loss tensor(2.8710) train/accuracy tensor(0.5507) train/lr 0.00321991111111111 val/loss tensor(2.6945) val/accuracy tensor(0.5825)
epoch 88 train/loss tensor(2.8693) train/accuracy tensor(0.5517) train/lr 0.0014310716049382758 val/loss tensor(2.6903) val/accuracy tensor(0.5819)
epoch 89 train/loss tensor(2.8685) train/accuracy tensor(0.5515) train/lr 0.00035776790123456543 val/loss tensor(2.6940) val/accuracy tensor(0.5821)
epoch 90 train/loss tensor(2.8708) train/accuracy tensor(0.5503) train/lr 0.0 val/loss tensor(2.6921) val/accuracy tensor(0.5819)

Training time: 0:36:07.810031
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0005 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.0005 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8759) train/accuracy tensor(0.0039) train/lr 0.58864 val/loss tensor(6.8219) val/accuracy tensor(0.0055)
epoch 2 train/loss tensor(6.4430) train/accuracy tensor(0.0176) train/lr 1.16596 val/loss tensor(6.5547) val/accuracy tensor(0.0172)
epoch 3 train/loss tensor(6.0140) train/accuracy tensor(0.0409) train/lr 1.74328 val/loss tensor(5.9419) val/accuracy tensor(0.0480)
epoch 4 train/loss tensor(5.7514) train/accuracy tensor(0.0620) train/lr 2.3206 val/loss tensor(5.7748) val/accuracy tensor(0.0580)
epoch 5 train/loss tensor(5.4954) train/accuracy tensor(0.0872) train/lr 2.39497520661157 val/loss tensor(5.4108) val/accuracy tensor(0.0953)
epoch 6 train/loss tensor(5.2640) train/accuracy tensor(0.1138) train/lr 2.3001341884297517 val/loss tensor(5.1334) val/accuracy tensor(0.1244)
epoch 7 train/loss tensor(5.0711) train/accuracy tensor(0.1385) train/lr 2.2072091504132234 val/loss tensor(5.1160) val/accuracy tensor(0.1253)
epoch 8 train/loss tensor(4.9095) train/accuracy tensor(0.1609) train/lr 2.116200092561983 val/loss tensor(4.6859) val/accuracy tensor(0.1856)
epoch 9 train/loss tensor(4.7550) train/accuracy tensor(0.1837) train/lr 2.0271070148760333 val/loss tensor(4.6385) val/accuracy tensor(0.1946)
epoch 10 train/loss tensor(4.6170) train/accuracy tensor(0.2054) train/lr 1.9399299173553717 val/loss tensor(4.5595) val/accuracy tensor(0.2102)
epoch 11 train/loss tensor(4.5005) train/accuracy tensor(0.2249) train/lr 1.8546688000000005 val/loss tensor(4.3635) val/accuracy tensor(0.2382)
epoch 12 train/loss tensor(4.3989) train/accuracy tensor(0.2417) train/lr 1.7713236628099176 val/loss tensor(4.3337) val/accuracy tensor(0.2395)
epoch 13 train/loss tensor(4.3052) train/accuracy tensor(0.2575) train/lr 1.689894505785124 val/loss tensor(4.1702) val/accuracy tensor(0.2691)
epoch 14 train/loss tensor(4.2200) train/accuracy tensor(0.2734) train/lr 1.61038132892562 val/loss tensor(4.0961) val/accuracy tensor(0.2827)
epoch 15 train/loss tensor(4.1316) train/accuracy tensor(0.2878) train/lr 1.532784132231405 val/loss tensor(3.9591) val/accuracy tensor(0.3069)
epoch 16 train/loss tensor(4.0676) train/accuracy tensor(0.3008) train/lr 1.4571029157024795 val/loss tensor(3.9070) val/accuracy tensor(0.3214)
epoch 17 train/loss tensor(3.9997) train/accuracy tensor(0.3136) train/lr 1.383337679338843 val/loss tensor(3.9337) val/accuracy tensor(0.3139)
epoch 18 train/loss tensor(3.9481) train/accuracy tensor(0.3225) train/lr 1.311488423140496 val/loss tensor(3.7434) val/accuracy tensor(0.3514)
epoch 19 train/loss tensor(3.8862) train/accuracy tensor(0.3343) train/lr 1.2415551471074382 val/loss tensor(3.7040) val/accuracy tensor(0.3600)
epoch 20 train/loss tensor(3.8402) train/accuracy tensor(0.3435) train/lr 1.1735378512396695 val/loss tensor(3.7040) val/accuracy tensor(0.3589)
epoch 21 train/loss tensor(3.7935) train/accuracy tensor(0.3529) train/lr 1.10743653553719 val/loss tensor(3.6039) val/accuracy tensor(0.3752)
epoch 22 train/loss tensor(3.7544) train/accuracy tensor(0.3606) train/lr 1.0432512 val/loss tensor(3.5759) val/accuracy tensor(0.3846)
epoch 23 train/loss tensor(3.7146) train/accuracy tensor(0.3686) train/lr 0.9809818446280991 val/loss tensor(3.5213) val/accuracy tensor(0.3953)
epoch 24 train/loss tensor(3.6815) train/accuracy tensor(0.3750) train/lr 0.9206284694214879 val/loss tensor(3.4698) val/accuracy tensor(0.4062)
epoch 25 train/loss tensor(3.6479) train/accuracy tensor(0.3814) train/lr 0.8621910743801652 val/loss tensor(3.4190) val/accuracy tensor(0.4185)
epoch 26 train/loss tensor(3.6194) train/accuracy tensor(0.3874) train/lr 0.8056696595041324 val/loss tensor(3.4171) val/accuracy tensor(0.4174)
epoch 27 train/loss tensor(3.5907) train/accuracy tensor(0.3930) train/lr 0.7510642247933882 val/loss tensor(3.3826) val/accuracy tensor(0.4235)
epoch 28 train/loss tensor(3.5659) train/accuracy tensor(0.3986) train/lr 0.698374770247934 val/loss tensor(3.3658) val/accuracy tensor(0.4319)
epoch 29 train/loss tensor(3.5399) train/accuracy tensor(0.4039) train/lr 0.6476012958677687 val/loss tensor(3.3167) val/accuracy tensor(0.4386)
epoch 30 train/loss tensor(3.5185) train/accuracy tensor(0.4086) train/lr 0.5987438016528926 val/loss tensor(3.3150) val/accuracy tensor(0.4408)
epoch 31 train/loss tensor(3.4972) train/accuracy tensor(0.4126) train/lr 0.5518022876033059 val/loss tensor(3.2953) val/accuracy tensor(0.4461)
epoch 32 train/loss tensor(3.4820) train/accuracy tensor(0.4158) train/lr 0.5067767537190083 val/loss tensor(3.2541) val/accuracy tensor(0.4540)
epoch 33 train/loss tensor(3.4616) train/accuracy tensor(0.4206) train/lr 0.4636672000000001 val/loss tensor(3.2333) val/accuracy tensor(0.4614)
epoch 34 train/loss tensor(3.4447) train/accuracy tensor(0.4234) train/lr 0.422473626446281 val/loss tensor(3.2208) val/accuracy tensor(0.4623)
epoch 35 train/loss tensor(3.4340) train/accuracy tensor(0.4258) train/lr 0.38319603305785127 val/loss tensor(3.2043) val/accuracy tensor(0.4642)
epoch 36 train/loss tensor(3.4176) train/accuracy tensor(0.4296) train/lr 0.34583441983471075 val/loss tensor(3.1856) val/accuracy tensor(0.4695)
epoch 37 train/loss tensor(3.4048) train/accuracy tensor(0.4322) train/lr 0.31038878677685955 val/loss tensor(3.1702) val/accuracy tensor(0.4750)
epoch 38 train/loss tensor(3.3953) train/accuracy tensor(0.4349) train/lr 0.2768591338842975 val/loss tensor(3.1587) val/accuracy tensor(0.4774)
epoch 39 train/loss tensor(3.3859) train/accuracy tensor(0.4363) train/lr 0.24524546115702478 val/loss tensor(3.1496) val/accuracy tensor(0.4779)
epoch 40 train/loss tensor(3.3766) train/accuracy tensor(0.4386) train/lr 0.2155477685950413 val/loss tensor(3.1353) val/accuracy tensor(0.4809)
epoch 41 train/loss tensor(3.3686) train/accuracy tensor(0.4402) train/lr 0.18776605619834705 val/loss tensor(3.1354) val/accuracy tensor(0.4806)
epoch 42 train/loss tensor(3.3597) train/accuracy tensor(0.4421) train/lr 0.1619003239669421 val/loss tensor(3.1239) val/accuracy tensor(0.4862)
epoch 43 train/loss tensor(3.3547) train/accuracy tensor(0.4432) train/lr 0.1379505719008264 val/loss tensor(3.1175) val/accuracy tensor(0.4850)
epoch 44 train/loss tensor(3.3471) train/accuracy tensor(0.4450) train/lr 0.11591679999999994 val/loss tensor(3.1034) val/accuracy tensor(0.4894)
epoch 45 train/loss tensor(3.3436) train/accuracy tensor(0.4459) train/lr 0.09579900826446275 val/loss tensor(3.1001) val/accuracy tensor(0.4890)
epoch 46 train/loss tensor(3.3377) train/accuracy tensor(0.4472) train/lr 0.07759719669421493 val/loss tensor(3.1008) val/accuracy tensor(0.4889)
epoch 47 train/loss tensor(3.3349) train/accuracy tensor(0.4479) train/lr 0.061311365289256244 val/loss tensor(3.0912) val/accuracy tensor(0.4907)
epoch 48 train/loss tensor(3.3301) train/accuracy tensor(0.4486) train/lr 0.04694151404958682 val/loss tensor(3.0876) val/accuracy tensor(0.4922)
epoch 49 train/loss tensor(3.3306) train/accuracy tensor(0.4487) train/lr 0.03448764297520664 val/loss tensor(3.0862) val/accuracy tensor(0.4916)
epoch 50 train/loss tensor(3.3278) train/accuracy tensor(0.4495) train/lr 0.02394975206611572 val/loss tensor(3.0872) val/accuracy tensor(0.4917)
epoch 51 train/loss tensor(3.3267) train/accuracy tensor(0.4492) train/lr 0.015327841322314061 val/loss tensor(3.0821) val/accuracy tensor(0.4925)
epoch 52 train/loss tensor(3.3246) train/accuracy tensor(0.4494) train/lr 0.00862191074380166 val/loss tensor(3.0821) val/accuracy tensor(0.4936)
epoch 53 train/loss tensor(3.3222) train/accuracy tensor(0.4506) train/lr 0.0038319603305785152 val/loss tensor(3.0827) val/accuracy tensor(0.4930)
epoch 54 train/loss tensor(3.3240) train/accuracy tensor(0.4501) train/lr 0.0009579900826446288 val/loss tensor(3.0827) val/accuracy tensor(0.4933)
epoch 55 train/loss tensor(3.3246) train/accuracy tensor(0.4497) train/lr 0.0 val/loss tensor(3.0808) val/accuracy tensor(0.4943)

Training time: 0:21:25.713764
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.001 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.001 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8101) train/accuracy tensor(0.0056) train/lr 0.58864 val/loss tensor(6.7542) val/accuracy tensor(0.0086)
epoch 2 train/loss tensor(6.1942) train/accuracy tensor(0.0289) train/lr 1.16596 val/loss tensor(6.4961) val/accuracy tensor(0.0202)
epoch 3 train/loss tensor(5.8291) train/accuracy tensor(0.0548) train/lr 1.74328 val/loss tensor(5.8271) val/accuracy tensor(0.0543)
epoch 4 train/loss tensor(5.5448) train/accuracy tensor(0.0812) train/lr 2.3206 val/loss tensor(5.5606) val/accuracy tensor(0.0762)
epoch 5 train/loss tensor(5.2448) train/accuracy tensor(0.1156) train/lr 2.584873086419753 val/loss tensor(5.3138) val/accuracy tensor(0.0985)
epoch 6 train/loss tensor(4.9525) train/accuracy tensor(0.1544) train/lr 2.524410311111111 val/loss tensor(5.1006) val/accuracy tensor(0.1282)
epoch 7 train/loss tensor(4.6911) train/accuracy tensor(0.1931) train/lr 2.4646630716049387 val/loss tensor(4.6815) val/accuracy tensor(0.1792)
epoch 8 train/loss tensor(4.4595) train/accuracy tensor(0.2302) train/lr 2.4056313679012344 val/loss tensor(4.5871) val/accuracy tensor(0.2092)
epoch 9 train/loss tensor(4.2683) train/accuracy tensor(0.2633) train/lr 2.3473152 val/loss tensor(4.3421) val/accuracy tensor(0.2450)
epoch 10 train/loss tensor(4.1012) train/accuracy tensor(0.2930) train/lr 2.2897145679012345 val/loss tensor(4.2167) val/accuracy tensor(0.2659)
epoch 11 train/loss tensor(3.9660) train/accuracy tensor(0.3186) train/lr 2.2328294716049384 val/loss tensor(3.9831) val/accuracy tensor(0.3026)
epoch 12 train/loss tensor(3.8384) train/accuracy tensor(0.3429) train/lr 2.1766599111111113 val/loss tensor(3.9466) val/accuracy tensor(0.3093)
epoch 13 train/loss tensor(3.7353) train/accuracy tensor(0.3634) train/lr 2.1212058864197534 val/loss tensor(3.8573) val/accuracy tensor(0.3334)
epoch 14 train/loss tensor(3.6411) train/accuracy tensor(0.3827) train/lr 2.066467397530864 val/loss tensor(3.7781) val/accuracy tensor(0.3644)
epoch 15 train/loss tensor(3.5572) train/accuracy tensor(0.3992) train/lr 2.0124444444444447 val/loss tensor(3.5242) val/accuracy tensor(0.3953)
epoch 16 train/loss tensor(3.4829) train/accuracy tensor(0.4144) train/lr 1.9591370271604935 val/loss tensor(3.6247) val/accuracy tensor(0.3748)
epoch 17 train/loss tensor(3.4228) train/accuracy tensor(0.4276) train/lr 1.9065451456790126 val/loss tensor(3.4461) val/accuracy tensor(0.4155)
epoch 18 train/loss tensor(3.3621) train/accuracy tensor(0.4404) train/lr 1.8546688000000005 val/loss tensor(3.3802) val/accuracy tensor(0.4246)
epoch 19 train/loss tensor(3.3044) train/accuracy tensor(0.4524) train/lr 1.8035079901234565 val/loss tensor(3.3441) val/accuracy tensor(0.4334)
epoch 20 train/loss tensor(3.2572) train/accuracy tensor(0.4633) train/lr 1.7530627160493828 val/loss tensor(3.2476) val/accuracy tensor(0.4509)
epoch 21 train/loss tensor(3.2087) train/accuracy tensor(0.4737) train/lr 1.7033329777777777 val/loss tensor(3.2659) val/accuracy tensor(0.4552)
epoch 22 train/loss tensor(3.1712) train/accuracy tensor(0.4822) train/lr 1.654318775308642 val/loss tensor(3.1298) val/accuracy tensor(0.4793)
epoch 23 train/loss tensor(3.1326) train/accuracy tensor(0.4905) train/lr 1.6060201086419754 val/loss tensor(3.1542) val/accuracy tensor(0.4744)
epoch 24 train/loss tensor(3.0968) train/accuracy tensor(0.4985) train/lr 1.5584369777777782 val/loss tensor(3.0554) val/accuracy tensor(0.4913)
epoch 25 train/loss tensor(3.0629) train/accuracy tensor(0.5058) train/lr 1.5115693827160495 val/loss tensor(3.0527) val/accuracy tensor(0.5023)
epoch 26 train/loss tensor(3.0312) train/accuracy tensor(0.5128) train/lr 1.4654173234567902 val/loss tensor(3.0163) val/accuracy tensor(0.5038)
epoch 27 train/loss tensor(3.0055) train/accuracy tensor(0.5188) train/lr 1.4199807999999998 val/loss tensor(2.9994) val/accuracy tensor(0.5148)
epoch 28 train/loss tensor(2.9763) train/accuracy tensor(0.5262) train/lr 1.375259812345679 val/loss tensor(2.9886) val/accuracy tensor(0.5162)
epoch 29 train/loss tensor(2.9527) train/accuracy tensor(0.5310) train/lr 1.3312543604938272 val/loss tensor(2.9594) val/accuracy tensor(0.5298)
epoch 30 train/loss tensor(2.9233) train/accuracy tensor(0.5377) train/lr 1.2879644444444447 val/loss tensor(2.9003) val/accuracy tensor(0.5310)
epoch 31 train/loss tensor(2.9031) train/accuracy tensor(0.5423) train/lr 1.2453900641975308 val/loss tensor(2.8797) val/accuracy tensor(0.5414)
epoch 32 train/loss tensor(2.8847) train/accuracy tensor(0.5469) train/lr 1.203531219753086 val/loss tensor(2.9058) val/accuracy tensor(0.5305)
epoch 33 train/loss tensor(2.8596) train/accuracy tensor(0.5525) train/lr 1.162387911111111 val/loss tensor(2.8757) val/accuracy tensor(0.5454)
epoch 34 train/loss tensor(2.8402) train/accuracy tensor(0.5573) train/lr 1.121960138271605 val/loss tensor(2.7776) val/accuracy tensor(0.5617)
epoch 35 train/loss tensor(2.8231) train/accuracy tensor(0.5604) train/lr 1.082247901234568 val/loss tensor(2.7698) val/accuracy tensor(0.5606)
epoch 36 train/loss tensor(2.8034) train/accuracy tensor(0.5654) train/lr 1.0432512 val/loss tensor(2.7752) val/accuracy tensor(0.5604)
epoch 37 train/loss tensor(2.7845) train/accuracy tensor(0.5702) train/lr 1.0049700345679013 val/loss tensor(2.6898) val/accuracy tensor(0.5825)
epoch 38 train/loss tensor(2.7691) train/accuracy tensor(0.5736) train/lr 0.9674044049382714 val/loss tensor(2.7444) val/accuracy tensor(0.5750)
epoch 39 train/loss tensor(2.7543) train/accuracy tensor(0.5770) train/lr 0.930554311111111 val/loss tensor(2.7453) val/accuracy tensor(0.5711)
epoch 40 train/loss tensor(2.7391) train/accuracy tensor(0.5801) train/lr 0.8944197530864199 val/loss tensor(2.7425) val/accuracy tensor(0.5699)
epoch 41 train/loss tensor(2.7234) train/accuracy tensor(0.5844) train/lr 0.8590007308641977 val/loss tensor(2.6592) val/accuracy tensor(0.5918)
epoch 42 train/loss tensor(2.7069) train/accuracy tensor(0.5883) train/lr 0.8242972444444444 val/loss tensor(2.6631) val/accuracy tensor(0.5917)
epoch 43 train/loss tensor(2.6970) train/accuracy tensor(0.5908) train/lr 0.7903092938271603 val/loss tensor(2.6359) val/accuracy tensor(0.5943)
epoch 44 train/loss tensor(2.6822) train/accuracy tensor(0.5941) train/lr 0.7570368790123455 val/loss tensor(2.6365) val/accuracy tensor(0.5941)
epoch 45 train/loss tensor(2.6708) train/accuracy tensor(0.5965) train/lr 0.72448 val/loss tensor(2.6014) val/accuracy tensor(0.6018)
epoch 46 train/loss tensor(2.6575) train/accuracy tensor(0.5998) train/lr 0.6926386567901236 val/loss tensor(2.5914) val/accuracy tensor(0.6069)
epoch 47 train/loss tensor(2.6476) train/accuracy tensor(0.6024) train/lr 0.6615128493827159 val/loss tensor(2.5685) val/accuracy tensor(0.6127)
epoch 48 train/loss tensor(2.6356) train/accuracy tensor(0.6053) train/lr 0.6311025777777778 val/loss tensor(2.5680) val/accuracy tensor(0.6146)
epoch 49 train/loss tensor(2.6267) train/accuracy tensor(0.6075) train/lr 0.6014078419753088 val/loss tensor(2.5797) val/accuracy tensor(0.6154)
epoch 50 train/loss tensor(2.6149) train/accuracy tensor(0.6101) train/lr 0.5724286419753086 val/loss tensor(2.5372) val/accuracy tensor(0.6157)
epoch 51 train/loss tensor(2.6066) train/accuracy tensor(0.6120) train/lr 0.5441649777777778 val/loss tensor(2.5511) val/accuracy tensor(0.6183)
epoch 52 train/loss tensor(2.5978) train/accuracy tensor(0.6144) train/lr 0.5166168493827162 val/loss tensor(2.5405) val/accuracy tensor(0.6195)
epoch 53 train/loss tensor(2.5887) train/accuracy tensor(0.6165) train/lr 0.4897842567901234 val/loss tensor(2.5237) val/accuracy tensor(0.6193)
epoch 54 train/loss tensor(2.5803) train/accuracy tensor(0.6187) train/lr 0.4636672000000001 val/loss tensor(2.4896) val/accuracy tensor(0.6290)
epoch 55 train/loss tensor(2.5720) train/accuracy tensor(0.6209) train/lr 0.43826567901234553 val/loss tensor(2.5151) val/accuracy tensor(0.6249)
epoch 56 train/loss tensor(2.5620) train/accuracy tensor(0.6232) train/lr 0.4135796938271605 val/loss tensor(2.4925) val/accuracy tensor(0.6284)
epoch 57 train/loss tensor(2.5549) train/accuracy tensor(0.6246) train/lr 0.38960924444444456 val/loss tensor(2.4913) val/accuracy tensor(0.6291)
epoch 58 train/loss tensor(2.5498) train/accuracy tensor(0.6260) train/lr 0.36635433086419744 val/loss tensor(2.4837) val/accuracy tensor(0.6312)
epoch 59 train/loss tensor(2.5419) train/accuracy tensor(0.6276) train/lr 0.34381495308641974 val/loss tensor(2.4686) val/accuracy tensor(0.6373)
epoch 60 train/loss tensor(2.5361) train/accuracy tensor(0.6295) train/lr 0.3219911111111112 val/loss tensor(2.4543) val/accuracy tensor(0.6383)
epoch 61 train/loss tensor(2.5285) train/accuracy tensor(0.6311) train/lr 0.3008828049382715 val/loss tensor(2.4460) val/accuracy tensor(0.6399)
epoch 62 train/loss tensor(2.5236) train/accuracy tensor(0.6324) train/lr 0.2804900345679012 val/loss tensor(2.4460) val/accuracy tensor(0.6412)
epoch 63 train/loss tensor(2.5173) train/accuracy tensor(0.6340) train/lr 0.26081280000000007 val/loss tensor(2.4483) val/accuracy tensor(0.6431)
epoch 64 train/loss tensor(2.5111) train/accuracy tensor(0.6357) train/lr 0.24185110123456785 val/loss tensor(2.4341) val/accuracy tensor(0.6402)
epoch 65 train/loss tensor(2.5051) train/accuracy tensor(0.6369) train/lr 0.22360493827160496 val/loss tensor(2.4254) val/accuracy tensor(0.6460)
epoch 66 train/loss tensor(2.4993) train/accuracy tensor(0.6382) train/lr 0.20607431111111119 val/loss tensor(2.4211) val/accuracy tensor(0.6477)
epoch 67 train/loss tensor(2.4967) train/accuracy tensor(0.6390) train/lr 0.18925921975308638 val/loss tensor(2.4182) val/accuracy tensor(0.6471)
epoch 68 train/loss tensor(2.4929) train/accuracy tensor(0.6402) train/lr 0.1731596641975309 val/loss tensor(2.4144) val/accuracy tensor(0.6463)
epoch 69 train/loss tensor(2.4867) train/accuracy tensor(0.6413) train/lr 0.1577756444444444 val/loss tensor(2.4091) val/accuracy tensor(0.6488)
epoch 70 train/loss tensor(2.4826) train/accuracy tensor(0.6430) train/lr 0.14310716049382716 val/loss tensor(2.4035) val/accuracy tensor(0.6504)
epoch 71 train/loss tensor(2.4792) train/accuracy tensor(0.6435) train/lr 0.12915421234567906 val/loss tensor(2.3958) val/accuracy tensor(0.6511)
epoch 72 train/loss tensor(2.4769) train/accuracy tensor(0.6442) train/lr 0.11591679999999994 val/loss tensor(2.3960) val/accuracy tensor(0.6530)
epoch 73 train/loss tensor(2.4740) train/accuracy tensor(0.6444) train/lr 0.10339492345679012 val/loss tensor(2.3943) val/accuracy tensor(0.6515)
epoch 74 train/loss tensor(2.4692) train/accuracy tensor(0.6463) train/lr 0.09158858271604943 val/loss tensor(2.3842) val/accuracy tensor(0.6528)
epoch 75 train/loss tensor(2.4659) train/accuracy tensor(0.6469) train/lr 0.08049777777777775 val/loss tensor(2.3886) val/accuracy tensor(0.6535)
epoch 76 train/loss tensor(2.4625) train/accuracy tensor(0.6484) train/lr 0.0701225086419753 val/loss tensor(2.3878) val/accuracy tensor(0.6529)
epoch 77 train/loss tensor(2.4636) train/accuracy tensor(0.6471) train/lr 0.06046277530864202 val/loss tensor(2.3787) val/accuracy tensor(0.6551)
epoch 78 train/loss tensor(2.4608) train/accuracy tensor(0.6483) train/lr 0.05151857777777776 val/loss tensor(2.3791) val/accuracy tensor(0.6548)
epoch 79 train/loss tensor(2.4582) train/accuracy tensor(0.6485) train/lr 0.043289916049382725 val/loss tensor(2.3756) val/accuracy tensor(0.6566)
epoch 80 train/loss tensor(2.4560) train/accuracy tensor(0.6497) train/lr 0.035776790123456824 val/loss tensor(2.3714) val/accuracy tensor(0.6578)
epoch 81 train/loss tensor(2.4554) train/accuracy tensor(0.6495) train/lr 0.028979199999999986 val/loss tensor(2.3759) val/accuracy tensor(0.6556)
epoch 82 train/loss tensor(2.4537) train/accuracy tensor(0.6495) train/lr 0.022897145679012357 val/loss tensor(2.3738) val/accuracy tensor(0.6574)
epoch 83 train/loss tensor(2.4526) train/accuracy tensor(0.6503) train/lr 0.017530627160493802 val/loss tensor(2.3713) val/accuracy tensor(0.6591)
epoch 84 train/loss tensor(2.4509) train/accuracy tensor(0.6506) train/lr 0.01287964444444444 val/loss tensor(2.3716) val/accuracy tensor(0.6581)
epoch 85 train/loss tensor(2.4501) train/accuracy tensor(0.6506) train/lr 0.008944197530864206 val/loss tensor(2.3732) val/accuracy tensor(0.6580)
epoch 86 train/loss tensor(2.4512) train/accuracy tensor(0.6504) train/lr 0.005724286419753074 val/loss tensor(2.3710) val/accuracy tensor(0.6579)
epoch 87 train/loss tensor(2.4521) train/accuracy tensor(0.6501) train/lr 0.00321991111111111 val/loss tensor(2.3723) val/accuracy tensor(0.6572)
epoch 88 train/loss tensor(2.4489) train/accuracy tensor(0.6511) train/lr 0.0014310716049382758 val/loss tensor(2.3691) val/accuracy tensor(0.6587)
epoch 89 train/loss tensor(2.4495) train/accuracy tensor(0.6515) train/lr 0.00035776790123456543 val/loss tensor(2.3709) val/accuracy tensor(0.6580)
epoch 90 train/loss tensor(2.4525) train/accuracy tensor(0.6504) train/lr 0.0 val/loss tensor(2.3709) val/accuracy tensor(0.6586)

Training time: 0:36:00.469698
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.001 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.001 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8077) train/accuracy tensor(0.0060) train/lr 0.58864 val/loss tensor(6.9308) val/accuracy tensor(0.0042)
epoch 2 train/loss tensor(6.2088) train/accuracy tensor(0.0279) train/lr 1.16596 val/loss tensor(6.2336) val/accuracy tensor(0.0290)
epoch 3 train/loss tensor(5.8340) train/accuracy tensor(0.0541) train/lr 1.74328 val/loss tensor(6.0556) val/accuracy tensor(0.0412)
epoch 4 train/loss tensor(5.5364) train/accuracy tensor(0.0817) train/lr 2.3206 val/loss tensor(5.4698) val/accuracy tensor(0.0780)
epoch 5 train/loss tensor(5.2323) train/accuracy tensor(0.1174) train/lr 2.39497520661157 val/loss tensor(5.1309) val/accuracy tensor(0.1235)
epoch 6 train/loss tensor(4.9406) train/accuracy tensor(0.1563) train/lr 2.3001341884297517 val/loss tensor(5.1151) val/accuracy tensor(0.1250)
epoch 7 train/loss tensor(4.6970) train/accuracy tensor(0.1922) train/lr 2.2072091504132234 val/loss tensor(4.7420) val/accuracy tensor(0.1739)
epoch 8 train/loss tensor(4.4798) train/accuracy tensor(0.2274) train/lr 2.116200092561983 val/loss tensor(4.4663) val/accuracy tensor(0.2201)
epoch 9 train/loss tensor(4.2917) train/accuracy tensor(0.2595) train/lr 2.0271070148760333 val/loss tensor(4.2788) val/accuracy tensor(0.2544)
epoch 10 train/loss tensor(4.1315) train/accuracy tensor(0.2879) train/lr 1.9399299173553717 val/loss tensor(4.1407) val/accuracy tensor(0.2745)
epoch 11 train/loss tensor(4.0016) train/accuracy tensor(0.3116) train/lr 1.8546688000000005 val/loss tensor(3.9913) val/accuracy tensor(0.3003)
epoch 12 train/loss tensor(3.8783) train/accuracy tensor(0.3359) train/lr 1.7713236628099176 val/loss tensor(3.8635) val/accuracy tensor(0.3276)
epoch 13 train/loss tensor(3.7760) train/accuracy tensor(0.3550) train/lr 1.689894505785124 val/loss tensor(3.7746) val/accuracy tensor(0.3471)
epoch 14 train/loss tensor(3.6895) train/accuracy tensor(0.3731) train/lr 1.61038132892562 val/loss tensor(3.6966) val/accuracy tensor(0.3671)
epoch 15 train/loss tensor(3.6040) train/accuracy tensor(0.3902) train/lr 1.532784132231405 val/loss tensor(3.5844) val/accuracy tensor(0.3822)
epoch 16 train/loss tensor(3.5405) train/accuracy tensor(0.4034) train/lr 1.4571029157024795 val/loss tensor(3.5141) val/accuracy tensor(0.3990)
epoch 17 train/loss tensor(3.4800) train/accuracy tensor(0.4158) train/lr 1.383337679338843 val/loss tensor(3.4314) val/accuracy tensor(0.4204)
epoch 18 train/loss tensor(3.4216) train/accuracy tensor(0.4282) train/lr 1.311488423140496 val/loss tensor(3.3765) val/accuracy tensor(0.4263)
epoch 19 train/loss tensor(3.3652) train/accuracy tensor(0.4401) train/lr 1.2415551471074382 val/loss tensor(3.3139) val/accuracy tensor(0.4406)
epoch 20 train/loss tensor(3.3189) train/accuracy tensor(0.4501) train/lr 1.1735378512396695 val/loss tensor(3.3003) val/accuracy tensor(0.4440)
epoch 21 train/loss tensor(3.2776) train/accuracy tensor(0.4593) train/lr 1.10743653553719 val/loss tensor(3.1661) val/accuracy tensor(0.4706)
epoch 22 train/loss tensor(3.2433) train/accuracy tensor(0.4663) train/lr 1.0432512 val/loss tensor(3.1089) val/accuracy tensor(0.4901)
epoch 23 train/loss tensor(3.2067) train/accuracy tensor(0.4747) train/lr 0.9809818446280991 val/loss tensor(3.0914) val/accuracy tensor(0.4916)
epoch 24 train/loss tensor(3.1733) train/accuracy tensor(0.4824) train/lr 0.9206284694214879 val/loss tensor(3.1059) val/accuracy tensor(0.4878)
epoch 25 train/loss tensor(3.1414) train/accuracy tensor(0.4893) train/lr 0.8621910743801652 val/loss tensor(3.0449) val/accuracy tensor(0.5032)
epoch 26 train/loss tensor(3.1184) train/accuracy tensor(0.4943) train/lr 0.8056696595041324 val/loss tensor(2.9908) val/accuracy tensor(0.5102)
epoch 27 train/loss tensor(3.0869) train/accuracy tensor(0.5016) train/lr 0.7510642247933882 val/loss tensor(2.9583) val/accuracy tensor(0.5202)
epoch 28 train/loss tensor(3.0653) train/accuracy tensor(0.5062) train/lr 0.698374770247934 val/loss tensor(2.9513) val/accuracy tensor(0.5234)
epoch 29 train/loss tensor(3.0435) train/accuracy tensor(0.5112) train/lr 0.6476012958677687 val/loss tensor(2.9082) val/accuracy tensor(0.5326)
epoch 30 train/loss tensor(3.0188) train/accuracy tensor(0.5166) train/lr 0.5987438016528926 val/loss tensor(2.9095) val/accuracy tensor(0.5307)
epoch 31 train/loss tensor(3.0009) train/accuracy tensor(0.5206) train/lr 0.5518022876033059 val/loss tensor(2.8296) val/accuracy tensor(0.5486)
epoch 32 train/loss tensor(2.9858) train/accuracy tensor(0.5246) train/lr 0.5067767537190083 val/loss tensor(2.8439) val/accuracy tensor(0.5461)
epoch 33 train/loss tensor(2.9682) train/accuracy tensor(0.5283) train/lr 0.4636672000000001 val/loss tensor(2.7972) val/accuracy tensor(0.5553)
epoch 34 train/loss tensor(2.9520) train/accuracy tensor(0.5317) train/lr 0.422473626446281 val/loss tensor(2.7766) val/accuracy tensor(0.5624)
epoch 35 train/loss tensor(2.9387) train/accuracy tensor(0.5351) train/lr 0.38319603305785127 val/loss tensor(2.7886) val/accuracy tensor(0.5582)
epoch 36 train/loss tensor(2.9223) train/accuracy tensor(0.5387) train/lr 0.34583441983471075 val/loss tensor(2.7526) val/accuracy tensor(0.5659)
epoch 37 train/loss tensor(2.9102) train/accuracy tensor(0.5414) train/lr 0.31038878677685955 val/loss tensor(2.7552) val/accuracy tensor(0.5669)
epoch 38 train/loss tensor(2.9011) train/accuracy tensor(0.5436) train/lr 0.2768591338842975 val/loss tensor(2.7307) val/accuracy tensor(0.5736)
epoch 39 train/loss tensor(2.8881) train/accuracy tensor(0.5464) train/lr 0.24524546115702478 val/loss tensor(2.7188) val/accuracy tensor(0.5760)
epoch 40 train/loss tensor(2.8787) train/accuracy tensor(0.5491) train/lr 0.2155477685950413 val/loss tensor(2.7075) val/accuracy tensor(0.5777)
epoch 41 train/loss tensor(2.8697) train/accuracy tensor(0.5511) train/lr 0.18776605619834705 val/loss tensor(2.7054) val/accuracy tensor(0.5802)
epoch 42 train/loss tensor(2.8612) train/accuracy tensor(0.5527) train/lr 0.1619003239669421 val/loss tensor(2.6815) val/accuracy tensor(0.5841)
epoch 43 train/loss tensor(2.8559) train/accuracy tensor(0.5543) train/lr 0.1379505719008264 val/loss tensor(2.6830) val/accuracy tensor(0.5834)
epoch 44 train/loss tensor(2.8472) train/accuracy tensor(0.5566) train/lr 0.11591679999999994 val/loss tensor(2.6640) val/accuracy tensor(0.5872)
epoch 45 train/loss tensor(2.8421) train/accuracy tensor(0.5577) train/lr 0.09579900826446275 val/loss tensor(2.6599) val/accuracy tensor(0.5882)
epoch 46 train/loss tensor(2.8380) train/accuracy tensor(0.5578) train/lr 0.07759719669421493 val/loss tensor(2.6630) val/accuracy tensor(0.5878)
epoch 47 train/loss tensor(2.8345) train/accuracy tensor(0.5595) train/lr 0.061311365289256244 val/loss tensor(2.6428) val/accuracy tensor(0.5914)
epoch 48 train/loss tensor(2.8295) train/accuracy tensor(0.5608) train/lr 0.04694151404958682 val/loss tensor(2.6467) val/accuracy tensor(0.5905)
epoch 49 train/loss tensor(2.8271) train/accuracy tensor(0.5614) train/lr 0.03448764297520664 val/loss tensor(2.6443) val/accuracy tensor(0.5922)
epoch 50 train/loss tensor(2.8252) train/accuracy tensor(0.5614) train/lr 0.02394975206611572 val/loss tensor(2.6402) val/accuracy tensor(0.5909)
epoch 51 train/loss tensor(2.8222) train/accuracy tensor(0.5622) train/lr 0.015327841322314061 val/loss tensor(2.6380) val/accuracy tensor(0.5915)
epoch 52 train/loss tensor(2.8191) train/accuracy tensor(0.5633) train/lr 0.00862191074380166 val/loss tensor(2.6368) val/accuracy tensor(0.5927)
epoch 53 train/loss tensor(2.8191) train/accuracy tensor(0.5631) train/lr 0.0038319603305785152 val/loss tensor(2.6379) val/accuracy tensor(0.5921)
epoch 54 train/loss tensor(2.8186) train/accuracy tensor(0.5629) train/lr 0.0009579900826446288 val/loss tensor(2.6361) val/accuracy tensor(0.5922)
epoch 55 train/loss tensor(2.8208) train/accuracy tensor(0.5625) train/lr 0.0 val/loss tensor(2.6353) val/accuracy tensor(0.5929)

Training time: 0:22:31.645153
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6343) train/accuracy tensor(0.0104) train/lr 0.58864 val/loss tensor(7.1329) val/accuracy tensor(0.0049)
epoch 2 train/loss tensor(6.0338) train/accuracy tensor(0.0378) train/lr 1.16596 val/loss tensor(6.5388) val/accuracy tensor(0.0153)
epoch 3 train/loss tensor(5.6619) train/accuracy tensor(0.0683) train/lr 1.74328 val/loss tensor(5.9715) val/accuracy tensor(0.0480)
epoch 4 train/loss tensor(5.3363) train/accuracy tensor(0.1028) train/lr 2.3206 val/loss tensor(5.7412) val/accuracy tensor(0.0682)
epoch 5 train/loss tensor(5.0121) train/accuracy tensor(0.1454) train/lr 2.584873086419753 val/loss tensor(5.6758) val/accuracy tensor(0.0863)
epoch 6 train/loss tensor(4.6577) train/accuracy tensor(0.1976) train/lr 2.524410311111111 val/loss tensor(4.9143) val/accuracy tensor(0.1562)
epoch 7 train/loss tensor(4.3494) train/accuracy tensor(0.2484) train/lr 2.4646630716049387 val/loss tensor(4.5492) val/accuracy tensor(0.2062)
epoch 8 train/loss tensor(4.1014) train/accuracy tensor(0.2930) train/lr 2.4056313679012344 val/loss tensor(4.2859) val/accuracy tensor(0.2502)
epoch 9 train/loss tensor(3.8841) train/accuracy tensor(0.3345) train/lr 2.3473152 val/loss tensor(3.9551) val/accuracy tensor(0.3057)
epoch 10 train/loss tensor(3.7197) train/accuracy tensor(0.3665) train/lr 2.2897145679012345 val/loss tensor(3.9375) val/accuracy tensor(0.3092)
epoch 11 train/loss tensor(3.5713) train/accuracy tensor(0.3964) train/lr 2.2328294716049384 val/loss tensor(3.6944) val/accuracy tensor(0.3561)
epoch 12 train/loss tensor(3.4689) train/accuracy tensor(0.4177) train/lr 2.1766599111111113 val/loss tensor(3.8225) val/accuracy tensor(0.3426)
epoch 13 train/loss tensor(3.3642) train/accuracy tensor(0.4397) train/lr 2.1212058864197534 val/loss tensor(3.7223) val/accuracy tensor(0.3627)
epoch 14 train/loss tensor(3.2837) train/accuracy tensor(0.4574) train/lr 2.066467397530864 val/loss tensor(3.4706) val/accuracy tensor(0.4104)
epoch 15 train/loss tensor(3.2036) train/accuracy tensor(0.4741) train/lr 2.0124444444444447 val/loss tensor(3.3816) val/accuracy tensor(0.4305)
epoch 16 train/loss tensor(3.1390) train/accuracy tensor(0.4888) train/lr 1.9591370271604935 val/loss tensor(3.3569) val/accuracy tensor(0.4408)
epoch 17 train/loss tensor(3.0796) train/accuracy tensor(0.5022) train/lr 1.9065451456790126 val/loss tensor(3.3228) val/accuracy tensor(0.4385)
epoch 18 train/loss tensor(3.0295) train/accuracy tensor(0.5129) train/lr 1.8546688000000005 val/loss tensor(3.2478) val/accuracy tensor(0.4542)
epoch 19 train/loss tensor(2.9827) train/accuracy tensor(0.5238) train/lr 1.8035079901234565 val/loss tensor(3.2497) val/accuracy tensor(0.4503)
epoch 20 train/loss tensor(2.9384) train/accuracy tensor(0.5341) train/lr 1.7530627160493828 val/loss tensor(3.1327) val/accuracy tensor(0.4885)
epoch 21 train/loss tensor(2.8985) train/accuracy tensor(0.5428) train/lr 1.7033329777777777 val/loss tensor(3.1075) val/accuracy tensor(0.4906)
epoch 22 train/loss tensor(2.8638) train/accuracy tensor(0.5511) train/lr 1.654318775308642 val/loss tensor(2.9980) val/accuracy tensor(0.5188)
epoch 23 train/loss tensor(2.8275) train/accuracy tensor(0.5591) train/lr 1.6060201086419754 val/loss tensor(2.9129) val/accuracy tensor(0.5306)
epoch 24 train/loss tensor(2.7929) train/accuracy tensor(0.5673) train/lr 1.5584369777777782 val/loss tensor(2.9428) val/accuracy tensor(0.5299)
epoch 25 train/loss tensor(2.7690) train/accuracy tensor(0.5734) train/lr 1.5115693827160495 val/loss tensor(2.8614) val/accuracy tensor(0.5386)
epoch 26 train/loss tensor(2.7370) train/accuracy tensor(0.5806) train/lr 1.4654173234567902 val/loss tensor(3.0267) val/accuracy tensor(0.5085)
epoch 27 train/loss tensor(2.7126) train/accuracy tensor(0.5861) train/lr 1.4199807999999998 val/loss tensor(2.8451) val/accuracy tensor(0.5414)
epoch 28 train/loss tensor(2.6824) train/accuracy tensor(0.5935) train/lr 1.375259812345679 val/loss tensor(2.8103) val/accuracy tensor(0.5498)
epoch 29 train/loss tensor(2.6581) train/accuracy tensor(0.5990) train/lr 1.3312543604938272 val/loss tensor(2.7404) val/accuracy tensor(0.5697)
epoch 30 train/loss tensor(2.6362) train/accuracy tensor(0.6045) train/lr 1.2879644444444447 val/loss tensor(2.7939) val/accuracy tensor(0.5507)
epoch 31 train/loss tensor(2.6117) train/accuracy tensor(0.6099) train/lr 1.2453900641975308 val/loss tensor(2.6958) val/accuracy tensor(0.5816)
epoch 32 train/loss tensor(2.5914) train/accuracy tensor(0.6149) train/lr 1.203531219753086 val/loss tensor(2.7020) val/accuracy tensor(0.5776)
epoch 33 train/loss tensor(2.5737) train/accuracy tensor(0.6189) train/lr 1.162387911111111 val/loss tensor(2.7045) val/accuracy tensor(0.5901)
epoch 34 train/loss tensor(2.5539) train/accuracy tensor(0.6237) train/lr 1.121960138271605 val/loss tensor(2.6978) val/accuracy tensor(0.5882)
epoch 35 train/loss tensor(2.5332) train/accuracy tensor(0.6284) train/lr 1.082247901234568 val/loss tensor(2.6468) val/accuracy tensor(0.5984)
epoch 36 train/loss tensor(2.5145) train/accuracy tensor(0.6336) train/lr 1.0432512 val/loss tensor(2.6423) val/accuracy tensor(0.5998)
epoch 37 train/loss tensor(2.4982) train/accuracy tensor(0.6373) train/lr 1.0049700345679013 val/loss tensor(2.6201) val/accuracy tensor(0.6020)
epoch 38 train/loss tensor(2.4809) train/accuracy tensor(0.6413) train/lr 0.9674044049382714 val/loss tensor(2.5741) val/accuracy tensor(0.6091)
epoch 39 train/loss tensor(2.4608) train/accuracy tensor(0.6464) train/lr 0.930554311111111 val/loss tensor(2.5623) val/accuracy tensor(0.6260)
epoch 40 train/loss tensor(2.4466) train/accuracy tensor(0.6497) train/lr 0.8944197530864199 val/loss tensor(2.5658) val/accuracy tensor(0.6120)
epoch 41 train/loss tensor(2.4319) train/accuracy tensor(0.6532) train/lr 0.8590007308641977 val/loss tensor(2.5031) val/accuracy tensor(0.6252)
epoch 42 train/loss tensor(2.4155) train/accuracy tensor(0.6575) train/lr 0.8242972444444444 val/loss tensor(2.5218) val/accuracy tensor(0.6320)
epoch 43 train/loss tensor(2.3999) train/accuracy tensor(0.6610) train/lr 0.7903092938271603 val/loss tensor(2.5133) val/accuracy tensor(0.6292)
epoch 44 train/loss tensor(2.3862) train/accuracy tensor(0.6648) train/lr 0.7570368790123455 val/loss tensor(2.5049) val/accuracy tensor(0.6302)
epoch 45 train/loss tensor(2.3708) train/accuracy tensor(0.6687) train/lr 0.72448 val/loss tensor(2.4698) val/accuracy tensor(0.6342)
epoch 46 train/loss tensor(2.3571) train/accuracy tensor(0.6717) train/lr 0.6926386567901236 val/loss tensor(2.4152) val/accuracy tensor(0.6440)
epoch 47 train/loss tensor(2.3459) train/accuracy tensor(0.6744) train/lr 0.6615128493827159 val/loss tensor(2.4396) val/accuracy tensor(0.6419)
epoch 48 train/loss tensor(2.3342) train/accuracy tensor(0.6780) train/lr 0.6311025777777778 val/loss tensor(2.3446) val/accuracy tensor(0.6629)
epoch 49 train/loss tensor(2.3196) train/accuracy tensor(0.6808) train/lr 0.6014078419753088 val/loss tensor(2.4054) val/accuracy tensor(0.6500)
epoch 50 train/loss tensor(2.3103) train/accuracy tensor(0.6836) train/lr 0.5724286419753086 val/loss tensor(2.3727) val/accuracy tensor(0.6572)
epoch 51 train/loss tensor(2.2915) train/accuracy tensor(0.6878) train/lr 0.5441649777777778 val/loss tensor(2.3164) val/accuracy tensor(0.6692)
epoch 52 train/loss tensor(2.2802) train/accuracy tensor(0.6911) train/lr 0.5166168493827162 val/loss tensor(2.3376) val/accuracy tensor(0.6675)
epoch 53 train/loss tensor(2.2676) train/accuracy tensor(0.6939) train/lr 0.4897842567901234 val/loss tensor(2.3113) val/accuracy tensor(0.6732)
epoch 54 train/loss tensor(2.2600) train/accuracy tensor(0.6958) train/lr 0.4636672000000001 val/loss tensor(2.2808) val/accuracy tensor(0.6788)
epoch 55 train/loss tensor(2.2468) train/accuracy tensor(0.6996) train/lr 0.43826567901234553 val/loss tensor(2.2847) val/accuracy tensor(0.6756)
epoch 56 train/loss tensor(2.2363) train/accuracy tensor(0.7021) train/lr 0.4135796938271605 val/loss tensor(2.2640) val/accuracy tensor(0.6870)
epoch 57 train/loss tensor(2.2267) train/accuracy tensor(0.7050) train/lr 0.38960924444444456 val/loss tensor(2.2684) val/accuracy tensor(0.6877)
epoch 58 train/loss tensor(2.2173) train/accuracy tensor(0.7068) train/lr 0.36635433086419744 val/loss tensor(2.2559) val/accuracy tensor(0.6849)
epoch 59 train/loss tensor(2.2055) train/accuracy tensor(0.7103) train/lr 0.34381495308641974 val/loss tensor(2.2623) val/accuracy tensor(0.6888)
epoch 60 train/loss tensor(2.1973) train/accuracy tensor(0.7126) train/lr 0.3219911111111112 val/loss tensor(2.2275) val/accuracy tensor(0.6933)
epoch 61 train/loss tensor(2.1874) train/accuracy tensor(0.7147) train/lr 0.3008828049382715 val/loss tensor(2.2164) val/accuracy tensor(0.6931)
epoch 62 train/loss tensor(2.1788) train/accuracy tensor(0.7170) train/lr 0.2804900345679012 val/loss tensor(2.2117) val/accuracy tensor(0.6958)
epoch 63 train/loss tensor(2.1684) train/accuracy tensor(0.7198) train/lr 0.26081280000000007 val/loss tensor(2.2056) val/accuracy tensor(0.6994)
epoch 64 train/loss tensor(2.1609) train/accuracy tensor(0.7220) train/lr 0.24185110123456785 val/loss tensor(2.2028) val/accuracy tensor(0.6977)
epoch 65 train/loss tensor(2.1538) train/accuracy tensor(0.7235) train/lr 0.22360493827160496 val/loss tensor(2.1979) val/accuracy tensor(0.7013)
epoch 66 train/loss tensor(2.1443) train/accuracy tensor(0.7263) train/lr 0.20607431111111119 val/loss tensor(2.1777) val/accuracy tensor(0.7062)
epoch 67 train/loss tensor(2.1362) train/accuracy tensor(0.7282) train/lr 0.18925921975308638 val/loss tensor(2.1781) val/accuracy tensor(0.7081)
epoch 68 train/loss tensor(2.1292) train/accuracy tensor(0.7299) train/lr 0.1731596641975309 val/loss tensor(2.1885) val/accuracy tensor(0.7054)
epoch 69 train/loss tensor(2.1228) train/accuracy tensor(0.7319) train/lr 0.1577756444444444 val/loss tensor(2.1486) val/accuracy tensor(0.7091)
epoch 70 train/loss tensor(2.1159) train/accuracy tensor(0.7339) train/lr 0.14310716049382716 val/loss tensor(2.1464) val/accuracy tensor(0.7127)
epoch 71 train/loss tensor(2.1108) train/accuracy tensor(0.7348) train/lr 0.12915421234567906 val/loss tensor(2.1480) val/accuracy tensor(0.7126)
epoch 72 train/loss tensor(2.1049) train/accuracy tensor(0.7367) train/lr 0.11591679999999994 val/loss tensor(2.1412) val/accuracy tensor(0.7132)
epoch 73 train/loss tensor(2.0996) train/accuracy tensor(0.7381) train/lr 0.10339492345679012 val/loss tensor(2.1471) val/accuracy tensor(0.7129)
epoch 74 train/loss tensor(2.0941) train/accuracy tensor(0.7396) train/lr 0.09158858271604943 val/loss tensor(2.1368) val/accuracy tensor(0.7139)
epoch 75 train/loss tensor(2.0894) train/accuracy tensor(0.7408) train/lr 0.08049777777777775 val/loss tensor(2.1233) val/accuracy tensor(0.7193)
epoch 76 train/loss tensor(2.0857) train/accuracy tensor(0.7420) train/lr 0.0701225086419753 val/loss tensor(2.1351) val/accuracy tensor(0.7156)
epoch 77 train/loss tensor(2.0812) train/accuracy tensor(0.7429) train/lr 0.06046277530864202 val/loss tensor(2.1226) val/accuracy tensor(0.7184)
epoch 78 train/loss tensor(2.0780) train/accuracy tensor(0.7438) train/lr 0.05151857777777776 val/loss tensor(2.1182) val/accuracy tensor(0.7200)
epoch 79 train/loss tensor(2.0731) train/accuracy tensor(0.7451) train/lr 0.043289916049382725 val/loss tensor(2.1142) val/accuracy tensor(0.7214)
epoch 80 train/loss tensor(2.0696) train/accuracy tensor(0.7459) train/lr 0.035776790123456824 val/loss tensor(2.1121) val/accuracy tensor(0.7226)
epoch 81 train/loss tensor(2.0668) train/accuracy tensor(0.7470) train/lr 0.028979199999999986 val/loss tensor(2.1112) val/accuracy tensor(0.7215)
epoch 82 train/loss tensor(2.0662) train/accuracy tensor(0.7476) train/lr 0.022897145679012357 val/loss tensor(2.1095) val/accuracy tensor(0.7222)
epoch 83 train/loss tensor(2.0618) train/accuracy tensor(0.7484) train/lr 0.017530627160493802 val/loss tensor(2.1040) val/accuracy tensor(0.7235)
epoch 84 train/loss tensor(2.0579) train/accuracy tensor(0.7495) train/lr 0.01287964444444444 val/loss tensor(2.1070) val/accuracy tensor(0.7220)
epoch 85 train/loss tensor(2.0592) train/accuracy tensor(0.7490) train/lr 0.008944197530864206 val/loss tensor(2.1045) val/accuracy tensor(0.7246)
epoch 86 train/loss tensor(2.0563) train/accuracy tensor(0.7500) train/lr 0.005724286419753074 val/loss tensor(2.1042) val/accuracy tensor(0.7233)
epoch 87 train/loss tensor(2.0584) train/accuracy tensor(0.7493) train/lr 0.00321991111111111 val/loss tensor(2.1046) val/accuracy tensor(0.7235)
epoch 88 train/loss tensor(2.0557) train/accuracy tensor(0.7503) train/lr 0.0014310716049382758 val/loss tensor(2.1009) val/accuracy tensor(0.7233)
epoch 89 train/loss tensor(2.0558) train/accuracy tensor(0.7496) train/lr 0.00035776790123456543 val/loss tensor(2.1044) val/accuracy tensor(0.7231)
epoch 90 train/loss tensor(2.0550) train/accuracy tensor(0.7503) train/lr 0.0 val/loss tensor(2.1037) val/accuracy tensor(0.7233)

Training time: 0:36:06.753009
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6391) train/accuracy tensor(0.0105) train/lr 0.58864 val/loss tensor(7.3355) val/accuracy tensor(0.0042)
epoch 2 train/loss tensor(6.0745) train/accuracy tensor(0.0350) train/lr 1.16596 val/loss tensor(7.0813) val/accuracy tensor(0.0101)
epoch 3 train/loss tensor(5.7081) train/accuracy tensor(0.0634) train/lr 1.74328 val/loss tensor(5.9882) val/accuracy tensor(0.0417)
epoch 4 train/loss tensor(5.4098) train/accuracy tensor(0.0942) train/lr 2.3206 val/loss tensor(5.9305) val/accuracy tensor(0.0542)
epoch 5 train/loss tensor(5.0233) train/accuracy tensor(0.1435) train/lr 2.39497520661157 val/loss tensor(5.5201) val/accuracy tensor(0.0953)
epoch 6 train/loss tensor(4.6456) train/accuracy tensor(0.1997) train/lr 2.3001341884297517 val/loss tensor(4.9137) val/accuracy tensor(0.1585)
epoch 7 train/loss tensor(4.3228) train/accuracy tensor(0.2529) train/lr 2.2072091504132234 val/loss tensor(4.5956) val/accuracy tensor(0.1905)
epoch 8 train/loss tensor(4.0746) train/accuracy tensor(0.2981) train/lr 2.116200092561983 val/loss tensor(4.4213) val/accuracy tensor(0.2340)
epoch 9 train/loss tensor(3.8686) train/accuracy tensor(0.3372) train/lr 2.0271070148760333 val/loss tensor(4.1157) val/accuracy tensor(0.2728)
epoch 10 train/loss tensor(3.6975) train/accuracy tensor(0.3709) train/lr 1.9399299173553717 val/loss tensor(4.0025) val/accuracy tensor(0.2997)
epoch 11 train/loss tensor(3.5589) train/accuracy tensor(0.3992) train/lr 1.8546688000000005 val/loss tensor(3.7978) val/accuracy tensor(0.3399)
epoch 12 train/loss tensor(3.4413) train/accuracy tensor(0.4237) train/lr 1.7713236628099176 val/loss tensor(3.7026) val/accuracy tensor(0.3540)
epoch 13 train/loss tensor(3.3434) train/accuracy tensor(0.4449) train/lr 1.689894505785124 val/loss tensor(3.4373) val/accuracy tensor(0.4128)
epoch 14 train/loss tensor(3.2562) train/accuracy tensor(0.4641) train/lr 1.61038132892562 val/loss tensor(3.4460) val/accuracy tensor(0.4174)
epoch 15 train/loss tensor(3.1827) train/accuracy tensor(0.4797) train/lr 1.532784132231405 val/loss tensor(3.3853) val/accuracy tensor(0.4218)
epoch 16 train/loss tensor(3.1219) train/accuracy tensor(0.4934) train/lr 1.4571029157024795 val/loss tensor(3.0723) val/accuracy tensor(0.4899)
epoch 17 train/loss tensor(3.0605) train/accuracy tensor(0.5076) train/lr 1.383337679338843 val/loss tensor(3.2230) val/accuracy tensor(0.4735)
epoch 18 train/loss tensor(3.0048) train/accuracy tensor(0.5190) train/lr 1.311488423140496 val/loss tensor(3.1100) val/accuracy tensor(0.4862)
epoch 19 train/loss tensor(2.9601) train/accuracy tensor(0.5297) train/lr 1.2415551471074382 val/loss tensor(2.9830) val/accuracy tensor(0.5159)
epoch 20 train/loss tensor(2.9172) train/accuracy tensor(0.5392) train/lr 1.1735378512396695 val/loss tensor(3.1006) val/accuracy tensor(0.4932)
epoch 21 train/loss tensor(2.8741) train/accuracy tensor(0.5492) train/lr 1.10743653553719 val/loss tensor(2.9780) val/accuracy tensor(0.5199)
epoch 22 train/loss tensor(2.8352) train/accuracy tensor(0.5582) train/lr 1.0432512 val/loss tensor(2.8235) val/accuracy tensor(0.5492)
epoch 23 train/loss tensor(2.8029) train/accuracy tensor(0.5656) train/lr 0.9809818446280991 val/loss tensor(2.8687) val/accuracy tensor(0.5417)
epoch 24 train/loss tensor(2.7663) train/accuracy tensor(0.5747) train/lr 0.9206284694214879 val/loss tensor(2.7809) val/accuracy tensor(0.5589)
epoch 25 train/loss tensor(2.7362) train/accuracy tensor(0.5818) train/lr 0.8621910743801652 val/loss tensor(2.7572) val/accuracy tensor(0.5668)
epoch 26 train/loss tensor(2.7062) train/accuracy tensor(0.5885) train/lr 0.8056696595041324 val/loss tensor(2.8366) val/accuracy tensor(0.5517)
epoch 27 train/loss tensor(2.6813) train/accuracy tensor(0.5941) train/lr 0.7510642247933882 val/loss tensor(2.7213) val/accuracy tensor(0.5760)
epoch 28 train/loss tensor(2.6544) train/accuracy tensor(0.6009) train/lr 0.698374770247934 val/loss tensor(2.6901) val/accuracy tensor(0.5807)
epoch 29 train/loss tensor(2.6298) train/accuracy tensor(0.6064) train/lr 0.6476012958677687 val/loss tensor(2.6590) val/accuracy tensor(0.5973)
epoch 30 train/loss tensor(2.6076) train/accuracy tensor(0.6118) train/lr 0.5987438016528926 val/loss tensor(2.5714) val/accuracy tensor(0.6138)
epoch 31 train/loss tensor(2.5816) train/accuracy tensor(0.6179) train/lr 0.5518022876033059 val/loss tensor(2.6266) val/accuracy tensor(0.6074)
epoch 32 train/loss tensor(2.5616) train/accuracy tensor(0.6231) train/lr 0.5067767537190083 val/loss tensor(2.5123) val/accuracy tensor(0.6207)
epoch 33 train/loss tensor(2.5406) train/accuracy tensor(0.6278) train/lr 0.4636672000000001 val/loss tensor(2.4914) val/accuracy tensor(0.6317)
epoch 34 train/loss tensor(2.5209) train/accuracy tensor(0.6323) train/lr 0.422473626446281 val/loss tensor(2.4818) val/accuracy tensor(0.6309)
epoch 35 train/loss tensor(2.5067) train/accuracy tensor(0.6359) train/lr 0.38319603305785127 val/loss tensor(2.4380) val/accuracy tensor(0.6410)
epoch 36 train/loss tensor(2.4850) train/accuracy tensor(0.6416) train/lr 0.34583441983471075 val/loss tensor(2.4525) val/accuracy tensor(0.6368)
epoch 37 train/loss tensor(2.4721) train/accuracy tensor(0.6451) train/lr 0.31038878677685955 val/loss tensor(2.4182) val/accuracy tensor(0.6499)
epoch 38 train/loss tensor(2.4566) train/accuracy tensor(0.6486) train/lr 0.2768591338842975 val/loss tensor(2.3966) val/accuracy tensor(0.6528)
epoch 39 train/loss tensor(2.4412) train/accuracy tensor(0.6528) train/lr 0.24524546115702478 val/loss tensor(2.3796) val/accuracy tensor(0.6580)
epoch 40 train/loss tensor(2.4276) train/accuracy tensor(0.6557) train/lr 0.2155477685950413 val/loss tensor(2.3514) val/accuracy tensor(0.6617)
epoch 41 train/loss tensor(2.4156) train/accuracy tensor(0.6591) train/lr 0.18776605619834705 val/loss tensor(2.3546) val/accuracy tensor(0.6635)
epoch 42 train/loss tensor(2.4022) train/accuracy tensor(0.6621) train/lr 0.1619003239669421 val/loss tensor(2.3242) val/accuracy tensor(0.6705)
epoch 43 train/loss tensor(2.3958) train/accuracy tensor(0.6642) train/lr 0.1379505719008264 val/loss tensor(2.3100) val/accuracy tensor(0.6727)
epoch 44 train/loss tensor(2.3827) train/accuracy tensor(0.6670) train/lr 0.11591679999999994 val/loss tensor(2.2923) val/accuracy tensor(0.6784)
epoch 45 train/loss tensor(2.3726) train/accuracy tensor(0.6698) train/lr 0.09579900826446275 val/loss tensor(2.3010) val/accuracy tensor(0.6767)
epoch 46 train/loss tensor(2.3681) train/accuracy tensor(0.6708) train/lr 0.07759719669421493 val/loss tensor(2.2888) val/accuracy tensor(0.6792)
epoch 47 train/loss tensor(2.3617) train/accuracy tensor(0.6733) train/lr 0.061311365289256244 val/loss tensor(2.2701) val/accuracy tensor(0.6833)
epoch 48 train/loss tensor(2.3524) train/accuracy tensor(0.6751) train/lr 0.04694151404958682 val/loss tensor(2.2658) val/accuracy tensor(0.6855)
epoch 49 train/loss tensor(2.3483) train/accuracy tensor(0.6763) train/lr 0.03448764297520664 val/loss tensor(2.2593) val/accuracy tensor(0.6862)
epoch 50 train/loss tensor(2.3438) train/accuracy tensor(0.6771) train/lr 0.02394975206611572 val/loss tensor(2.2575) val/accuracy tensor(0.6860)
epoch 51 train/loss tensor(2.3408) train/accuracy tensor(0.6785) train/lr 0.015327841322314061 val/loss tensor(2.2540) val/accuracy tensor(0.6863)
epoch 52 train/loss tensor(2.3363) train/accuracy tensor(0.6793) train/lr 0.00862191074380166 val/loss tensor(2.2520) val/accuracy tensor(0.6886)
epoch 53 train/loss tensor(2.3346) train/accuracy tensor(0.6797) train/lr 0.0038319603305785152 val/loss tensor(2.2507) val/accuracy tensor(0.6878)
epoch 54 train/loss tensor(2.3344) train/accuracy tensor(0.6796) train/lr 0.0009579900826446288 val/loss tensor(2.2508) val/accuracy tensor(0.6873)
epoch 55 train/loss tensor(2.3344) train/accuracy tensor(0.6800) train/lr 0.0 val/loss tensor(2.2501) val/accuracy tensor(0.6884)

Training time: 0:21:55.483515
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5949) train/accuracy tensor(0.0104) train/lr 0.58864 val/loss tensor(6.6271) val/accuracy tensor(0.0113)
epoch 2 train/loss tensor(6.1883) train/accuracy tensor(0.0270) train/lr 1.16596 val/loss tensor(6.2531) val/accuracy tensor(0.0217)
epoch 3 train/loss tensor(5.8661) train/accuracy tensor(0.0491) train/lr 1.74328 val/loss tensor(6.0161) val/accuracy tensor(0.0442)
epoch 4 train/loss tensor(5.6000) train/accuracy tensor(0.0749) train/lr 2.3206 val/loss tensor(5.7436) val/accuracy tensor(0.0641)
epoch 5 train/loss tensor(5.3736) train/accuracy tensor(0.1003) train/lr 2.584873086419753 val/loss tensor(5.9066) val/accuracy tensor(0.0678)
epoch 6 train/loss tensor(5.0992) train/accuracy tensor(0.1352) train/lr 2.524410311111111 val/loss tensor(5.6417) val/accuracy tensor(0.0943)
epoch 7 train/loss tensor(4.8746) train/accuracy tensor(0.1662) train/lr 2.4646630716049387 val/loss tensor(5.8239) val/accuracy tensor(0.0812)
epoch 8 train/loss tensor(4.6934) train/accuracy tensor(0.1945) train/lr 2.4056313679012344 val/loss tensor(5.0328) val/accuracy tensor(0.1644)
epoch 9 train/loss tensor(4.5179) train/accuracy tensor(0.2234) train/lr 2.3473152 val/loss tensor(5.3641) val/accuracy tensor(0.1478)
epoch 10 train/loss tensor(4.3766) train/accuracy tensor(0.2471) train/lr 2.2897145679012345 val/loss tensor(4.6661) val/accuracy tensor(0.2036)
epoch 11 train/loss tensor(4.2382) train/accuracy tensor(0.2711) train/lr 2.2328294716049384 val/loss tensor(4.7155) val/accuracy tensor(0.1978)
epoch 12 train/loss tensor(4.1302) train/accuracy tensor(0.2905) train/lr 2.1766599111111113 val/loss tensor(4.8079) val/accuracy tensor(0.2043)
epoch 13 train/loss tensor(4.0085) train/accuracy tensor(0.3133) train/lr 2.1212058864197534 val/loss tensor(4.7572) val/accuracy tensor(0.2148)
epoch 14 train/loss tensor(3.8930) train/accuracy tensor(0.3345) train/lr 2.066467397530864 val/loss tensor(4.4596) val/accuracy tensor(0.2589)
epoch 15 train/loss tensor(3.7900) train/accuracy tensor(0.3551) train/lr 2.0124444444444447 val/loss tensor(4.1762) val/accuracy tensor(0.2766)
epoch 16 train/loss tensor(3.7189) train/accuracy tensor(0.3702) train/lr 1.9591370271604935 val/loss tensor(4.2151) val/accuracy tensor(0.2722)
epoch 17 train/loss tensor(3.6477) train/accuracy tensor(0.3832) train/lr 1.9065451456790126 val/loss tensor(4.3482) val/accuracy tensor(0.2696)
epoch 18 train/loss tensor(3.5731) train/accuracy tensor(0.3987) train/lr 1.8546688000000005 val/loss tensor(4.1094) val/accuracy tensor(0.3052)
epoch 19 train/loss tensor(3.5051) train/accuracy tensor(0.4126) train/lr 1.8035079901234565 val/loss tensor(4.1779) val/accuracy tensor(0.2866)
epoch 20 train/loss tensor(3.4459) train/accuracy tensor(0.4256) train/lr 1.7530627160493828 val/loss tensor(3.8860) val/accuracy tensor(0.3389)
epoch 21 train/loss tensor(3.3859) train/accuracy tensor(0.4381) train/lr 1.7033329777777777 val/loss tensor(3.9888) val/accuracy tensor(0.3229)
epoch 22 train/loss tensor(3.3383) train/accuracy tensor(0.4478) train/lr 1.654318775308642 val/loss tensor(3.8811) val/accuracy tensor(0.3417)
epoch 23 train/loss tensor(3.2929) train/accuracy tensor(0.4581) train/lr 1.6060201086419754 val/loss tensor(3.8214) val/accuracy tensor(0.3529)
epoch 24 train/loss tensor(3.2459) train/accuracy tensor(0.4680) train/lr 1.5584369777777782 val/loss tensor(3.7787) val/accuracy tensor(0.3552)
epoch 25 train/loss tensor(3.1985) train/accuracy tensor(0.4779) train/lr 1.5115693827160495 val/loss tensor(3.8625) val/accuracy tensor(0.3353)
epoch 26 train/loss tensor(3.1558) train/accuracy tensor(0.4879) train/lr 1.4654173234567902 val/loss tensor(3.6235) val/accuracy tensor(0.3809)
epoch 27 train/loss tensor(3.1200) train/accuracy tensor(0.4948) train/lr 1.4199807999999998 val/loss tensor(3.4868) val/accuracy tensor(0.4040)
epoch 28 train/loss tensor(3.0767) train/accuracy tensor(0.5047) train/lr 1.375259812345679 val/loss tensor(3.5475) val/accuracy tensor(0.3975)
epoch 29 train/loss tensor(3.0460) train/accuracy tensor(0.5119) train/lr 1.3312543604938272 val/loss tensor(3.5330) val/accuracy tensor(0.4073)
epoch 30 train/loss tensor(3.0029) train/accuracy tensor(0.5224) train/lr 1.2879644444444447 val/loss tensor(3.4522) val/accuracy tensor(0.4139)
epoch 31 train/loss tensor(2.9731) train/accuracy tensor(0.5289) train/lr 1.2453900641975308 val/loss tensor(3.4096) val/accuracy tensor(0.4278)
epoch 32 train/loss tensor(2.9416) train/accuracy tensor(0.5362) train/lr 1.203531219753086 val/loss tensor(3.3750) val/accuracy tensor(0.4248)
epoch 33 train/loss tensor(2.9055) train/accuracy tensor(0.5440) train/lr 1.162387911111111 val/loss tensor(3.3206) val/accuracy tensor(0.4496)
epoch 34 train/loss tensor(2.8797) train/accuracy tensor(0.5501) train/lr 1.121960138271605 val/loss tensor(3.1707) val/accuracy tensor(0.4703)
epoch 35 train/loss tensor(2.8536) train/accuracy tensor(0.5558) train/lr 1.082247901234568 val/loss tensor(3.5179) val/accuracy tensor(0.4051)
epoch 36 train/loss tensor(2.8173) train/accuracy tensor(0.5642) train/lr 1.0432512 val/loss tensor(3.1581) val/accuracy tensor(0.4763)
epoch 37 train/loss tensor(2.7912) train/accuracy tensor(0.5702) train/lr 1.0049700345679013 val/loss tensor(3.2251) val/accuracy tensor(0.4597)
epoch 38 train/loss tensor(2.7650) train/accuracy tensor(0.5765) train/lr 0.9674044049382714 val/loss tensor(3.0292) val/accuracy tensor(0.5071)
epoch 39 train/loss tensor(2.7383) train/accuracy tensor(0.5828) train/lr 0.930554311111111 val/loss tensor(3.0368) val/accuracy tensor(0.4978)
epoch 40 train/loss tensor(2.7140) train/accuracy tensor(0.5881) train/lr 0.8944197530864199 val/loss tensor(2.9105) val/accuracy tensor(0.5346)
epoch 41 train/loss tensor(2.6894) train/accuracy tensor(0.5940) train/lr 0.8590007308641977 val/loss tensor(2.9401) val/accuracy tensor(0.5185)
epoch 42 train/loss tensor(2.6672) train/accuracy tensor(0.5988) train/lr 0.8242972444444444 val/loss tensor(2.8096) val/accuracy tensor(0.5509)
epoch 43 train/loss tensor(2.6382) train/accuracy tensor(0.6055) train/lr 0.7903092938271603 val/loss tensor(2.8233) val/accuracy tensor(0.5547)
epoch 44 train/loss tensor(2.6164) train/accuracy tensor(0.6109) train/lr 0.7570368790123455 val/loss tensor(2.7955) val/accuracy tensor(0.5661)
epoch 45 train/loss tensor(2.5949) train/accuracy tensor(0.6166) train/lr 0.72448 val/loss tensor(2.8831) val/accuracy tensor(0.5508)
epoch 46 train/loss tensor(2.5695) train/accuracy tensor(0.6222) train/lr 0.6926386567901236 val/loss tensor(2.6518) val/accuracy tensor(0.5890)
epoch 47 train/loss tensor(2.5495) train/accuracy tensor(0.6272) train/lr 0.6615128493827159 val/loss tensor(2.8109) val/accuracy tensor(0.5589)
epoch 48 train/loss tensor(2.5277) train/accuracy tensor(0.6322) train/lr 0.6311025777777778 val/loss tensor(2.6845) val/accuracy tensor(0.5829)
epoch 49 train/loss tensor(2.5060) train/accuracy tensor(0.6373) train/lr 0.6014078419753088 val/loss tensor(2.5772) val/accuracy tensor(0.6151)
epoch 50 train/loss tensor(2.4895) train/accuracy tensor(0.6418) train/lr 0.5724286419753086 val/loss tensor(2.6798) val/accuracy tensor(0.5806)
epoch 51 train/loss tensor(2.4652) train/accuracy tensor(0.6472) train/lr 0.5441649777777778 val/loss tensor(2.6142) val/accuracy tensor(0.6060)
epoch 52 train/loss tensor(2.4488) train/accuracy tensor(0.6511) train/lr 0.5166168493827162 val/loss tensor(2.5977) val/accuracy tensor(0.6142)
epoch 53 train/loss tensor(2.4270) train/accuracy tensor(0.6568) train/lr 0.4897842567901234 val/loss tensor(2.5523) val/accuracy tensor(0.6262)
epoch 54 train/loss tensor(2.4060) train/accuracy tensor(0.6618) train/lr 0.4636672000000001 val/loss tensor(2.6474) val/accuracy tensor(0.5939)
epoch 55 train/loss tensor(2.3878) train/accuracy tensor(0.6661) train/lr 0.43826567901234553 val/loss tensor(2.5002) val/accuracy tensor(0.6263)
epoch 56 train/loss tensor(2.3688) train/accuracy tensor(0.6710) train/lr 0.4135796938271605 val/loss tensor(2.4244) val/accuracy tensor(0.6504)
epoch 57 train/loss tensor(2.3487) train/accuracy tensor(0.6756) train/lr 0.38960924444444456 val/loss tensor(2.4387) val/accuracy tensor(0.6423)
epoch 58 train/loss tensor(2.3309) train/accuracy tensor(0.6803) train/lr 0.36635433086419744 val/loss tensor(2.4180) val/accuracy tensor(0.6532)
epoch 59 train/loss tensor(2.3136) train/accuracy tensor(0.6852) train/lr 0.34381495308641974 val/loss tensor(2.4257) val/accuracy tensor(0.6473)
epoch 60 train/loss tensor(2.2958) train/accuracy tensor(0.6884) train/lr 0.3219911111111112 val/loss tensor(2.3769) val/accuracy tensor(0.6561)
epoch 61 train/loss tensor(2.2769) train/accuracy tensor(0.6940) train/lr 0.3008828049382715 val/loss tensor(2.3388) val/accuracy tensor(0.6652)
epoch 62 train/loss tensor(2.2616) train/accuracy tensor(0.6973) train/lr 0.2804900345679012 val/loss tensor(2.3170) val/accuracy tensor(0.6725)
epoch 63 train/loss tensor(2.2426) train/accuracy tensor(0.7020) train/lr 0.26081280000000007 val/loss tensor(2.3684) val/accuracy tensor(0.6703)
epoch 64 train/loss tensor(2.2267) train/accuracy tensor(0.7064) train/lr 0.24185110123456785 val/loss tensor(2.2612) val/accuracy tensor(0.6845)
epoch 65 train/loss tensor(2.2106) train/accuracy tensor(0.7107) train/lr 0.22360493827160496 val/loss tensor(2.2657) val/accuracy tensor(0.6849)
epoch 66 train/loss tensor(2.1939) train/accuracy tensor(0.7148) train/lr 0.20607431111111119 val/loss tensor(2.2592) val/accuracy tensor(0.6862)
epoch 67 train/loss tensor(2.1780) train/accuracy tensor(0.7186) train/lr 0.18925921975308638 val/loss tensor(2.2227) val/accuracy tensor(0.6932)
epoch 68 train/loss tensor(2.1658) train/accuracy tensor(0.7224) train/lr 0.1731596641975309 val/loss tensor(2.2074) val/accuracy tensor(0.6973)
epoch 69 train/loss tensor(2.1482) train/accuracy tensor(0.7263) train/lr 0.1577756444444444 val/loss tensor(2.1959) val/accuracy tensor(0.7001)
epoch 70 train/loss tensor(2.1355) train/accuracy tensor(0.7296) train/lr 0.14310716049382716 val/loss tensor(2.1811) val/accuracy tensor(0.7041)
epoch 71 train/loss tensor(2.1197) train/accuracy tensor(0.7336) train/lr 0.12915421234567906 val/loss tensor(2.1654) val/accuracy tensor(0.7093)
epoch 72 train/loss tensor(2.1086) train/accuracy tensor(0.7368) train/lr 0.11591679999999994 val/loss tensor(2.1379) val/accuracy tensor(0.7156)
epoch 73 train/loss tensor(2.0973) train/accuracy tensor(0.7400) train/lr 0.10339492345679012 val/loss tensor(2.1347) val/accuracy tensor(0.7158)
epoch 74 train/loss tensor(2.0835) train/accuracy tensor(0.7437) train/lr 0.09158858271604943 val/loss tensor(2.1079) val/accuracy tensor(0.7234)
epoch 75 train/loss tensor(2.0720) train/accuracy tensor(0.7470) train/lr 0.08049777777777775 val/loss tensor(2.1091) val/accuracy tensor(0.7216)
epoch 76 train/loss tensor(2.0615) train/accuracy tensor(0.7498) train/lr 0.0701225086419753 val/loss tensor(2.0963) val/accuracy tensor(0.7247)
epoch 77 train/loss tensor(2.0517) train/accuracy tensor(0.7521) train/lr 0.06046277530864202 val/loss tensor(2.0740) val/accuracy tensor(0.7303)
epoch 78 train/loss tensor(2.0409) train/accuracy tensor(0.7549) train/lr 0.05151857777777776 val/loss tensor(2.0707) val/accuracy tensor(0.7353)
epoch 79 train/loss tensor(2.0335) train/accuracy tensor(0.7571) train/lr 0.043289916049382725 val/loss tensor(2.0600) val/accuracy tensor(0.7362)
epoch 80 train/loss tensor(2.0259) train/accuracy tensor(0.7587) train/lr 0.035776790123456824 val/loss tensor(2.0597) val/accuracy tensor(0.7371)
epoch 81 train/loss tensor(2.0198) train/accuracy tensor(0.7609) train/lr 0.028979199999999986 val/loss tensor(2.0529) val/accuracy tensor(0.7365)
epoch 82 train/loss tensor(2.0111) train/accuracy tensor(0.7635) train/lr 0.022897145679012357 val/loss tensor(2.0494) val/accuracy tensor(0.7401)
epoch 83 train/loss tensor(2.0057) train/accuracy tensor(0.7652) train/lr 0.017530627160493802 val/loss tensor(2.0410) val/accuracy tensor(0.7396)
epoch 84 train/loss tensor(2.0008) train/accuracy tensor(0.7657) train/lr 0.01287964444444444 val/loss tensor(2.0370) val/accuracy tensor(0.7405)
epoch 85 train/loss tensor(1.9969) train/accuracy tensor(0.7675) train/lr 0.008944197530864206 val/loss tensor(2.0331) val/accuracy tensor(0.7434)
epoch 86 train/loss tensor(1.9935) train/accuracy tensor(0.7683) train/lr 0.005724286419753074 val/loss tensor(2.0325) val/accuracy tensor(0.7436)
epoch 87 train/loss tensor(1.9910) train/accuracy tensor(0.7689) train/lr 0.00321991111111111 val/loss tensor(2.0334) val/accuracy tensor(0.7434)
epoch 88 train/loss tensor(1.9912) train/accuracy tensor(0.7686) train/lr 0.0014310716049382758 val/loss tensor(2.0285) val/accuracy tensor(0.7437)
epoch 89 train/loss tensor(1.9871) train/accuracy tensor(0.7695) train/lr 0.00035776790123456543 val/loss tensor(2.0294) val/accuracy tensor(0.7441)
epoch 90 train/loss tensor(1.9870) train/accuracy tensor(0.7698) train/lr 0.0 val/loss tensor(2.0297) val/accuracy tensor(0.7444)

Training time: 0:35:56.803553
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6183) train/accuracy tensor(0.0098) train/lr 0.58864 val/loss tensor(6.7680) val/accuracy tensor(0.0043)
epoch 2 train/loss tensor(6.1884) train/accuracy tensor(0.0266) train/lr 1.16596 val/loss tensor(6.2708) val/accuracy tensor(0.0232)
epoch 3 train/loss tensor(5.8945) train/accuracy tensor(0.0479) train/lr 1.74328 val/loss tensor(6.0695) val/accuracy tensor(0.0412)
epoch 4 train/loss tensor(5.5963) train/accuracy tensor(0.0752) train/lr 2.3206 val/loss tensor(5.8489) val/accuracy tensor(0.0540)
epoch 5 train/loss tensor(5.3120) train/accuracy tensor(0.1084) train/lr 2.39497520661157 val/loss tensor(5.5379) val/accuracy tensor(0.0807)
epoch 6 train/loss tensor(5.0341) train/accuracy tensor(0.1451) train/lr 2.3001341884297517 val/loss tensor(5.4205) val/accuracy tensor(0.1231)
epoch 7 train/loss tensor(4.7833) train/accuracy tensor(0.1812) train/lr 2.2072091504132234 val/loss tensor(4.9841) val/accuracy tensor(0.1616)
epoch 8 train/loss tensor(4.5689) train/accuracy tensor(0.2153) train/lr 2.116200092561983 val/loss tensor(4.9049) val/accuracy tensor(0.1853)
epoch 9 train/loss tensor(4.3831) train/accuracy tensor(0.2465) train/lr 2.0271070148760333 val/loss tensor(4.7985) val/accuracy tensor(0.1936)
epoch 10 train/loss tensor(4.1986) train/accuracy tensor(0.2787) train/lr 1.9399299173553717 val/loss tensor(4.8147) val/accuracy tensor(0.1909)
epoch 11 train/loss tensor(4.0602) train/accuracy tensor(0.3035) train/lr 1.8546688000000005 val/loss tensor(4.4687) val/accuracy tensor(0.2317)
epoch 12 train/loss tensor(3.9141) train/accuracy tensor(0.3319) train/lr 1.7713236628099176 val/loss tensor(4.3632) val/accuracy tensor(0.2469)
epoch 13 train/loss tensor(3.7826) train/accuracy tensor(0.3572) train/lr 1.689894505785124 val/loss tensor(4.2305) val/accuracy tensor(0.2774)
epoch 14 train/loss tensor(3.6621) train/accuracy tensor(0.3815) train/lr 1.61038132892562 val/loss tensor(4.2733) val/accuracy tensor(0.2689)
epoch 15 train/loss tensor(3.5648) train/accuracy tensor(0.4014) train/lr 1.532784132231405 val/loss tensor(4.0393) val/accuracy tensor(0.3196)
epoch 16 train/loss tensor(3.4756) train/accuracy tensor(0.4197) train/lr 1.4571029157024795 val/loss tensor(4.0230) val/accuracy tensor(0.3177)
epoch 17 train/loss tensor(3.3954) train/accuracy tensor(0.4371) train/lr 1.383337679338843 val/loss tensor(3.5778) val/accuracy tensor(0.3809)
epoch 18 train/loss tensor(3.3087) train/accuracy tensor(0.4560) train/lr 1.311488423140496 val/loss tensor(3.7364) val/accuracy tensor(0.3648)
epoch 19 train/loss tensor(3.2475) train/accuracy tensor(0.4686) train/lr 1.2415551471074382 val/loss tensor(3.5690) val/accuracy tensor(0.3976)
epoch 20 train/loss tensor(3.1886) train/accuracy tensor(0.4818) train/lr 1.1735378512396695 val/loss tensor(3.3644) val/accuracy tensor(0.4314)
epoch 21 train/loss tensor(3.1263) train/accuracy tensor(0.4953) train/lr 1.10743653553719 val/loss tensor(3.4589) val/accuracy tensor(0.4137)
epoch 22 train/loss tensor(3.0630) train/accuracy tensor(0.5097) train/lr 1.0432512 val/loss tensor(3.3886) val/accuracy tensor(0.4324)
epoch 23 train/loss tensor(3.0120) train/accuracy tensor(0.5211) train/lr 0.9809818446280991 val/loss tensor(3.4559) val/accuracy tensor(0.4187)
epoch 24 train/loss tensor(2.9661) train/accuracy tensor(0.5314) train/lr 0.9206284694214879 val/loss tensor(3.1427) val/accuracy tensor(0.4879)
epoch 25 train/loss tensor(2.9189) train/accuracy tensor(0.5423) train/lr 0.8621910743801652 val/loss tensor(3.1709) val/accuracy tensor(0.4718)
epoch 26 train/loss tensor(2.8685) train/accuracy tensor(0.5538) train/lr 0.8056696595041324 val/loss tensor(3.0937) val/accuracy tensor(0.4900)
epoch 27 train/loss tensor(2.8285) train/accuracy tensor(0.5629) train/lr 0.7510642247933882 val/loss tensor(2.9902) val/accuracy tensor(0.5111)
epoch 28 train/loss tensor(2.7889) train/accuracy tensor(0.5722) train/lr 0.698374770247934 val/loss tensor(2.9524) val/accuracy tensor(0.5212)
epoch 29 train/loss tensor(2.7571) train/accuracy tensor(0.5801) train/lr 0.6476012958677687 val/loss tensor(2.8525) val/accuracy tensor(0.5545)
epoch 30 train/loss tensor(2.7155) train/accuracy tensor(0.5897) train/lr 0.5987438016528926 val/loss tensor(2.8079) val/accuracy tensor(0.5541)
epoch 31 train/loss tensor(2.6785) train/accuracy tensor(0.5985) train/lr 0.5518022876033059 val/loss tensor(2.8395) val/accuracy tensor(0.5499)
epoch 32 train/loss tensor(2.6468) train/accuracy tensor(0.6056) train/lr 0.5067767537190083 val/loss tensor(2.6979) val/accuracy tensor(0.5866)
epoch 33 train/loss tensor(2.6113) train/accuracy tensor(0.6149) train/lr 0.4636672000000001 val/loss tensor(2.7406) val/accuracy tensor(0.5925)
epoch 34 train/loss tensor(2.5800) train/accuracy tensor(0.6222) train/lr 0.422473626446281 val/loss tensor(2.6340) val/accuracy tensor(0.5950)
epoch 35 train/loss tensor(2.5502) train/accuracy tensor(0.6293) train/lr 0.38319603305785127 val/loss tensor(2.5969) val/accuracy tensor(0.6103)
epoch 36 train/loss tensor(2.5199) train/accuracy tensor(0.6372) train/lr 0.34583441983471075 val/loss tensor(2.5433) val/accuracy tensor(0.6186)
epoch 37 train/loss tensor(2.4928) train/accuracy tensor(0.6433) train/lr 0.31038878677685955 val/loss tensor(2.5045) val/accuracy tensor(0.6292)
epoch 38 train/loss tensor(2.4655) train/accuracy tensor(0.6497) train/lr 0.2768591338842975 val/loss tensor(2.5113) val/accuracy tensor(0.6315)
epoch 39 train/loss tensor(2.4406) train/accuracy tensor(0.6561) train/lr 0.24524546115702478 val/loss tensor(2.4029) val/accuracy tensor(0.6577)
epoch 40 train/loss tensor(2.4121) train/accuracy tensor(0.6629) train/lr 0.2155477685950413 val/loss tensor(2.3888) val/accuracy tensor(0.6574)
epoch 41 train/loss tensor(2.3907) train/accuracy tensor(0.6682) train/lr 0.18776605619834705 val/loss tensor(2.3522) val/accuracy tensor(0.6674)
epoch 42 train/loss tensor(2.3670) train/accuracy tensor(0.6744) train/lr 0.1619003239669421 val/loss tensor(2.3072) val/accuracy tensor(0.6762)
epoch 43 train/loss tensor(2.3442) train/accuracy tensor(0.6797) train/lr 0.1379505719008264 val/loss tensor(2.2996) val/accuracy tensor(0.6778)
epoch 44 train/loss tensor(2.3229) train/accuracy tensor(0.6856) train/lr 0.11591679999999994 val/loss tensor(2.2808) val/accuracy tensor(0.6842)
epoch 45 train/loss tensor(2.3071) train/accuracy tensor(0.6896) train/lr 0.09579900826446275 val/loss tensor(2.2438) val/accuracy tensor(0.6902)
epoch 46 train/loss tensor(2.2879) train/accuracy tensor(0.6943) train/lr 0.07759719669421493 val/loss tensor(2.2331) val/accuracy tensor(0.6942)
epoch 47 train/loss tensor(2.2738) train/accuracy tensor(0.6976) train/lr 0.061311365289256244 val/loss tensor(2.2056) val/accuracy tensor(0.7011)
epoch 48 train/loss tensor(2.2590) train/accuracy tensor(0.7017) train/lr 0.04694151404958682 val/loss tensor(2.1953) val/accuracy tensor(0.7049)
epoch 49 train/loss tensor(2.2488) train/accuracy tensor(0.7039) train/lr 0.03448764297520664 val/loss tensor(2.1793) val/accuracy tensor(0.7070)
epoch 50 train/loss tensor(2.2382) train/accuracy tensor(0.7070) train/lr 0.02394975206611572 val/loss tensor(2.1789) val/accuracy tensor(0.7103)
epoch 51 train/loss tensor(2.2293) train/accuracy tensor(0.7091) train/lr 0.015327841322314061 val/loss tensor(2.1636) val/accuracy tensor(0.7127)
epoch 52 train/loss tensor(2.2219) train/accuracy tensor(0.7118) train/lr 0.00862191074380166 val/loss tensor(2.1602) val/accuracy tensor(0.7132)
epoch 53 train/loss tensor(2.2170) train/accuracy tensor(0.7123) train/lr 0.0038319603305785152 val/loss tensor(2.1562) val/accuracy tensor(0.7134)
epoch 54 train/loss tensor(2.2159) train/accuracy tensor(0.7129) train/lr 0.0009579900826446288 val/loss tensor(2.1554) val/accuracy tensor(0.7132)
epoch 55 train/loss tensor(2.2138) train/accuracy tensor(0.7136) train/lr 0.0 val/loss tensor(2.1544) val/accuracy tensor(0.7132)

Training time: 0:22:26.535058
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.7680) train/accuracy tensor(0.0050) train/lr 0.58864 val/loss tensor(6.8121) val/accuracy tensor(0.0049)
epoch 2 train/loss tensor(6.3541) train/accuracy tensor(0.0181) train/lr 1.16596 val/loss tensor(6.7470) val/accuracy tensor(0.0123)
epoch 3 train/loss tensor(6.1149) train/accuracy tensor(0.0315) train/lr 1.74328 val/loss tensor(8.0902) val/accuracy tensor(0.0087)
epoch 4 train/loss tensor(6.1853) train/accuracy tensor(0.0275) train/lr 2.3206 val/loss tensor(8.8893) val/accuracy tensor(0.0052)
epoch 5 train/loss tensor(6.3326) train/accuracy tensor(0.0196) train/lr 2.584873086419753 val/loss tensor(7.7148) val/accuracy tensor(0.0062)
epoch 6 train/loss tensor(6.4162) train/accuracy tensor(0.0160) train/lr 2.524410311111111 val/loss tensor(7.9593) val/accuracy tensor(0.0037)
epoch 7 train/loss tensor(6.4528) train/accuracy tensor(0.0136) train/lr 2.4646630716049387 val/loss tensor(6.8626) val/accuracy tensor(0.0023)
epoch 8 train/loss tensor(6.4100) train/accuracy tensor(0.0154) train/lr 2.4056313679012344 val/loss tensor(6.6989) val/accuracy tensor(0.0073)
epoch 9 train/loss tensor(6.3669) train/accuracy tensor(0.0175) train/lr 2.3473152 val/loss tensor(6.7127) val/accuracy tensor(0.0067)
epoch 10 train/loss tensor(6.3168) train/accuracy tensor(0.0199) train/lr 2.2897145679012345 val/loss tensor(11.3641) val/accuracy tensor(0.0018)
epoch 11 train/loss tensor(6.2836) train/accuracy tensor(0.0215) train/lr 2.2328294716049384 val/loss tensor(6.6099) val/accuracy tensor(0.0108)
epoch 12 train/loss tensor(6.2526) train/accuracy tensor(0.0237) train/lr 2.1766599111111113 val/loss tensor(7.7808) val/accuracy tensor(0.0035)
epoch 13 train/loss tensor(6.2458) train/accuracy tensor(0.0243) train/lr 2.1212058864197534 val/loss tensor(6.5279) val/accuracy tensor(0.0171)
epoch 14 train/loss tensor(6.2097) train/accuracy tensor(0.0257) train/lr 2.066467397530864 val/loss tensor(7.0513) val/accuracy tensor(0.0122)
epoch 15 train/loss tensor(6.1889) train/accuracy tensor(0.0270) train/lr 2.0124444444444447 val/loss tensor(6.8463) val/accuracy tensor(0.0144)
epoch 16 train/loss tensor(6.1704) train/accuracy tensor(0.0283) train/lr 1.9591370271604935 val/loss tensor(6.6213) val/accuracy tensor(0.0161)
epoch 17 train/loss tensor(6.1374) train/accuracy tensor(0.0306) train/lr 1.9065451456790126 val/loss tensor(7.4774) val/accuracy tensor(0.0078)
epoch 18 train/loss tensor(6.0732) train/accuracy tensor(0.0352) train/lr 1.8546688000000005 val/loss tensor(6.3906) val/accuracy tensor(0.0194)
epoch 19 train/loss tensor(6.0259) train/accuracy tensor(0.0386) train/lr 1.8035079901234565 val/loss tensor(7.3242) val/accuracy tensor(0.0151)
epoch 20 train/loss tensor(5.9857) train/accuracy tensor(0.0418) train/lr 1.7530627160493828 val/loss tensor(6.4424) val/accuracy tensor(0.0184)
epoch 21 train/loss tensor(5.9978) train/accuracy tensor(0.0413) train/lr 1.7033329777777777 val/loss tensor(6.0237) val/accuracy tensor(0.0395)
epoch 22 train/loss tensor(5.9095) train/accuracy tensor(0.0486) train/lr 1.654318775308642 val/loss tensor(6.3181) val/accuracy tensor(0.0276)
epoch 23 train/loss tensor(5.8454) train/accuracy tensor(0.0536) train/lr 1.6060201086419754 val/loss tensor(5.9760) val/accuracy tensor(0.0407)
epoch 24 train/loss tensor(5.8405) train/accuracy tensor(0.0553) train/lr 1.5584369777777782 val/loss tensor(6.2277) val/accuracy tensor(0.0332)
epoch 25 train/loss tensor(5.7959) train/accuracy tensor(0.0597) train/lr 1.5115693827160495 val/loss tensor(6.3499) val/accuracy tensor(0.0327)
epoch 26 train/loss tensor(5.6933) train/accuracy tensor(0.0681) train/lr 1.4654173234567902 val/loss tensor(6.4786) val/accuracy tensor(0.0320)
epoch 27 train/loss tensor(5.6537) train/accuracy tensor(0.0725) train/lr 1.4199807999999998 val/loss tensor(6.3835) val/accuracy tensor(0.0383)
epoch 28 train/loss tensor(5.5995) train/accuracy tensor(0.0804) train/lr 1.375259812345679 val/loss tensor(6.1928) val/accuracy tensor(0.0435)
epoch 29 train/loss tensor(5.5410) train/accuracy tensor(0.0857) train/lr 1.3312543604938272 val/loss tensor(6.0049) val/accuracy tensor(0.0578)
epoch 30 train/loss tensor(5.4668) train/accuracy tensor(0.0942) train/lr 1.2879644444444447 val/loss tensor(6.7478) val/accuracy tensor(0.0357)
epoch 31 train/loss tensor(5.3784) train/accuracy tensor(0.1043) train/lr 1.2453900641975308 val/loss tensor(5.9043) val/accuracy tensor(0.0678)
epoch 32 train/loss tensor(5.3068) train/accuracy tensor(0.1137) train/lr 1.203531219753086 val/loss tensor(6.8376) val/accuracy tensor(0.0413)
epoch 33 train/loss tensor(5.2529) train/accuracy tensor(0.1224) train/lr 1.162387911111111 val/loss tensor(5.9208) val/accuracy tensor(0.0672)
epoch 34 train/loss tensor(5.1634) train/accuracy tensor(0.1323) train/lr 1.121960138271605 val/loss tensor(5.9396) val/accuracy tensor(0.0813)
epoch 35 train/loss tensor(5.0757) train/accuracy tensor(0.1454) train/lr 1.082247901234568 val/loss tensor(5.2746) val/accuracy tensor(0.1045)
epoch 36 train/loss tensor(4.9992) train/accuracy tensor(0.1558) train/lr 1.0432512 val/loss tensor(5.7135) val/accuracy tensor(0.0975)
epoch 37 train/loss tensor(4.9047) train/accuracy tensor(0.1696) train/lr 1.0049700345679013 val/loss tensor(6.0837) val/accuracy tensor(0.0682)
epoch 38 train/loss tensor(4.8178) train/accuracy tensor(0.1821) train/lr 0.9674044049382714 val/loss tensor(5.5699) val/accuracy tensor(0.1086)
epoch 39 train/loss tensor(4.7337) train/accuracy tensor(0.1967) train/lr 0.930554311111111 val/loss tensor(5.3608) val/accuracy tensor(0.1321)
epoch 40 train/loss tensor(4.6320) train/accuracy tensor(0.2100) train/lr 0.8944197530864199 val/loss tensor(5.0693) val/accuracy tensor(0.1485)
epoch 41 train/loss tensor(4.5620) train/accuracy tensor(0.2215) train/lr 0.8590007308641977 val/loss tensor(5.0299) val/accuracy tensor(0.1435)
epoch 42 train/loss tensor(4.4707) train/accuracy tensor(0.2378) train/lr 0.8242972444444444 val/loss tensor(4.9791) val/accuracy tensor(0.1757)
epoch 43 train/loss tensor(4.3696) train/accuracy tensor(0.2530) train/lr 0.7903092938271603 val/loss tensor(5.2704) val/accuracy tensor(0.1542)
epoch 44 train/loss tensor(4.2777) train/accuracy tensor(0.2696) train/lr 0.7570368790123455 val/loss tensor(4.8988) val/accuracy tensor(0.1847)
epoch 45 train/loss tensor(4.1919) train/accuracy tensor(0.2841) train/lr 0.72448 val/loss tensor(4.4890) val/accuracy tensor(0.2267)
epoch 46 train/loss tensor(4.0930) train/accuracy tensor(0.3014) train/lr 0.6926386567901236 val/loss tensor(4.5822) val/accuracy tensor(0.2232)
epoch 47 train/loss tensor(4.0086) train/accuracy tensor(0.3177) train/lr 0.6615128493827159 val/loss tensor(4.3363) val/accuracy tensor(0.2558)
epoch 48 train/loss tensor(3.9325) train/accuracy tensor(0.3327) train/lr 0.6311025777777778 val/loss tensor(4.2853) val/accuracy tensor(0.2615)
epoch 49 train/loss tensor(3.8517) train/accuracy tensor(0.3478) train/lr 0.6014078419753088 val/loss tensor(4.3591) val/accuracy tensor(0.2623)
epoch 50 train/loss tensor(3.7730) train/accuracy tensor(0.3621) train/lr 0.5724286419753086 val/loss tensor(4.3590) val/accuracy tensor(0.2544)
epoch 51 train/loss tensor(3.6989) train/accuracy tensor(0.3776) train/lr 0.5441649777777778 val/loss tensor(4.1449) val/accuracy tensor(0.2863)
epoch 52 train/loss tensor(3.6459) train/accuracy tensor(0.3874) train/lr 0.5166168493827162 val/loss tensor(4.0427) val/accuracy tensor(0.3115)
epoch 53 train/loss tensor(3.5768) train/accuracy tensor(0.4017) train/lr 0.4897842567901234 val/loss tensor(4.0816) val/accuracy tensor(0.2980)
epoch 54 train/loss tensor(3.5138) train/accuracy tensor(0.4148) train/lr 0.4636672000000001 val/loss tensor(3.9744) val/accuracy tensor(0.3254)
epoch 55 train/loss tensor(3.4601) train/accuracy tensor(0.4258) train/lr 0.43826567901234553 val/loss tensor(3.6726) val/accuracy tensor(0.3752)
epoch 56 train/loss tensor(3.3998) train/accuracy tensor(0.4392) train/lr 0.4135796938271605 val/loss tensor(3.5618) val/accuracy tensor(0.3967)
epoch 57 train/loss tensor(3.3496) train/accuracy tensor(0.4490) train/lr 0.38960924444444456 val/loss tensor(3.6801) val/accuracy tensor(0.3744)
epoch 58 train/loss tensor(3.2926) train/accuracy tensor(0.4627) train/lr 0.36635433086419744 val/loss tensor(3.5378) val/accuracy tensor(0.4035)
epoch 59 train/loss tensor(3.2402) train/accuracy tensor(0.4731) train/lr 0.34381495308641974 val/loss tensor(3.4309) val/accuracy tensor(0.4267)
epoch 60 train/loss tensor(3.1923) train/accuracy tensor(0.4840) train/lr 0.3219911111111112 val/loss tensor(3.4263) val/accuracy tensor(0.4336)
epoch 61 train/loss tensor(3.1447) train/accuracy tensor(0.4946) train/lr 0.3008828049382715 val/loss tensor(3.3922) val/accuracy tensor(0.4243)
epoch 62 train/loss tensor(3.1066) train/accuracy tensor(0.5033) train/lr 0.2804900345679012 val/loss tensor(3.2329) val/accuracy tensor(0.4708)
epoch 63 train/loss tensor(3.0662) train/accuracy tensor(0.5114) train/lr 0.26081280000000007 val/loss tensor(3.1423) val/accuracy tensor(0.4835)
epoch 64 train/loss tensor(3.0249) train/accuracy tensor(0.5217) train/lr 0.24185110123456785 val/loss tensor(3.2158) val/accuracy tensor(0.4845)
epoch 65 train/loss tensor(2.9886) train/accuracy tensor(0.5296) train/lr 0.22360493827160496 val/loss tensor(3.0422) val/accuracy tensor(0.5074)
epoch 66 train/loss tensor(2.9490) train/accuracy tensor(0.5386) train/lr 0.20607431111111119 val/loss tensor(3.1349) val/accuracy tensor(0.4820)
epoch 67 train/loss tensor(2.9161) train/accuracy tensor(0.5455) train/lr 0.18925921975308638 val/loss tensor(3.0066) val/accuracy tensor(0.5125)
epoch 68 train/loss tensor(2.8859) train/accuracy tensor(0.5529) train/lr 0.1731596641975309 val/loss tensor(2.9040) val/accuracy tensor(0.5330)
epoch 69 train/loss tensor(2.8492) train/accuracy tensor(0.5618) train/lr 0.1577756444444444 val/loss tensor(2.8227) val/accuracy tensor(0.5552)
epoch 70 train/loss tensor(2.8181) train/accuracy tensor(0.5690) train/lr 0.14310716049382716 val/loss tensor(2.8237) val/accuracy tensor(0.5606)
epoch 71 train/loss tensor(2.7875) train/accuracy tensor(0.5764) train/lr 0.12915421234567906 val/loss tensor(2.8248) val/accuracy tensor(0.5637)
epoch 72 train/loss tensor(2.7624) train/accuracy tensor(0.5820) train/lr 0.11591679999999994 val/loss tensor(2.7161) val/accuracy tensor(0.5848)
epoch 73 train/loss tensor(2.7313) train/accuracy tensor(0.5898) train/lr 0.10339492345679012 val/loss tensor(2.6586) val/accuracy tensor(0.5967)
epoch 74 train/loss tensor(2.7024) train/accuracy tensor(0.5960) train/lr 0.09158858271604943 val/loss tensor(2.6386) val/accuracy tensor(0.6008)
epoch 75 train/loss tensor(2.6772) train/accuracy tensor(0.6021) train/lr 0.08049777777777775 val/loss tensor(2.5699) val/accuracy tensor(0.6185)
epoch 76 train/loss tensor(2.6552) train/accuracy tensor(0.6075) train/lr 0.0701225086419753 val/loss tensor(2.6121) val/accuracy tensor(0.6107)
epoch 77 train/loss tensor(2.6311) train/accuracy tensor(0.6132) train/lr 0.06046277530864202 val/loss tensor(2.5574) val/accuracy tensor(0.6203)
epoch 78 train/loss tensor(2.6100) train/accuracy tensor(0.6188) train/lr 0.05151857777777776 val/loss tensor(2.4967) val/accuracy tensor(0.6367)
epoch 79 train/loss tensor(2.5879) train/accuracy tensor(0.6238) train/lr 0.043289916049382725 val/loss tensor(2.4555) val/accuracy tensor(0.6475)
epoch 80 train/loss tensor(2.5710) train/accuracy tensor(0.6279) train/lr 0.035776790123456824 val/loss tensor(2.4517) val/accuracy tensor(0.6470)
epoch 81 train/loss tensor(2.5499) train/accuracy tensor(0.6331) train/lr 0.028979199999999986 val/loss tensor(2.4111) val/accuracy tensor(0.6547)
epoch 82 train/loss tensor(2.5344) train/accuracy tensor(0.6368) train/lr 0.022897145679012357 val/loss tensor(2.4012) val/accuracy tensor(0.6607)
epoch 83 train/loss tensor(2.5196) train/accuracy tensor(0.6410) train/lr 0.017530627160493802 val/loss tensor(2.3692) val/accuracy tensor(0.6633)
epoch 84 train/loss tensor(2.5085) train/accuracy tensor(0.6431) train/lr 0.01287964444444444 val/loss tensor(2.3571) val/accuracy tensor(0.6679)
epoch 85 train/loss tensor(2.4980) train/accuracy tensor(0.6462) train/lr 0.008944197530864206 val/loss tensor(2.3448) val/accuracy tensor(0.6699)
epoch 86 train/loss tensor(2.4870) train/accuracy tensor(0.6486) train/lr 0.005724286419753074 val/loss tensor(2.3363) val/accuracy tensor(0.6720)
epoch 87 train/loss tensor(2.4808) train/accuracy tensor(0.6505) train/lr 0.00321991111111111 val/loss tensor(2.3289) val/accuracy tensor(0.6741)
epoch 88 train/loss tensor(2.4755) train/accuracy tensor(0.6519) train/lr 0.0014310716049382758 val/loss tensor(2.3233) val/accuracy tensor(0.6759)
epoch 89 train/loss tensor(2.4730) train/accuracy tensor(0.6525) train/lr 0.00035776790123456543 val/loss tensor(2.3224) val/accuracy tensor(0.6764)
epoch 90 train/loss tensor(2.4740) train/accuracy tensor(0.6523) train/lr 0.0 val/loss tensor(2.3220) val/accuracy tensor(0.6767)

Training time: 0:37:58.673370
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8115) train/accuracy tensor(0.0045) train/lr 0.58864 val/loss tensor(6.7797) val/accuracy tensor(0.0053)
epoch 2 train/loss tensor(6.4357) train/accuracy tensor(0.0152) train/lr 1.16596 val/loss tensor(7.3814) val/accuracy tensor(0.0095)
epoch 3 train/loss tensor(6.2151) train/accuracy tensor(0.0258) train/lr 1.74328 val/loss tensor(7.3190) val/accuracy tensor(0.0081)
epoch 4 train/loss tensor(6.1991) train/accuracy tensor(0.0272) train/lr 2.3206 val/loss tensor(7.7921) val/accuracy tensor(0.0112)
epoch 5 train/loss tensor(6.2781) train/accuracy tensor(0.0233) train/lr 2.39497520661157 val/loss tensor(6.9569) val/accuracy tensor(0.0089)
epoch 6 train/loss tensor(6.2985) train/accuracy tensor(0.0223) train/lr 2.3001341884297517 val/loss tensor(8.3674) val/accuracy tensor(0.0040)
epoch 7 train/loss tensor(6.2889) train/accuracy tensor(0.0225) train/lr 2.2072091504132234 val/loss tensor(7.8656) val/accuracy tensor(0.0080)
epoch 8 train/loss tensor(6.2346) train/accuracy tensor(0.0257) train/lr 2.116200092561983 val/loss tensor(6.5258) val/accuracy tensor(0.0129)
epoch 9 train/loss tensor(6.1694) train/accuracy tensor(0.0295) train/lr 2.0271070148760333 val/loss tensor(6.6102) val/accuracy tensor(0.0111)
epoch 10 train/loss tensor(6.1069) train/accuracy tensor(0.0336) train/lr 1.9399299173553717 val/loss tensor(6.4367) val/accuracy tensor(0.0202)
epoch 11 train/loss tensor(6.0319) train/accuracy tensor(0.0388) train/lr 1.8546688000000005 val/loss tensor(6.2030) val/accuracy tensor(0.0231)
epoch 12 train/loss tensor(5.9999) train/accuracy tensor(0.0421) train/lr 1.7713236628099176 val/loss tensor(6.4252) val/accuracy tensor(0.0205)
epoch 13 train/loss tensor(5.9151) train/accuracy tensor(0.0481) train/lr 1.689894505785124 val/loss tensor(6.2231) val/accuracy tensor(0.0329)
epoch 14 train/loss tensor(5.8112) train/accuracy tensor(0.0578) train/lr 1.61038132892562 val/loss tensor(6.2466) val/accuracy tensor(0.0336)
epoch 15 train/loss tensor(5.7486) train/accuracy tensor(0.0637) train/lr 1.532784132231405 val/loss tensor(6.1361) val/accuracy tensor(0.0400)
epoch 16 train/loss tensor(5.6475) train/accuracy tensor(0.0737) train/lr 1.4571029157024795 val/loss tensor(6.2319) val/accuracy tensor(0.0448)
epoch 17 train/loss tensor(5.5682) train/accuracy tensor(0.0827) train/lr 1.383337679338843 val/loss tensor(6.1408) val/accuracy tensor(0.0473)
epoch 18 train/loss tensor(5.5076) train/accuracy tensor(0.0906) train/lr 1.311488423140496 val/loss tensor(6.0521) val/accuracy tensor(0.0503)
epoch 19 train/loss tensor(5.3979) train/accuracy tensor(0.1034) train/lr 1.2415551471074382 val/loss tensor(6.2861) val/accuracy tensor(0.0478)
epoch 20 train/loss tensor(5.2881) train/accuracy tensor(0.1175) train/lr 1.1735378512396695 val/loss tensor(5.7208) val/accuracy tensor(0.0774)
epoch 21 train/loss tensor(5.1682) train/accuracy tensor(0.1320) train/lr 1.10743653553719 val/loss tensor(6.3587) val/accuracy tensor(0.0662)
epoch 22 train/loss tensor(5.0568) train/accuracy tensor(0.1481) train/lr 1.0432512 val/loss tensor(5.2947) val/accuracy tensor(0.1071)
epoch 23 train/loss tensor(4.9416) train/accuracy tensor(0.1644) train/lr 0.9809818446280991 val/loss tensor(5.4756) val/accuracy tensor(0.1083)
epoch 24 train/loss tensor(4.8282) train/accuracy tensor(0.1825) train/lr 0.9206284694214879 val/loss tensor(5.3894) val/accuracy tensor(0.1085)
epoch 25 train/loss tensor(4.6983) train/accuracy tensor(0.2006) train/lr 0.8621910743801652 val/loss tensor(4.9638) val/accuracy tensor(0.1540)
epoch 26 train/loss tensor(4.5717) train/accuracy tensor(0.2223) train/lr 0.8056696595041324 val/loss tensor(5.2508) val/accuracy tensor(0.1400)
epoch 27 train/loss tensor(4.4477) train/accuracy tensor(0.2437) train/lr 0.7510642247933882 val/loss tensor(4.8430) val/accuracy tensor(0.1866)
epoch 28 train/loss tensor(4.3177) train/accuracy tensor(0.2655) train/lr 0.698374770247934 val/loss tensor(4.9575) val/accuracy tensor(0.1764)
epoch 29 train/loss tensor(4.2026) train/accuracy tensor(0.2862) train/lr 0.6476012958677687 val/loss tensor(4.6002) val/accuracy tensor(0.2283)
epoch 30 train/loss tensor(4.0805) train/accuracy tensor(0.3085) train/lr 0.5987438016528926 val/loss tensor(4.4155) val/accuracy tensor(0.2427)
epoch 31 train/loss tensor(3.9615) train/accuracy tensor(0.3320) train/lr 0.5518022876033059 val/loss tensor(4.3537) val/accuracy tensor(0.2633)
epoch 32 train/loss tensor(3.8636) train/accuracy tensor(0.3502) train/lr 0.5067767537190083 val/loss tensor(3.9539) val/accuracy tensor(0.3183)
epoch 33 train/loss tensor(3.7559) train/accuracy tensor(0.3714) train/lr 0.4636672000000001 val/loss tensor(4.1124) val/accuracy tensor(0.3093)
epoch 34 train/loss tensor(3.6671) train/accuracy tensor(0.3891) train/lr 0.422473626446281 val/loss tensor(3.8983) val/accuracy tensor(0.3316)
epoch 35 train/loss tensor(3.5827) train/accuracy tensor(0.4067) train/lr 0.38319603305785127 val/loss tensor(3.8204) val/accuracy tensor(0.3485)
epoch 36 train/loss tensor(3.4978) train/accuracy tensor(0.4237) train/lr 0.34583441983471075 val/loss tensor(4.0150) val/accuracy tensor(0.3381)
epoch 37 train/loss tensor(3.4142) train/accuracy tensor(0.4415) train/lr 0.31038878677685955 val/loss tensor(3.7194) val/accuracy tensor(0.3635)
epoch 38 train/loss tensor(3.3403) train/accuracy tensor(0.4572) train/lr 0.2768591338842975 val/loss tensor(3.4645) val/accuracy tensor(0.4217)
epoch 39 train/loss tensor(3.2668) train/accuracy tensor(0.4733) train/lr 0.24524546115702478 val/loss tensor(3.4305) val/accuracy tensor(0.4295)
epoch 40 train/loss tensor(3.2042) train/accuracy tensor(0.4869) train/lr 0.2155477685950413 val/loss tensor(3.2227) val/accuracy tensor(0.4670)
epoch 41 train/loss tensor(3.1415) train/accuracy tensor(0.5003) train/lr 0.18776605619834705 val/loss tensor(3.2494) val/accuracy tensor(0.4660)
epoch 42 train/loss tensor(3.0864) train/accuracy tensor(0.5130) train/lr 0.1619003239669421 val/loss tensor(3.1315) val/accuracy tensor(0.4961)
epoch 43 train/loss tensor(3.0298) train/accuracy tensor(0.5260) train/lr 0.1379505719008264 val/loss tensor(3.0095) val/accuracy tensor(0.5155)
epoch 44 train/loss tensor(2.9778) train/accuracy tensor(0.5368) train/lr 0.11591679999999994 val/loss tensor(2.9011) val/accuracy tensor(0.5429)
epoch 45 train/loss tensor(2.9301) train/accuracy tensor(0.5481) train/lr 0.09579900826446275 val/loss tensor(2.8580) val/accuracy tensor(0.5514)
epoch 46 train/loss tensor(2.8829) train/accuracy tensor(0.5592) train/lr 0.07759719669421493 val/loss tensor(2.7813) val/accuracy tensor(0.5727)
epoch 47 train/loss tensor(2.8460) train/accuracy tensor(0.5681) train/lr 0.061311365289256244 val/loss tensor(2.7483) val/accuracy tensor(0.5804)
epoch 48 train/loss tensor(2.8072) train/accuracy tensor(0.5770) train/lr 0.04694151404958682 val/loss tensor(2.6664) val/accuracy tensor(0.5976)
epoch 49 train/loss tensor(2.7741) train/accuracy tensor(0.5842) train/lr 0.03448764297520664 val/loss tensor(2.6414) val/accuracy tensor(0.6097)
epoch 50 train/loss tensor(2.7454) train/accuracy tensor(0.5919) train/lr 0.02394975206611572 val/loss tensor(2.5957) val/accuracy tensor(0.6167)
epoch 51 train/loss tensor(2.7188) train/accuracy tensor(0.5972) train/lr 0.015327841322314061 val/loss tensor(2.5486) val/accuracy tensor(0.6283)
epoch 52 train/loss tensor(2.6973) train/accuracy tensor(0.6026) train/lr 0.00862191074380166 val/loss tensor(2.5257) val/accuracy tensor(0.6328)
epoch 53 train/loss tensor(2.6862) train/accuracy tensor(0.6059) train/lr 0.0038319603305785152 val/loss tensor(2.5072) val/accuracy tensor(0.6347)
epoch 54 train/loss tensor(2.6774) train/accuracy tensor(0.6082) train/lr 0.0009579900826446288 val/loss tensor(2.5030) val/accuracy tensor(0.6384)
epoch 55 train/loss tensor(2.6752) train/accuracy tensor(0.6087) train/lr 0.0 val/loss tensor(2.5027) val/accuracy tensor(0.6381)

Training time: 0:22:45.177712
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.1 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.1 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(7.1016) train/accuracy tensor(0.0012) train/lr 0.58864 val/loss tensor(7.4225) val/accuracy tensor(0.0009)
epoch 2 train/loss tensor(7.8543) train/accuracy tensor(0.0011) train/lr 1.16596 val/loss tensor(46600748.) val/accuracy tensor(0.0012)
epoch 3 train/loss tensor(61.1606) train/accuracy tensor(0.0010) train/lr 1.74328 val/loss tensor(9.5297e+13) val/accuracy tensor(0.0010)
epoch 4 train/loss tensor(2115.9858) train/accuracy tensor(0.0010) train/lr 2.3206 val/loss tensor(8.3303e+11) val/accuracy tensor(0.0011)
epoch 5 train/loss tensor(170638.9531) train/accuracy tensor(0.0010) train/lr 2.584873086419753 val/loss tensor(3.6548e+19) val/accuracy tensor(0.0009)
epoch 6 train/loss tensor(8071432.) train/accuracy tensor(0.0010) train/lr 2.524410311111111 val/loss tensor(4.2794e+23) val/accuracy tensor(0.0010)
epoch 7 train/loss tensor(2.0723e+08) train/accuracy tensor(0.0010) train/lr 2.4646630716049387 val/loss tensor(1.7221e+27) val/accuracy tensor(0.0010)
epoch 8 train/loss tensor(3.4756e+09) train/accuracy tensor(0.0010) train/lr 2.4056313679012344 val/loss tensor(3.2213e+20) val/accuracy tensor(0.0010)
epoch 9 train/loss tensor(2.4041e+11) train/accuracy tensor(0.0010) train/lr 2.3473152 val/loss tensor(1.0593e+17) val/accuracy tensor(0.0010)
epoch 10 train/loss tensor(8.9964e+12) train/accuracy tensor(0.0010) train/lr 2.2897145679012345 val/loss tensor(1.0892e+22) val/accuracy tensor(0.0011)
epoch 11 train/loss tensor(9.0799e+13) train/accuracy tensor(0.0010) train/lr 2.2328294716049384 val/loss tensor(7.1727e+22) val/accuracy tensor(0.0011)
epoch 12 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.1766599111111113 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 13 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.1212058864197534 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 14 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.066467397530864 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 15 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.0124444444444447 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 16 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.9591370271604935 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 17 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.9065451456790126 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 18 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.8546688000000005 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 19 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.8035079901234565 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 20 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.7530627160493828 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 21 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.7033329777777777 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 22 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.654318775308642 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 23 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.6060201086419754 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 24 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.5584369777777782 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 25 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.5115693827160495 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 26 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.4654173234567902 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 27 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.4199807999999998 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 28 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.375259812345679 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 29 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.3312543604938272 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 30 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.2879644444444447 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 31 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.2453900641975308 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 32 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.203531219753086 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 33 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.162387911111111 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 34 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.121960138271605 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 35 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.082247901234568 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 36 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.0432512 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 37 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.0049700345679013 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 38 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.9674044049382714 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 39 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.930554311111111 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 40 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.8944197530864199 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 41 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.8590007308641977 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 42 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.8242972444444444 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 43 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.7903092938271603 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 44 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.7570368790123455 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 45 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.72448 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 46 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.6926386567901236 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 47 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.6615128493827159 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 48 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.6311025777777778 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 49 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.6014078419753088 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 50 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.5724286419753086 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 51 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.5441649777777778 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 52 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.5166168493827162 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 53 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.4897842567901234 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 54 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.4636672000000001 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 55 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.43826567901234553 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 56 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.4135796938271605 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 57 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.38960924444444456 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 58 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.36635433086419744 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 59 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.34381495308641974 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 60 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.3219911111111112 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 61 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.3008828049382715 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 62 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.2804900345679012 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 63 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.26081280000000007 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 64 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.24185110123456785 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 65 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.22360493827160496 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 66 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.20607431111111119 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 67 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.18925921975308638 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 68 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.1731596641975309 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 69 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.1577756444444444 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 70 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.14310716049382716 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 71 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.12915421234567906 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 72 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.11591679999999994 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 73 train/loss tensor(nan) train/accuracy tensor(0.0011) train/lr 0.10339492345679012 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 74 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.09158858271604943 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 75 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.08049777777777775 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 76 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.0701225086419753 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 77 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.06046277530864202 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 78 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.05151857777777776 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 79 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.043289916049382725 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 80 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.035776790123456824 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 81 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.028979199999999986 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 82 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.022897145679012357 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 83 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.017530627160493802 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 84 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.01287964444444444 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 85 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.008944197530864206 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 86 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.005724286419753074 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 87 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.00321991111111111 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 88 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.0014310716049382758 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 89 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.00035776790123456543 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 90 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.0 val/loss tensor(nan) val/accuracy tensor(0.0009)

Training time: 0:37:28.518986
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.1 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.1 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(7.1822) train/accuracy tensor(0.0011) train/lr 0.58864 val/loss tensor(7.0500) val/accuracy tensor(0.0009)
epoch 2 train/loss tensor(7.5770) train/accuracy tensor(0.0012) train/lr 1.16596 val/loss tensor(1.0683e+10) val/accuracy tensor(0.0009)
epoch 3 train/loss tensor(134.9121) train/accuracy tensor(0.0010) train/lr 1.74328 val/loss tensor(2.0569e+16) val/accuracy tensor(0.0009)
epoch 4 train/loss tensor(4347.2627) train/accuracy tensor(0.0010) train/lr 2.3206 val/loss tensor(1.3396e+10) val/accuracy tensor(0.0009)
epoch 5 train/loss tensor(160907.0625) train/accuracy tensor(0.0010) train/lr 2.39497520661157 val/loss tensor(7.2195e+09) val/accuracy tensor(0.0010)
epoch 6 train/loss tensor(6383068.5000) train/accuracy tensor(0.0010) train/lr 2.3001341884297517 val/loss tensor(2.6436e+21) val/accuracy tensor(0.0009)
epoch 7 train/loss tensor(93534152.) train/accuracy tensor(0.0011) train/lr 2.2072091504132234 val/loss tensor(1.4621e+24) val/accuracy tensor(0.0009)
epoch 8 train/loss tensor(1.1792e+09) train/accuracy tensor(0.0010) train/lr 2.116200092561983 val/loss tensor(4.9135e+22) val/accuracy tensor(0.0012)
epoch 9 train/loss tensor(4.1507e+10) train/accuracy tensor(0.0010) train/lr 2.0271070148760333 val/loss tensor(1.0670e+17) val/accuracy tensor(0.0010)
epoch 10 train/loss tensor(6.7020e+11) train/accuracy tensor(0.0010) train/lr 1.9399299173553717 val/loss tensor(9.8583e+21) val/accuracy tensor(0.0009)
epoch 11 train/loss tensor(4.8067e+12) train/accuracy tensor(0.0010) train/lr 1.8546688000000005 val/loss tensor(9.0025e+23) val/accuracy tensor(0.0009)
epoch 12 train/loss tensor(2.9032e+13) train/accuracy tensor(0.0010) train/lr 1.7713236628099176 val/loss tensor(7.4760e+19) val/accuracy tensor(0.0010)
epoch 13 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.689894505785124 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 14 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.61038132892562 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 15 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.532784132231405 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 16 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.4571029157024795 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 17 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.383337679338843 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 18 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.311488423140496 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 19 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.2415551471074382 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 20 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.1735378512396695 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 21 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.10743653553719 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 22 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.0432512 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 23 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.9809818446280991 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 24 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.9206284694214879 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 25 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.8621910743801652 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 26 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.8056696595041324 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 27 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.7510642247933882 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 28 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.698374770247934 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 29 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.6476012958677687 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 30 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.5987438016528926 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 31 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.5518022876033059 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 32 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.5067767537190083 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 33 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.4636672000000001 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 34 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.422473626446281 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 35 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.38319603305785127 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 36 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.34583441983471075 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 37 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.31038878677685955 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 38 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.2768591338842975 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 39 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.24524546115702478 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 40 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.2155477685950413 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 41 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.18776605619834705 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 42 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.1619003239669421 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 43 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.1379505719008264 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 44 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.11591679999999994 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 45 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.09579900826446275 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 46 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.07759719669421493 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 47 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.061311365289256244 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 48 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.04694151404958682 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 49 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.03448764297520664 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 50 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.02394975206611572 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 51 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.015327841322314061 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 52 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.00862191074380166 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 53 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.0038319603305785152 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 54 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.0009579900826446288 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 55 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 0.0 val/loss tensor(nan) val/accuracy tensor(0.0009)

Training time: 0:22:25.608324
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.3 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001017  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.3 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001017
Launching rank 1 on remote node nid001020
Launching rank 2 on remote node nid001021
Launching rank 3 on remote node nid001025
Launching rank 4 on remote node nid001028
Launching rank 5 on remote node nid001029
Launching rank 6 on remote node nid001049
Launching rank 7 on remote node nid001052
Launching rank 8 on remote node nid001053
Launching rank 9 on remote node nid001057
Launching rank 10 on remote node nid001060
Launching rank 11 on remote node nid001061
Launching rank 12 on remote node nid001065
Launching rank 13 on remote node nid001068
Launching rank 14 on remote node nid001069
Launching rank 15 on remote node nid001189
Launching rank 16 on remote node nid001192
Launching rank 17 on remote node nid001193
Launching rank 18 on remote node nid001197
Launching rank 19 on remote node nid001200
Launching rank 20 on remote node nid001201
Launching rank 21 on remote node nid001205
Launching rank 22 on remote node nid001208
Launching rank 23 on remote node nid001209
Launching rank 24 on remote node nid001617
Launching rank 25 on remote node nid001620
Launching rank 26 on remote node nid001621
Launching rank 27 on remote node nid001625
Launching rank 28 on remote node nid001628
Launching rank 29 on remote node nid001629
Launching rank 30 on remote node nid001948
Launching rank 31 on remote node nid001949
Launching rank 32 on remote node nid001952
Launching rank 33 on remote node nid001972
Launching rank 34 on remote node nid001973
Launching rank 35 on remote node nid001976
Launching rank 36 on remote node nid001981
Launching rank 37 on remote node nid001984
Launching rank 38 on remote node nid001985
Launching rank 39 on remote node nid001989
Launching rank 40 on remote node nid001992
Launching rank 41 on remote node nid001993
Launching rank 42 on remote node nid001997
Launching rank 43 on remote node nid002000
Launching rank 44 on remote node nid002001
Launching rank 45 on remote node nid002005
Launching rank 46 on remote node nid002008
Launching rank 47 on remote node nid002009
Launching rank 48 on remote node nid003261
Launching rank 49 on remote node nid003264
Launching rank 50 on remote node nid003265
Launching rank 51 on remote node nid003268
Launching rank 52 on remote node nid003269
Launching rank 53 on remote node nid003272
Launching rank 54 on remote node nid003509
Launching rank 55 on remote node nid003512
Launching rank 56 on remote node nid003513
Launching rank 57 on remote node nid003516
Launching rank 58 on remote node nid003517
Launching rank 59 on remote node nid003520
Launching rank 60 on remote node nid003521
Launching rank 61 on remote node nid003525
Launching rank 62 on remote node nid003528
Launching rank 63 on remote node nid003529
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(43.9873) train/accuracy tensor(0.0010) train/lr 0.58864 val/loss tensor(4.7553e+17) val/accuracy tensor(0.0011)
epoch 2 train/loss tensor(106162.4609) train/accuracy tensor(0.0010) train/lr 1.16596 val/loss tensor(2.6507e+13) val/accuracy tensor(0.0011)
epoch 3 train/loss tensor(1.3514e+09) train/accuracy tensor(0.0010) train/lr 1.74328 val/loss tensor(1.5814e+26) val/accuracy tensor(0.0009)
epoch 4 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.3206 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 5 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.584873086419753 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 6 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.524410311111111 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 7 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.4646630716049387 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 8 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.4056313679012344 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 9 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.3473152 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 10 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.2897145679012345 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 11 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.2328294716049384 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 12 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.1766599111111113 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 13 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.1212058864197534 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 14 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.066467397530864 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 15 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 2.0124444444444447 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 16 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.9591370271604935 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 17 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.9065451456790126 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 18 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.8546688000000005 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 19 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.8035079901234565 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 20 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.7530627160493828 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 21 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.7033329777777777 val/loss tensor(nan) val/accuracy tensor(0.0009)
epoch 22 train/loss tensor(nan) train/accuracy tensor(0.0010) train/lr 1.654318775308642 val/loss tensor(nan) val/accuracy tensor(0.0009)
