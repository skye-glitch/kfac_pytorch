./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.001 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.001 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6422) train/accuracy tensor(0.0100) train/lr 0.58864 val/loss tensor(7.1512) val/accuracy tensor(0.0045)
epoch 2 train/loss tensor(6.0491) train/accuracy tensor(0.0361) train/lr 1.16596 val/loss tensor(6.4641) val/accuracy tensor(0.0195)
epoch 3 train/loss tensor(5.6884) train/accuracy tensor(0.0645) train/lr 1.74328 val/loss tensor(6.0482) val/accuracy tensor(0.0392)
epoch 4 train/loss tensor(5.3943) train/accuracy tensor(0.0955) train/lr 2.3206 val/loss tensor(5.7696) val/accuracy tensor(0.0734)
epoch 5 train/loss tensor(5.0386) train/accuracy tensor(0.1410) train/lr 2.584873086419753 val/loss tensor(5.5393) val/accuracy tensor(0.0897)
epoch 6 train/loss tensor(4.6740) train/accuracy tensor(0.1949) train/lr 2.524410311111111 val/loss tensor(4.9846) val/accuracy tensor(0.1450)
epoch 7 train/loss tensor(4.3595) train/accuracy tensor(0.2463) train/lr 2.4646630716049387 val/loss tensor(4.5552) val/accuracy tensor(0.2142)
epoch 8 train/loss tensor(4.1020) train/accuracy tensor(0.2923) train/lr 2.4056313679012344 val/loss tensor(4.4829) val/accuracy tensor(0.2285)
epoch 9 train/loss tensor(3.8955) train/accuracy tensor(0.3314) train/lr 2.3473152 val/loss tensor(4.1648) val/accuracy tensor(0.2661)
epoch 10 train/loss tensor(3.7292) train/accuracy tensor(0.3641) train/lr 2.2897145679012345 val/loss tensor(4.0901) val/accuracy tensor(0.2861)
epoch 11 train/loss tensor(3.5842) train/accuracy tensor(0.3941) train/lr 2.2328294716049384 val/loss tensor(3.7609) val/accuracy tensor(0.3508)
epoch 12 train/loss tensor(3.4654) train/accuracy tensor(0.4185) train/lr 2.1766599111111113 val/loss tensor(3.7037) val/accuracy tensor(0.3564)
epoch 13 train/loss tensor(3.3662) train/accuracy tensor(0.4399) train/lr 2.1212058864197534 val/loss tensor(3.7391) val/accuracy tensor(0.3541)
epoch 14 train/loss tensor(3.2811) train/accuracy tensor(0.4578) train/lr 2.066467397530864 val/loss tensor(3.4229) val/accuracy tensor(0.4143)
epoch 15 train/loss tensor(3.2046) train/accuracy tensor(0.4745) train/lr 2.0124444444444447 val/loss tensor(3.5843) val/accuracy tensor(0.3922)
epoch 16 train/loss tensor(3.1439) train/accuracy tensor(0.4871) train/lr 1.9591370271604935 val/loss tensor(3.2558) val/accuracy tensor(0.4497)
epoch 17 train/loss tensor(3.0807) train/accuracy tensor(0.5015) train/lr 1.9065451456790126 val/loss tensor(3.3946) val/accuracy tensor(0.4342)
epoch 18 train/loss tensor(3.0314) train/accuracy tensor(0.5129) train/lr 1.8546688000000005 val/loss tensor(3.1607) val/accuracy tensor(0.4768)
epoch 19 train/loss tensor(2.9827) train/accuracy tensor(0.5236) train/lr 1.8035079901234565 val/loss tensor(3.2852) val/accuracy tensor(0.4666)
epoch 20 train/loss tensor(2.9430) train/accuracy tensor(0.5333) train/lr 1.7530627160493828 val/loss tensor(3.1402) val/accuracy tensor(0.4783)
epoch 21 train/loss tensor(2.9014) train/accuracy tensor(0.5422) train/lr 1.7033329777777777 val/loss tensor(3.0292) val/accuracy tensor(0.5054)
epoch 22 train/loss tensor(2.8609) train/accuracy tensor(0.5515) train/lr 1.654318775308642 val/loss tensor(3.1202) val/accuracy tensor(0.4917)
epoch 23 train/loss tensor(2.8283) train/accuracy tensor(0.5595) train/lr 1.6060201086419754 val/loss tensor(2.9559) val/accuracy tensor(0.5185)
epoch 24 train/loss tensor(2.7969) train/accuracy tensor(0.5664) train/lr 1.5584369777777782 val/loss tensor(3.0003) val/accuracy tensor(0.5228)
epoch 25 train/loss tensor(2.7673) train/accuracy tensor(0.5729) train/lr 1.5115693827160495 val/loss tensor(2.9086) val/accuracy tensor(0.5309)
epoch 26 train/loss tensor(2.7368) train/accuracy tensor(0.5802) train/lr 1.4654173234567902 val/loss tensor(2.9065) val/accuracy tensor(0.5390)
epoch 27 train/loss tensor(2.7118) train/accuracy tensor(0.5861) train/lr 1.4199807999999998 val/loss tensor(2.8912) val/accuracy tensor(0.5375)
epoch 28 train/loss tensor(2.6867) train/accuracy tensor(0.5921) train/lr 1.375259812345679 val/loss tensor(2.9432) val/accuracy tensor(0.5227)
epoch 29 train/loss tensor(2.6624) train/accuracy tensor(0.5983) train/lr 1.3312543604938272 val/loss tensor(2.7651) val/accuracy tensor(0.5696)
epoch 30 train/loss tensor(2.6391) train/accuracy tensor(0.6033) train/lr 1.2879644444444447 val/loss tensor(2.7787) val/accuracy tensor(0.5637)
epoch 31 train/loss tensor(2.6140) train/accuracy tensor(0.6092) train/lr 1.2453900641975308 val/loss tensor(2.7494) val/accuracy tensor(0.5688)
epoch 32 train/loss tensor(2.5958) train/accuracy tensor(0.6140) train/lr 1.203531219753086 val/loss tensor(2.6237) val/accuracy tensor(0.5934)
epoch 33 train/loss tensor(2.5734) train/accuracy tensor(0.6192) train/lr 1.162387911111111 val/loss tensor(2.6921) val/accuracy tensor(0.5906)
epoch 34 train/loss tensor(2.5541) train/accuracy tensor(0.6240) train/lr 1.121960138271605 val/loss tensor(2.6166) val/accuracy tensor(0.6058)
epoch 35 train/loss tensor(2.5343) train/accuracy tensor(0.6284) train/lr 1.082247901234568 val/loss tensor(2.6092) val/accuracy tensor(0.5997)
epoch 36 train/loss tensor(2.5179) train/accuracy tensor(0.6321) train/lr 1.0432512 val/loss tensor(2.6199) val/accuracy tensor(0.6086)
epoch 37 train/loss tensor(2.4978) train/accuracy tensor(0.6377) train/lr 1.0049700345679013 val/loss tensor(2.5771) val/accuracy tensor(0.6049)
epoch 38 train/loss tensor(2.4804) train/accuracy tensor(0.6411) train/lr 0.9674044049382714 val/loss tensor(2.5533) val/accuracy tensor(0.6111)
epoch 39 train/loss tensor(2.4638) train/accuracy tensor(0.6456) train/lr 0.930554311111111 val/loss tensor(2.5730) val/accuracy tensor(0.6129)
epoch 40 train/loss tensor(2.4455) train/accuracy tensor(0.6499) train/lr 0.8944197530864199 val/loss tensor(2.5925) val/accuracy tensor(0.6089)
epoch 41 train/loss tensor(2.4329) train/accuracy tensor(0.6530) train/lr 0.8590007308641977 val/loss tensor(2.5205) val/accuracy tensor(0.6208)
epoch 42 train/loss tensor(2.4160) train/accuracy tensor(0.6573) train/lr 0.8242972444444444 val/loss tensor(2.5028) val/accuracy tensor(0.6246)
epoch 43 train/loss tensor(2.4006) train/accuracy tensor(0.6611) train/lr 0.7903092938271603 val/loss tensor(2.5008) val/accuracy tensor(0.6275)
epoch 44 train/loss tensor(2.3882) train/accuracy tensor(0.6638) train/lr 0.7570368790123455 val/loss tensor(2.4121) val/accuracy tensor(0.6485)
epoch 45 train/loss tensor(2.3723) train/accuracy tensor(0.6679) train/lr 0.72448 val/loss tensor(2.4747) val/accuracy tensor(0.6390)
epoch 46 train/loss tensor(2.3555) train/accuracy tensor(0.6722) train/lr 0.6926386567901236 val/loss tensor(2.4042) val/accuracy tensor(0.6488)
epoch 47 train/loss tensor(2.3431) train/accuracy tensor(0.6756) train/lr 0.6615128493827159 val/loss tensor(2.3488) val/accuracy tensor(0.6611)
epoch 48 train/loss tensor(2.3321) train/accuracy tensor(0.6784) train/lr 0.6311025777777778 val/loss tensor(2.4034) val/accuracy tensor(0.6551)
epoch 49 train/loss tensor(2.3188) train/accuracy tensor(0.6815) train/lr 0.6014078419753088 val/loss tensor(2.4062) val/accuracy tensor(0.6553)
epoch 50 train/loss tensor(2.3065) train/accuracy tensor(0.6838) train/lr 0.5724286419753086 val/loss tensor(2.3683) val/accuracy tensor(0.6577)
epoch 51 train/loss tensor(2.2944) train/accuracy tensor(0.6870) train/lr 0.5441649777777778 val/loss tensor(2.3700) val/accuracy tensor(0.6619)
epoch 52 train/loss tensor(2.2848) train/accuracy tensor(0.6898) train/lr 0.5166168493827162 val/loss tensor(2.3195) val/accuracy tensor(0.6722)
epoch 53 train/loss tensor(2.2689) train/accuracy tensor(0.6940) train/lr 0.4897842567901234 val/loss tensor(2.3125) val/accuracy tensor(0.6764)
epoch 54 train/loss tensor(2.2589) train/accuracy tensor(0.6964) train/lr 0.4636672000000001 val/loss tensor(2.3331) val/accuracy tensor(0.6667)
epoch 55 train/loss tensor(2.2480) train/accuracy tensor(0.6995) train/lr 0.43826567901234553 val/loss tensor(2.3025) val/accuracy tensor(0.6797)
epoch 56 train/loss tensor(2.2359) train/accuracy tensor(0.7018) train/lr 0.4135796938271605 val/loss tensor(2.2803) val/accuracy tensor(0.6835)
epoch 57 train/loss tensor(2.2271) train/accuracy tensor(0.7047) train/lr 0.38960924444444456 val/loss tensor(2.2625) val/accuracy tensor(0.6855)
epoch 58 train/loss tensor(2.2151) train/accuracy tensor(0.7080) train/lr 0.36635433086419744 val/loss tensor(2.2895) val/accuracy tensor(0.6773)
epoch 59 train/loss tensor(2.2069) train/accuracy tensor(0.7100) train/lr 0.34381495308641974 val/loss tensor(2.2534) val/accuracy tensor(0.6914)
epoch 60 train/loss tensor(2.1985) train/accuracy tensor(0.7119) train/lr 0.3219911111111112 val/loss tensor(2.2417) val/accuracy tensor(0.6894)
epoch 61 train/loss tensor(2.1882) train/accuracy tensor(0.7149) train/lr 0.3008828049382715 val/loss tensor(2.2574) val/accuracy tensor(0.6903)
epoch 62 train/loss tensor(2.1801) train/accuracy tensor(0.7167) train/lr 0.2804900345679012 val/loss tensor(2.2104) val/accuracy tensor(0.6995)
epoch 63 train/loss tensor(2.1706) train/accuracy tensor(0.7193) train/lr 0.26081280000000007 val/loss tensor(2.2135) val/accuracy tensor(0.6985)
epoch 64 train/loss tensor(2.1620) train/accuracy tensor(0.7212) train/lr 0.24185110123456785 val/loss tensor(2.1969) val/accuracy tensor(0.7033)
epoch 65 train/loss tensor(2.1565) train/accuracy tensor(0.7231) train/lr 0.22360493827160496 val/loss tensor(2.2026) val/accuracy tensor(0.7002)
epoch 66 train/loss tensor(2.1439) train/accuracy tensor(0.7260) train/lr 0.20607431111111119 val/loss tensor(2.1787) val/accuracy tensor(0.7053)
epoch 67 train/loss tensor(2.1360) train/accuracy tensor(0.7275) train/lr 0.18925921975308638 val/loss tensor(2.1707) val/accuracy tensor(0.7090)
epoch 68 train/loss tensor(2.1323) train/accuracy tensor(0.7293) train/lr 0.1731596641975309 val/loss tensor(2.1752) val/accuracy tensor(0.7088)
epoch 69 train/loss tensor(2.1222) train/accuracy tensor(0.7319) train/lr 0.1577756444444444 val/loss tensor(2.1517) val/accuracy tensor(0.7130)
epoch 70 train/loss tensor(2.1176) train/accuracy tensor(0.7337) train/lr 0.14310716049382716 val/loss tensor(2.1597) val/accuracy tensor(0.7121)
epoch 71 train/loss tensor(2.1119) train/accuracy tensor(0.7347) train/lr 0.12915421234567906 val/loss tensor(2.1507) val/accuracy tensor(0.7126)
epoch 72 train/loss tensor(2.1086) train/accuracy tensor(0.7362) train/lr 0.11591679999999994 val/loss tensor(2.1485) val/accuracy tensor(0.7153)
epoch 73 train/loss tensor(2.0986) train/accuracy tensor(0.7379) train/lr 0.10339492345679012 val/loss tensor(2.1379) val/accuracy tensor(0.7148)
epoch 74 train/loss tensor(2.0942) train/accuracy tensor(0.7392) train/lr 0.09158858271604943 val/loss tensor(2.1288) val/accuracy tensor(0.7209)
epoch 75 train/loss tensor(2.0893) train/accuracy tensor(0.7411) train/lr 0.08049777777777775 val/loss tensor(2.1219) val/accuracy tensor(0.7202)
epoch 76 train/loss tensor(2.0843) train/accuracy tensor(0.7420) train/lr 0.0701225086419753 val/loss tensor(2.1267) val/accuracy tensor(0.7198)
epoch 77 train/loss tensor(2.0831) train/accuracy tensor(0.7423) train/lr 0.06046277530864202 val/loss tensor(2.1129) val/accuracy tensor(0.7227)
epoch 78 train/loss tensor(2.0768) train/accuracy tensor(0.7442) train/lr 0.05151857777777776 val/loss tensor(2.1118) val/accuracy tensor(0.7224)
epoch 79 train/loss tensor(2.0727) train/accuracy tensor(0.7452) train/lr 0.043289916049382725 val/loss tensor(2.1074) val/accuracy tensor(0.7235)
epoch 80 train/loss tensor(2.0699) train/accuracy tensor(0.7459) train/lr 0.035776790123456824 val/loss tensor(2.1080) val/accuracy tensor(0.7242)
epoch 81 train/loss tensor(2.0671) train/accuracy tensor(0.7469) train/lr 0.028979199999999986 val/loss tensor(2.1076) val/accuracy tensor(0.7248)
epoch 82 train/loss tensor(2.0645) train/accuracy tensor(0.7478) train/lr 0.022897145679012357 val/loss tensor(2.1068) val/accuracy tensor(0.7249)
epoch 83 train/loss tensor(2.0609) train/accuracy tensor(0.7489) train/lr 0.017530627160493802 val/loss tensor(2.1006) val/accuracy tensor(0.7265)
epoch 84 train/loss tensor(2.0617) train/accuracy tensor(0.7481) train/lr 0.01287964444444444 val/loss tensor(2.0987) val/accuracy tensor(0.7254)
epoch 85 train/loss tensor(2.0605) train/accuracy tensor(0.7494) train/lr 0.008944197530864206 val/loss tensor(2.1007) val/accuracy tensor(0.7265)
epoch 86 train/loss tensor(2.0571) train/accuracy tensor(0.7494) train/lr 0.005724286419753074 val/loss tensor(2.0984) val/accuracy tensor(0.7277)
epoch 87 train/loss tensor(2.0567) train/accuracy tensor(0.7501) train/lr 0.00321991111111111 val/loss tensor(2.1006) val/accuracy tensor(0.7258)
epoch 88 train/loss tensor(2.0585) train/accuracy tensor(0.7494) train/lr 0.0014310716049382758 val/loss tensor(2.0970) val/accuracy tensor(0.7272)
epoch 89 train/loss tensor(2.0565) train/accuracy tensor(0.7503) train/lr 0.00035776790123456543 val/loss tensor(2.0986) val/accuracy tensor(0.7269)
epoch 90 train/loss tensor(2.0569) train/accuracy tensor(0.7498) train/lr 0.0 val/loss tensor(2.0971) val/accuracy tensor(0.7270)

Training time: 0:40:09.832376
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.003 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6242) train/accuracy tensor(0.0115) train/lr 0.58864 val/loss tensor(7.3561) val/accuracy tensor(0.0033)
epoch 2 train/loss tensor(6.0434) train/accuracy tensor(0.0370) train/lr 1.16596 val/loss tensor(6.5799) val/accuracy tensor(0.0187)
epoch 3 train/loss tensor(5.6923) train/accuracy tensor(0.0651) train/lr 1.74328 val/loss tensor(5.6821) val/accuracy tensor(0.0661)
epoch 4 train/loss tensor(5.3712) train/accuracy tensor(0.0986) train/lr 2.3206 val/loss tensor(5.9129) val/accuracy tensor(0.0562)
epoch 5 train/loss tensor(4.9895) train/accuracy tensor(0.1480) train/lr 2.39497520661157 val/loss tensor(5.2320) val/accuracy tensor(0.1089)
epoch 6 train/loss tensor(4.6194) train/accuracy tensor(0.2036) train/lr 2.3001341884297517 val/loss tensor(5.0548) val/accuracy tensor(0.1486)
epoch 7 train/loss tensor(4.2957) train/accuracy tensor(0.2577) train/lr 2.2072091504132234 val/loss tensor(4.6617) val/accuracy tensor(0.1985)
epoch 8 train/loss tensor(4.0551) train/accuracy tensor(0.3018) train/lr 2.116200092561983 val/loss tensor(4.2413) val/accuracy tensor(0.2544)
epoch 9 train/loss tensor(3.8436) train/accuracy tensor(0.3419) train/lr 2.0271070148760333 val/loss tensor(4.0011) val/accuracy tensor(0.3048)
epoch 10 train/loss tensor(3.6764) train/accuracy tensor(0.3753) train/lr 1.9399299173553717 val/loss tensor(3.7786) val/accuracy tensor(0.3386)
epoch 11 train/loss tensor(3.5446) train/accuracy tensor(0.4019) train/lr 1.8546688000000005 val/loss tensor(3.6774) val/accuracy tensor(0.3638)
epoch 12 train/loss tensor(3.4291) train/accuracy tensor(0.4257) train/lr 1.7713236628099176 val/loss tensor(3.4936) val/accuracy tensor(0.4003)
epoch 13 train/loss tensor(3.3301) train/accuracy tensor(0.4475) train/lr 1.689894505785124 val/loss tensor(3.4207) val/accuracy tensor(0.4203)
epoch 14 train/loss tensor(3.2484) train/accuracy tensor(0.4656) train/lr 1.61038132892562 val/loss tensor(3.3000) val/accuracy tensor(0.4509)
epoch 15 train/loss tensor(3.1739) train/accuracy tensor(0.4813) train/lr 1.532784132231405 val/loss tensor(3.2620) val/accuracy tensor(0.4509)
epoch 16 train/loss tensor(3.1137) train/accuracy tensor(0.4948) train/lr 1.4571029157024795 val/loss tensor(3.2032) val/accuracy tensor(0.4630)
epoch 17 train/loss tensor(3.0547) train/accuracy tensor(0.5080) train/lr 1.383337679338843 val/loss tensor(3.3023) val/accuracy tensor(0.4547)
epoch 18 train/loss tensor(2.9971) train/accuracy tensor(0.5212) train/lr 1.311488423140496 val/loss tensor(3.0671) val/accuracy tensor(0.4915)
epoch 19 train/loss tensor(2.9513) train/accuracy tensor(0.5318) train/lr 1.2415551471074382 val/loss tensor(3.0259) val/accuracy tensor(0.5056)
epoch 20 train/loss tensor(2.9040) train/accuracy tensor(0.5421) train/lr 1.1735378512396695 val/loss tensor(2.9527) val/accuracy tensor(0.5152)
epoch 21 train/loss tensor(2.8659) train/accuracy tensor(0.5512) train/lr 1.10743653553719 val/loss tensor(2.8961) val/accuracy tensor(0.5314)
epoch 22 train/loss tensor(2.8270) train/accuracy tensor(0.5596) train/lr 1.0432512 val/loss tensor(2.8940) val/accuracy tensor(0.5399)
epoch 23 train/loss tensor(2.7918) train/accuracy tensor(0.5685) train/lr 0.9809818446280991 val/loss tensor(2.8367) val/accuracy tensor(0.5541)
epoch 24 train/loss tensor(2.7604) train/accuracy tensor(0.5750) train/lr 0.9206284694214879 val/loss tensor(2.7608) val/accuracy tensor(0.5641)
epoch 25 train/loss tensor(2.7303) train/accuracy tensor(0.5827) train/lr 0.8621910743801652 val/loss tensor(2.7940) val/accuracy tensor(0.5659)
epoch 26 train/loss tensor(2.7024) train/accuracy tensor(0.5893) train/lr 0.8056696595041324 val/loss tensor(2.7493) val/accuracy tensor(0.5720)
epoch 27 train/loss tensor(2.6743) train/accuracy tensor(0.5957) train/lr 0.7510642247933882 val/loss tensor(2.6727) val/accuracy tensor(0.5860)
epoch 28 train/loss tensor(2.6448) train/accuracy tensor(0.6029) train/lr 0.698374770247934 val/loss tensor(2.6721) val/accuracy tensor(0.5881)
epoch 29 train/loss tensor(2.6221) train/accuracy tensor(0.6082) train/lr 0.6476012958677687 val/loss tensor(2.6220) val/accuracy tensor(0.5935)
epoch 30 train/loss tensor(2.5985) train/accuracy tensor(0.6139) train/lr 0.5987438016528926 val/loss tensor(2.5531) val/accuracy tensor(0.6125)
epoch 31 train/loss tensor(2.5732) train/accuracy tensor(0.6200) train/lr 0.5518022876033059 val/loss tensor(2.5783) val/accuracy tensor(0.6119)
epoch 32 train/loss tensor(2.5539) train/accuracy tensor(0.6247) train/lr 0.5067767537190083 val/loss tensor(2.5157) val/accuracy tensor(0.6205)
epoch 33 train/loss tensor(2.5356) train/accuracy tensor(0.6287) train/lr 0.4636672000000001 val/loss tensor(2.5251) val/accuracy tensor(0.6219)
epoch 34 train/loss tensor(2.5163) train/accuracy tensor(0.6335) train/lr 0.422473626446281 val/loss tensor(2.4750) val/accuracy tensor(0.6344)
epoch 35 train/loss tensor(2.4976) train/accuracy tensor(0.6388) train/lr 0.38319603305785127 val/loss tensor(2.4411) val/accuracy tensor(0.6402)
epoch 36 train/loss tensor(2.4824) train/accuracy tensor(0.6422) train/lr 0.34583441983471075 val/loss tensor(2.4241) val/accuracy tensor(0.6435)
epoch 37 train/loss tensor(2.4674) train/accuracy tensor(0.6460) train/lr 0.31038878677685955 val/loss tensor(2.4276) val/accuracy tensor(0.6447)
epoch 38 train/loss tensor(2.4500) train/accuracy tensor(0.6502) train/lr 0.2768591338842975 val/loss tensor(2.3974) val/accuracy tensor(0.6558)
epoch 39 train/loss tensor(2.4352) train/accuracy tensor(0.6536) train/lr 0.24524546115702478 val/loss tensor(2.3605) val/accuracy tensor(0.6616)
epoch 40 train/loss tensor(2.4206) train/accuracy tensor(0.6572) train/lr 0.2155477685950413 val/loss tensor(2.3380) val/accuracy tensor(0.6639)
epoch 41 train/loss tensor(2.4111) train/accuracy tensor(0.6599) train/lr 0.18776605619834705 val/loss tensor(2.3163) val/accuracy tensor(0.6676)
epoch 42 train/loss tensor(2.3972) train/accuracy tensor(0.6634) train/lr 0.1619003239669421 val/loss tensor(2.3063) val/accuracy tensor(0.6747)
epoch 43 train/loss tensor(2.3861) train/accuracy tensor(0.6659) train/lr 0.1379505719008264 val/loss tensor(2.3024) val/accuracy tensor(0.6752)
epoch 44 train/loss tensor(2.3757) train/accuracy tensor(0.6688) train/lr 0.11591679999999994 val/loss tensor(2.2882) val/accuracy tensor(0.6795)
epoch 45 train/loss tensor(2.3686) train/accuracy tensor(0.6702) train/lr 0.09579900826446275 val/loss tensor(2.2845) val/accuracy tensor(0.6810)
epoch 46 train/loss tensor(2.3589) train/accuracy tensor(0.6727) train/lr 0.07759719669421493 val/loss tensor(2.2687) val/accuracy tensor(0.6816)
epoch 47 train/loss tensor(2.3547) train/accuracy tensor(0.6740) train/lr 0.061311365289256244 val/loss tensor(2.2634) val/accuracy tensor(0.6820)
epoch 48 train/loss tensor(2.3474) train/accuracy tensor(0.6759) train/lr 0.04694151404958682 val/loss tensor(2.2586) val/accuracy tensor(0.6858)
epoch 49 train/loss tensor(2.3414) train/accuracy tensor(0.6775) train/lr 0.03448764297520664 val/loss tensor(2.2494) val/accuracy tensor(0.6874)
epoch 50 train/loss tensor(2.3382) train/accuracy tensor(0.6783) train/lr 0.02394975206611572 val/loss tensor(2.2493) val/accuracy tensor(0.6871)
epoch 51 train/loss tensor(2.3351) train/accuracy tensor(0.6791) train/lr 0.015327841322314061 val/loss tensor(2.2457) val/accuracy tensor(0.6882)
epoch 52 train/loss tensor(2.3305) train/accuracy tensor(0.6807) train/lr 0.00862191074380166 val/loss tensor(2.2411) val/accuracy tensor(0.6892)
epoch 53 train/loss tensor(2.3308) train/accuracy tensor(0.6803) train/lr 0.0038319603305785152 val/loss tensor(2.2404) val/accuracy tensor(0.6908)
epoch 54 train/loss tensor(2.3292) train/accuracy tensor(0.6808) train/lr 0.0009579900826446288 val/loss tensor(2.2404) val/accuracy tensor(0.6890)
epoch 55 train/loss tensor(2.3291) train/accuracy tensor(0.6809) train/lr 0.0 val/loss tensor(2.2391) val/accuracy tensor(0.6893)

Training time: 0:21:42.496606
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.005 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.005 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5805) train/accuracy tensor(0.0118) train/lr 0.58864 val/loss tensor(7.3584) val/accuracy tensor(0.0046)
epoch 2 train/loss tensor(6.0608) train/accuracy tensor(0.0348) train/lr 1.16596 val/loss tensor(6.1481) val/accuracy tensor(0.0246)
epoch 3 train/loss tensor(5.7170) train/accuracy tensor(0.0618) train/lr 1.74328 val/loss tensor(5.9883) val/accuracy tensor(0.0405)
epoch 4 train/loss tensor(5.4158) train/accuracy tensor(0.0938) train/lr 2.3206 val/loss tensor(6.2994) val/accuracy tensor(0.0469)
epoch 5 train/loss tensor(5.1019) train/accuracy tensor(0.1325) train/lr 2.584873086419753 val/loss tensor(5.5545) val/accuracy tensor(0.0886)
epoch 6 train/loss tensor(4.7398) train/accuracy tensor(0.1854) train/lr 2.524410311111111 val/loss tensor(5.0170) val/accuracy tensor(0.1604)
epoch 7 train/loss tensor(4.4408) train/accuracy tensor(0.2331) train/lr 2.4646630716049387 val/loss tensor(4.7237) val/accuracy tensor(0.1793)
epoch 8 train/loss tensor(4.1670) train/accuracy tensor(0.2812) train/lr 2.4056313679012344 val/loss tensor(4.5531) val/accuracy tensor(0.2140)
epoch 9 train/loss tensor(3.9577) train/accuracy tensor(0.3203) train/lr 2.3473152 val/loss tensor(4.2201) val/accuracy tensor(0.2623)
epoch 10 train/loss tensor(3.7866) train/accuracy tensor(0.3532) train/lr 2.2897145679012345 val/loss tensor(3.9191) val/accuracy tensor(0.3131)
epoch 11 train/loss tensor(3.6452) train/accuracy tensor(0.3821) train/lr 2.2328294716049384 val/loss tensor(4.1150) val/accuracy tensor(0.2835)
epoch 12 train/loss tensor(3.5254) train/accuracy tensor(0.4066) train/lr 2.1766599111111113 val/loss tensor(3.7829) val/accuracy tensor(0.3600)
epoch 13 train/loss tensor(3.4203) train/accuracy tensor(0.4296) train/lr 2.1212058864197534 val/loss tensor(4.1261) val/accuracy tensor(0.3093)
epoch 14 train/loss tensor(3.3356) train/accuracy tensor(0.4471) train/lr 2.066467397530864 val/loss tensor(3.6981) val/accuracy tensor(0.3631)
epoch 15 train/loss tensor(3.2589) train/accuracy tensor(0.4637) train/lr 2.0124444444444447 val/loss tensor(3.4751) val/accuracy tensor(0.4037)
epoch 16 train/loss tensor(3.1946) train/accuracy tensor(0.4778) train/lr 1.9591370271604935 val/loss tensor(3.3820) val/accuracy tensor(0.4299)
epoch 17 train/loss tensor(3.1327) train/accuracy tensor(0.4913) train/lr 1.9065451456790126 val/loss tensor(3.3485) val/accuracy tensor(0.4305)
epoch 18 train/loss tensor(3.0788) train/accuracy tensor(0.5032) train/lr 1.8546688000000005 val/loss tensor(3.2119) val/accuracy tensor(0.4695)
epoch 19 train/loss tensor(3.0251) train/accuracy tensor(0.5158) train/lr 1.8035079901234565 val/loss tensor(3.2804) val/accuracy tensor(0.4430)
epoch 20 train/loss tensor(2.9869) train/accuracy tensor(0.5237) train/lr 1.7530627160493828 val/loss tensor(3.1206) val/accuracy tensor(0.4837)
epoch 21 train/loss tensor(2.9441) train/accuracy tensor(0.5337) train/lr 1.7033329777777777 val/loss tensor(3.3166) val/accuracy tensor(0.4431)
epoch 22 train/loss tensor(2.9071) train/accuracy tensor(0.5420) train/lr 1.654318775308642 val/loss tensor(3.1800) val/accuracy tensor(0.4676)
epoch 23 train/loss tensor(2.8706) train/accuracy tensor(0.5501) train/lr 1.6060201086419754 val/loss tensor(3.2720) val/accuracy tensor(0.4506)
epoch 24 train/loss tensor(2.8387) train/accuracy tensor(0.5578) train/lr 1.5584369777777782 val/loss tensor(3.1654) val/accuracy tensor(0.4803)
epoch 25 train/loss tensor(2.8067) train/accuracy tensor(0.5650) train/lr 1.5115693827160495 val/loss tensor(3.1600) val/accuracy tensor(0.4818)
epoch 26 train/loss tensor(2.7744) train/accuracy tensor(0.5725) train/lr 1.4654173234567902 val/loss tensor(3.1217) val/accuracy tensor(0.4870)
epoch 27 train/loss tensor(2.7490) train/accuracy tensor(0.5788) train/lr 1.4199807999999998 val/loss tensor(3.0793) val/accuracy tensor(0.4903)
epoch 28 train/loss tensor(2.7203) train/accuracy tensor(0.5854) train/lr 1.375259812345679 val/loss tensor(2.9777) val/accuracy tensor(0.5219)
epoch 29 train/loss tensor(2.7001) train/accuracy tensor(0.5900) train/lr 1.3312543604938272 val/loss tensor(2.9872) val/accuracy tensor(0.5254)
epoch 30 train/loss tensor(2.6707) train/accuracy tensor(0.5970) train/lr 1.2879644444444447 val/loss tensor(2.8992) val/accuracy tensor(0.5241)
epoch 31 train/loss tensor(2.6461) train/accuracy tensor(0.6025) train/lr 1.2453900641975308 val/loss tensor(2.8466) val/accuracy tensor(0.5435)
epoch 32 train/loss tensor(2.6282) train/accuracy tensor(0.6068) train/lr 1.203531219753086 val/loss tensor(2.7925) val/accuracy tensor(0.5531)
epoch 33 train/loss tensor(2.6039) train/accuracy tensor(0.6128) train/lr 1.162387911111111 val/loss tensor(2.8927) val/accuracy tensor(0.5480)
epoch 34 train/loss tensor(2.5833) train/accuracy tensor(0.6174) train/lr 1.121960138271605 val/loss tensor(2.7746) val/accuracy tensor(0.5645)
epoch 35 train/loss tensor(2.5635) train/accuracy tensor(0.6223) train/lr 1.082247901234568 val/loss tensor(2.8121) val/accuracy tensor(0.5526)
epoch 36 train/loss tensor(2.5409) train/accuracy tensor(0.6280) train/lr 1.0432512 val/loss tensor(2.8113) val/accuracy tensor(0.5535)
epoch 37 train/loss tensor(2.5223) train/accuracy tensor(0.6323) train/lr 1.0049700345679013 val/loss tensor(2.7426) val/accuracy tensor(0.5686)
epoch 38 train/loss tensor(2.5022) train/accuracy tensor(0.6365) train/lr 0.9674044049382714 val/loss tensor(2.6541) val/accuracy tensor(0.5924)
epoch 39 train/loss tensor(2.4850) train/accuracy tensor(0.6413) train/lr 0.930554311111111 val/loss tensor(2.5797) val/accuracy tensor(0.6115)
epoch 40 train/loss tensor(2.4682) train/accuracy tensor(0.6451) train/lr 0.8944197530864199 val/loss tensor(2.5903) val/accuracy tensor(0.6132)
epoch 41 train/loss tensor(2.4499) train/accuracy tensor(0.6491) train/lr 0.8590007308641977 val/loss tensor(2.5440) val/accuracy tensor(0.6180)
epoch 42 train/loss tensor(2.4301) train/accuracy tensor(0.6538) train/lr 0.8242972444444444 val/loss tensor(2.5194) val/accuracy tensor(0.6217)
epoch 43 train/loss tensor(2.4140) train/accuracy tensor(0.6584) train/lr 0.7903092938271603 val/loss tensor(2.5758) val/accuracy tensor(0.6206)
epoch 44 train/loss tensor(2.3980) train/accuracy tensor(0.6619) train/lr 0.7570368790123455 val/loss tensor(2.5223) val/accuracy tensor(0.6239)
epoch 45 train/loss tensor(2.3814) train/accuracy tensor(0.6658) train/lr 0.72448 val/loss tensor(2.5245) val/accuracy tensor(0.6239)
epoch 46 train/loss tensor(2.3665) train/accuracy tensor(0.6702) train/lr 0.6926386567901236 val/loss tensor(2.4732) val/accuracy tensor(0.6345)
epoch 47 train/loss tensor(2.3484) train/accuracy tensor(0.6746) train/lr 0.6615128493827159 val/loss tensor(2.4594) val/accuracy tensor(0.6439)
epoch 48 train/loss tensor(2.3352) train/accuracy tensor(0.6776) train/lr 0.6311025777777778 val/loss tensor(2.3842) val/accuracy tensor(0.6552)
epoch 49 train/loss tensor(2.3224) train/accuracy tensor(0.6803) train/lr 0.6014078419753088 val/loss tensor(2.4214) val/accuracy tensor(0.6533)
epoch 50 train/loss tensor(2.3051) train/accuracy tensor(0.6858) train/lr 0.5724286419753086 val/loss tensor(2.3708) val/accuracy tensor(0.6566)
epoch 51 train/loss tensor(2.2907) train/accuracy tensor(0.6882) train/lr 0.5441649777777778 val/loss tensor(2.3577) val/accuracy tensor(0.6671)
epoch 52 train/loss tensor(2.2757) train/accuracy tensor(0.6919) train/lr 0.5166168493827162 val/loss tensor(2.3927) val/accuracy tensor(0.6570)
epoch 53 train/loss tensor(2.2632) train/accuracy tensor(0.6955) train/lr 0.4897842567901234 val/loss tensor(2.3468) val/accuracy tensor(0.6627)
epoch 54 train/loss tensor(2.2489) train/accuracy tensor(0.6995) train/lr 0.4636672000000001 val/loss tensor(2.3127) val/accuracy tensor(0.6708)
epoch 55 train/loss tensor(2.2363) train/accuracy tensor(0.7025) train/lr 0.43826567901234553 val/loss tensor(2.2824) val/accuracy tensor(0.6779)
epoch 56 train/loss tensor(2.2196) train/accuracy tensor(0.7064) train/lr 0.4135796938271605 val/loss tensor(2.2618) val/accuracy tensor(0.6836)
epoch 57 train/loss tensor(2.2099) train/accuracy tensor(0.7090) train/lr 0.38960924444444456 val/loss tensor(2.2814) val/accuracy tensor(0.6844)
epoch 58 train/loss tensor(2.1960) train/accuracy tensor(0.7127) train/lr 0.36635433086419744 val/loss tensor(2.2502) val/accuracy tensor(0.6863)
epoch 59 train/loss tensor(2.1844) train/accuracy tensor(0.7158) train/lr 0.34381495308641974 val/loss tensor(2.2386) val/accuracy tensor(0.6904)
epoch 60 train/loss tensor(2.1715) train/accuracy tensor(0.7189) train/lr 0.3219911111111112 val/loss tensor(2.2269) val/accuracy tensor(0.6947)
epoch 61 train/loss tensor(2.1604) train/accuracy tensor(0.7214) train/lr 0.3008828049382715 val/loss tensor(2.2184) val/accuracy tensor(0.6931)
epoch 62 train/loss tensor(2.1493) train/accuracy tensor(0.7247) train/lr 0.2804900345679012 val/loss tensor(2.1884) val/accuracy tensor(0.7023)
epoch 63 train/loss tensor(2.1360) train/accuracy tensor(0.7281) train/lr 0.26081280000000007 val/loss tensor(2.1825) val/accuracy tensor(0.7046)
epoch 64 train/loss tensor(2.1274) train/accuracy tensor(0.7305) train/lr 0.24185110123456785 val/loss tensor(2.1738) val/accuracy tensor(0.7068)
epoch 65 train/loss tensor(2.1175) train/accuracy tensor(0.7333) train/lr 0.22360493827160496 val/loss tensor(2.1790) val/accuracy tensor(0.7047)
epoch 66 train/loss tensor(2.1067) train/accuracy tensor(0.7361) train/lr 0.20607431111111119 val/loss tensor(2.1425) val/accuracy tensor(0.7156)
epoch 67 train/loss tensor(2.0947) train/accuracy tensor(0.7392) train/lr 0.18925921975308638 val/loss tensor(2.1474) val/accuracy tensor(0.7154)
epoch 68 train/loss tensor(2.0848) train/accuracy tensor(0.7416) train/lr 0.1731596641975309 val/loss tensor(2.1328) val/accuracy tensor(0.7173)
epoch 69 train/loss tensor(2.0763) train/accuracy tensor(0.7436) train/lr 0.1577756444444444 val/loss tensor(2.1171) val/accuracy tensor(0.7191)
epoch 70 train/loss tensor(2.0669) train/accuracy tensor(0.7463) train/lr 0.14310716049382716 val/loss tensor(2.1091) val/accuracy tensor(0.7238)
epoch 71 train/loss tensor(2.0574) train/accuracy tensor(0.7490) train/lr 0.12915421234567906 val/loss tensor(2.0946) val/accuracy tensor(0.7254)
epoch 72 train/loss tensor(2.0523) train/accuracy tensor(0.7503) train/lr 0.11591679999999994 val/loss tensor(2.0906) val/accuracy tensor(0.7265)
epoch 73 train/loss tensor(2.0445) train/accuracy tensor(0.7524) train/lr 0.10339492345679012 val/loss tensor(2.0870) val/accuracy tensor(0.7271)
epoch 74 train/loss tensor(2.0378) train/accuracy tensor(0.7547) train/lr 0.09158858271604943 val/loss tensor(2.0921) val/accuracy tensor(0.7275)
epoch 75 train/loss tensor(2.0313) train/accuracy tensor(0.7562) train/lr 0.08049777777777775 val/loss tensor(2.0811) val/accuracy tensor(0.7296)
epoch 76 train/loss tensor(2.0268) train/accuracy tensor(0.7571) train/lr 0.0701225086419753 val/loss tensor(2.0749) val/accuracy tensor(0.7311)
epoch 77 train/loss tensor(2.0182) train/accuracy tensor(0.7595) train/lr 0.06046277530864202 val/loss tensor(2.0673) val/accuracy tensor(0.7341)
epoch 78 train/loss tensor(2.0122) train/accuracy tensor(0.7611) train/lr 0.05151857777777776 val/loss tensor(2.0578) val/accuracy tensor(0.7355)
epoch 79 train/loss tensor(2.0058) train/accuracy tensor(0.7627) train/lr 0.043289916049382725 val/loss tensor(2.0616) val/accuracy tensor(0.7354)
epoch 80 train/loss tensor(2.0024) train/accuracy tensor(0.7639) train/lr 0.035776790123456824 val/loss tensor(2.0538) val/accuracy tensor(0.7371)
epoch 81 train/loss tensor(1.9990) train/accuracy tensor(0.7646) train/lr 0.028979199999999986 val/loss tensor(2.0496) val/accuracy tensor(0.7379)
epoch 82 train/loss tensor(1.9943) train/accuracy tensor(0.7659) train/lr 0.022897145679012357 val/loss tensor(2.0484) val/accuracy tensor(0.7378)
epoch 83 train/loss tensor(1.9907) train/accuracy tensor(0.7673) train/lr 0.017530627160493802 val/loss tensor(2.0426) val/accuracy tensor(0.7389)
epoch 84 train/loss tensor(1.9890) train/accuracy tensor(0.7681) train/lr 0.01287964444444444 val/loss tensor(2.0430) val/accuracy tensor(0.7385)
epoch 85 train/loss tensor(1.9873) train/accuracy tensor(0.7683) train/lr 0.008944197530864206 val/loss tensor(2.0423) val/accuracy tensor(0.7395)
epoch 86 train/loss tensor(1.9853) train/accuracy tensor(0.7685) train/lr 0.005724286419753074 val/loss tensor(2.0421) val/accuracy tensor(0.7392)
epoch 87 train/loss tensor(1.9846) train/accuracy tensor(0.7689) train/lr 0.00321991111111111 val/loss tensor(2.0414) val/accuracy tensor(0.7396)
epoch 88 train/loss tensor(1.9839) train/accuracy tensor(0.7694) train/lr 0.0014310716049382758 val/loss tensor(2.0396) val/accuracy tensor(0.7381)
epoch 89 train/loss tensor(1.9826) train/accuracy tensor(0.7696) train/lr 0.00035776790123456543 val/loss tensor(2.0426) val/accuracy tensor(0.7393)
epoch 90 train/loss tensor(1.9839) train/accuracy tensor(0.7690) train/lr 0.0 val/loss tensor(2.0399) val/accuracy tensor(0.7389)

Training time: 0:34:40.571543
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.005 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.005 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5640) train/accuracy tensor(0.0123) train/lr 0.58864 val/loss tensor(7.1051) val/accuracy tensor(0.0049)
epoch 2 train/loss tensor(6.0642) train/accuracy tensor(0.0346) train/lr 1.16596 val/loss tensor(6.6478) val/accuracy tensor(0.0127)
epoch 3 train/loss tensor(5.7473) train/accuracy tensor(0.0597) train/lr 1.74328 val/loss tensor(5.9792) val/accuracy tensor(0.0487)
epoch 4 train/loss tensor(5.4165) train/accuracy tensor(0.0933) train/lr 2.3206 val/loss tensor(5.6552) val/accuracy tensor(0.0708)
epoch 5 train/loss tensor(5.0781) train/accuracy tensor(0.1371) train/lr 2.39497520661157 val/loss tensor(5.4138) val/accuracy tensor(0.1017)
epoch 6 train/loss tensor(4.7271) train/accuracy tensor(0.1873) train/lr 2.3001341884297517 val/loss tensor(5.0519) val/accuracy tensor(0.1357)
epoch 7 train/loss tensor(4.4155) train/accuracy tensor(0.2378) train/lr 2.2072091504132234 val/loss tensor(4.6438) val/accuracy tensor(0.1989)
epoch 8 train/loss tensor(4.1456) train/accuracy tensor(0.2857) train/lr 2.116200092561983 val/loss tensor(4.3427) val/accuracy tensor(0.2457)
epoch 9 train/loss tensor(3.9348) train/accuracy tensor(0.3248) train/lr 2.0271070148760333 val/loss tensor(4.6058) val/accuracy tensor(0.2094)
epoch 10 train/loss tensor(3.7586) train/accuracy tensor(0.3593) train/lr 1.9399299173553717 val/loss tensor(4.0054) val/accuracy tensor(0.3045)
epoch 11 train/loss tensor(3.6084) train/accuracy tensor(0.3901) train/lr 1.8546688000000005 val/loss tensor(3.7805) val/accuracy tensor(0.3412)
epoch 12 train/loss tensor(3.4852) train/accuracy tensor(0.4160) train/lr 1.7713236628099176 val/loss tensor(3.6236) val/accuracy tensor(0.3796)
epoch 13 train/loss tensor(3.3862) train/accuracy tensor(0.4359) train/lr 1.689894505785124 val/loss tensor(3.4980) val/accuracy tensor(0.4028)
epoch 14 train/loss tensor(3.2953) train/accuracy tensor(0.4556) train/lr 1.61038132892562 val/loss tensor(3.5266) val/accuracy tensor(0.3966)
epoch 15 train/loss tensor(3.2006) train/accuracy tensor(0.4764) train/lr 1.532784132231405 val/loss tensor(3.5468) val/accuracy tensor(0.4125)
epoch 16 train/loss tensor(3.1429) train/accuracy tensor(0.4894) train/lr 1.4571029157024795 val/loss tensor(3.2646) val/accuracy tensor(0.4475)
epoch 17 train/loss tensor(3.0769) train/accuracy tensor(0.5045) train/lr 1.383337679338843 val/loss tensor(3.2758) val/accuracy tensor(0.4580)
epoch 18 train/loss tensor(3.0178) train/accuracy tensor(0.5171) train/lr 1.311488423140496 val/loss tensor(3.2653) val/accuracy tensor(0.4543)
epoch 19 train/loss tensor(2.9668) train/accuracy tensor(0.5290) train/lr 1.2415551471074382 val/loss tensor(3.1675) val/accuracy tensor(0.4767)
epoch 20 train/loss tensor(2.9193) train/accuracy tensor(0.5399) train/lr 1.1735378512396695 val/loss tensor(3.0432) val/accuracy tensor(0.4987)
epoch 21 train/loss tensor(2.8717) train/accuracy tensor(0.5505) train/lr 1.10743653553719 val/loss tensor(2.9802) val/accuracy tensor(0.5140)
epoch 22 train/loss tensor(2.8338) train/accuracy tensor(0.5593) train/lr 1.0432512 val/loss tensor(2.9031) val/accuracy tensor(0.5269)
epoch 23 train/loss tensor(2.7908) train/accuracy tensor(0.5694) train/lr 0.9809818446280991 val/loss tensor(2.8518) val/accuracy tensor(0.5424)
epoch 24 train/loss tensor(2.7560) train/accuracy tensor(0.5770) train/lr 0.9206284694214879 val/loss tensor(2.7944) val/accuracy tensor(0.5579)
epoch 25 train/loss tensor(2.7210) train/accuracy tensor(0.5854) train/lr 0.8621910743801652 val/loss tensor(2.7489) val/accuracy tensor(0.5678)
epoch 26 train/loss tensor(2.6905) train/accuracy tensor(0.5929) train/lr 0.8056696595041324 val/loss tensor(2.7876) val/accuracy tensor(0.5621)
epoch 27 train/loss tensor(2.6600) train/accuracy tensor(0.6002) train/lr 0.7510642247933882 val/loss tensor(2.7005) val/accuracy tensor(0.5824)
epoch 28 train/loss tensor(2.6270) train/accuracy tensor(0.6078) train/lr 0.698374770247934 val/loss tensor(2.7601) val/accuracy tensor(0.5633)
epoch 29 train/loss tensor(2.6035) train/accuracy tensor(0.6142) train/lr 0.6476012958677687 val/loss tensor(2.6456) val/accuracy tensor(0.5980)
epoch 30 train/loss tensor(2.5694) train/accuracy tensor(0.6220) train/lr 0.5987438016528926 val/loss tensor(2.6334) val/accuracy tensor(0.5959)
epoch 31 train/loss tensor(2.5475) train/accuracy tensor(0.6270) train/lr 0.5518022876033059 val/loss tensor(2.5793) val/accuracy tensor(0.6149)
epoch 32 train/loss tensor(2.5247) train/accuracy tensor(0.6323) train/lr 0.5067767537190083 val/loss tensor(2.5059) val/accuracy tensor(0.6246)
epoch 33 train/loss tensor(2.4967) train/accuracy tensor(0.6392) train/lr 0.4636672000000001 val/loss tensor(2.5485) val/accuracy tensor(0.6227)
epoch 34 train/loss tensor(2.4772) train/accuracy tensor(0.6440) train/lr 0.422473626446281 val/loss tensor(2.4732) val/accuracy tensor(0.6384)
epoch 35 train/loss tensor(2.4563) train/accuracy tensor(0.6495) train/lr 0.38319603305785127 val/loss tensor(2.4401) val/accuracy tensor(0.6424)
epoch 36 train/loss tensor(2.4334) train/accuracy tensor(0.6555) train/lr 0.34583441983471075 val/loss tensor(2.4010) val/accuracy tensor(0.6507)
epoch 37 train/loss tensor(2.4142) train/accuracy tensor(0.6601) train/lr 0.31038878677685955 val/loss tensor(2.3809) val/accuracy tensor(0.6546)
epoch 38 train/loss tensor(2.3960) train/accuracy tensor(0.6647) train/lr 0.2768591338842975 val/loss tensor(2.3669) val/accuracy tensor(0.6601)
epoch 39 train/loss tensor(2.3781) train/accuracy tensor(0.6692) train/lr 0.24524546115702478 val/loss tensor(2.3199) val/accuracy tensor(0.6695)
epoch 40 train/loss tensor(2.3594) train/accuracy tensor(0.6731) train/lr 0.2155477685950413 val/loss tensor(2.3147) val/accuracy tensor(0.6742)
epoch 41 train/loss tensor(2.3451) train/accuracy tensor(0.6772) train/lr 0.18776605619834705 val/loss tensor(2.3181) val/accuracy tensor(0.6734)
epoch 42 train/loss tensor(2.3278) train/accuracy tensor(0.6817) train/lr 0.1619003239669421 val/loss tensor(2.2716) val/accuracy tensor(0.6851)
epoch 43 train/loss tensor(2.3160) train/accuracy tensor(0.6845) train/lr 0.1379505719008264 val/loss tensor(2.2518) val/accuracy tensor(0.6869)
epoch 44 train/loss tensor(2.3024) train/accuracy tensor(0.6884) train/lr 0.11591679999999994 val/loss tensor(2.2464) val/accuracy tensor(0.6916)
epoch 45 train/loss tensor(2.2901) train/accuracy tensor(0.6914) train/lr 0.09579900826446275 val/loss tensor(2.2330) val/accuracy tensor(0.6944)
epoch 46 train/loss tensor(2.2792) train/accuracy tensor(0.6937) train/lr 0.07759719669421493 val/loss tensor(2.2280) val/accuracy tensor(0.6962)
epoch 47 train/loss tensor(2.2712) train/accuracy tensor(0.6959) train/lr 0.061311365289256244 val/loss tensor(2.2055) val/accuracy tensor(0.6987)
epoch 48 train/loss tensor(2.2646) train/accuracy tensor(0.6983) train/lr 0.04694151404958682 val/loss tensor(2.1919) val/accuracy tensor(0.7035)
epoch 49 train/loss tensor(2.2550) train/accuracy tensor(0.7001) train/lr 0.03448764297520664 val/loss tensor(2.1873) val/accuracy tensor(0.7042)
epoch 50 train/loss tensor(2.2481) train/accuracy tensor(0.7025) train/lr 0.02394975206611572 val/loss tensor(2.1802) val/accuracy tensor(0.7060)
epoch 51 train/loss tensor(2.2434) train/accuracy tensor(0.7033) train/lr 0.015327841322314061 val/loss tensor(2.1782) val/accuracy tensor(0.7068)
epoch 52 train/loss tensor(2.2413) train/accuracy tensor(0.7040) train/lr 0.00862191074380166 val/loss tensor(2.1749) val/accuracy tensor(0.7073)
epoch 53 train/loss tensor(2.2370) train/accuracy tensor(0.7050) train/lr 0.0038319603305785152 val/loss tensor(2.1726) val/accuracy tensor(0.7079)
epoch 54 train/loss tensor(2.2374) train/accuracy tensor(0.7052) train/lr 0.0009579900826446288 val/loss tensor(2.1730) val/accuracy tensor(0.7068)
epoch 55 train/loss tensor(2.2366) train/accuracy tensor(0.7051) train/lr 0.0 val/loss tensor(2.1710) val/accuracy tensor(0.7081)

Training time: 0:21:16.631358
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.007 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.007 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5659) train/accuracy tensor(0.0115) train/lr 0.58864 val/loss tensor(7.1068) val/accuracy tensor(0.0053)
epoch 2 train/loss tensor(6.0977) train/accuracy tensor(0.0324) train/lr 1.16596 val/loss tensor(6.6364) val/accuracy tensor(0.0157)
epoch 3 train/loss tensor(5.7392) train/accuracy tensor(0.0609) train/lr 1.74328 val/loss tensor(6.2115) val/accuracy tensor(0.0351)
epoch 4 train/loss tensor(5.4645) train/accuracy tensor(0.0894) train/lr 2.3206 val/loss tensor(6.0260) val/accuracy tensor(0.0633)
epoch 5 train/loss tensor(5.1605) train/accuracy tensor(0.1259) train/lr 2.584873086419753 val/loss tensor(5.4630) val/accuracy tensor(0.0934)
epoch 6 train/loss tensor(4.8459) train/accuracy tensor(0.1704) train/lr 2.524410311111111 val/loss tensor(5.5035) val/accuracy tensor(0.1048)
epoch 7 train/loss tensor(4.5587) train/accuracy tensor(0.2150) train/lr 2.4646630716049387 val/loss tensor(5.4891) val/accuracy tensor(0.1292)
epoch 8 train/loss tensor(4.3179) train/accuracy tensor(0.2560) train/lr 2.4056313679012344 val/loss tensor(4.6179) val/accuracy tensor(0.2270)
epoch 9 train/loss tensor(4.1222) train/accuracy tensor(0.2906) train/lr 2.3473152 val/loss tensor(4.5499) val/accuracy tensor(0.2211)
epoch 10 train/loss tensor(3.9602) train/accuracy tensor(0.3212) train/lr 2.2897145679012345 val/loss tensor(4.3820) val/accuracy tensor(0.2509)
epoch 11 train/loss tensor(3.8211) train/accuracy tensor(0.3480) train/lr 2.2328294716049384 val/loss tensor(4.1323) val/accuracy tensor(0.2838)
epoch 12 train/loss tensor(3.6918) train/accuracy tensor(0.3737) train/lr 2.1766599111111113 val/loss tensor(4.2857) val/accuracy tensor(0.2905)
epoch 13 train/loss tensor(3.5904) train/accuracy tensor(0.3944) train/lr 2.1212058864197534 val/loss tensor(4.1379) val/accuracy tensor(0.3123)
epoch 14 train/loss tensor(3.5039) train/accuracy tensor(0.4127) train/lr 2.066467397530864 val/loss tensor(4.0327) val/accuracy tensor(0.2985)
epoch 15 train/loss tensor(3.4153) train/accuracy tensor(0.4308) train/lr 2.0124444444444447 val/loss tensor(3.7487) val/accuracy tensor(0.3576)
epoch 16 train/loss tensor(3.3480) train/accuracy tensor(0.4452) train/lr 1.9591370271604935 val/loss tensor(3.8370) val/accuracy tensor(0.3502)
epoch 17 train/loss tensor(3.2925) train/accuracy tensor(0.4578) train/lr 1.9065451456790126 val/loss tensor(3.6555) val/accuracy tensor(0.3689)
epoch 18 train/loss tensor(3.2290) train/accuracy tensor(0.4713) train/lr 1.8546688000000005 val/loss tensor(3.8254) val/accuracy tensor(0.3445)
epoch 19 train/loss tensor(3.1780) train/accuracy tensor(0.4817) train/lr 1.8035079901234565 val/loss tensor(3.5223) val/accuracy tensor(0.4131)
epoch 20 train/loss tensor(3.1257) train/accuracy tensor(0.4948) train/lr 1.7530627160493828 val/loss tensor(3.4494) val/accuracy tensor(0.4136)
epoch 21 train/loss tensor(3.0842) train/accuracy tensor(0.5030) train/lr 1.7033329777777777 val/loss tensor(3.3280) val/accuracy tensor(0.4370)
epoch 22 train/loss tensor(3.0417) train/accuracy tensor(0.5129) train/lr 1.654318775308642 val/loss tensor(3.4801) val/accuracy tensor(0.4048)
epoch 23 train/loss tensor(3.0020) train/accuracy tensor(0.5213) train/lr 1.6060201086419754 val/loss tensor(3.2348) val/accuracy tensor(0.4626)
epoch 24 train/loss tensor(2.9638) train/accuracy tensor(0.5299) train/lr 1.5584369777777782 val/loss tensor(3.4987) val/accuracy tensor(0.4166)
epoch 25 train/loss tensor(2.9323) train/accuracy tensor(0.5374) train/lr 1.5115693827160495 val/loss tensor(3.3542) val/accuracy tensor(0.4368)
epoch 26 train/loss tensor(2.8994) train/accuracy tensor(0.5446) train/lr 1.4654173234567902 val/loss tensor(3.4287) val/accuracy tensor(0.4248)
epoch 27 train/loss tensor(2.8668) train/accuracy tensor(0.5528) train/lr 1.4199807999999998 val/loss tensor(3.1160) val/accuracy tensor(0.4861)
epoch 28 train/loss tensor(2.8327) train/accuracy tensor(0.5601) train/lr 1.375259812345679 val/loss tensor(3.1197) val/accuracy tensor(0.4801)
epoch 29 train/loss tensor(2.8054) train/accuracy tensor(0.5664) train/lr 1.3312543604938272 val/loss tensor(3.1393) val/accuracy tensor(0.4795)
epoch 30 train/loss tensor(2.7736) train/accuracy tensor(0.5741) train/lr 1.2879644444444447 val/loss tensor(3.0946) val/accuracy tensor(0.4941)
epoch 31 train/loss tensor(2.7509) train/accuracy tensor(0.5793) train/lr 1.2453900641975308 val/loss tensor(3.0634) val/accuracy tensor(0.5023)
epoch 32 train/loss tensor(2.7293) train/accuracy tensor(0.5845) train/lr 1.203531219753086 val/loss tensor(2.9290) val/accuracy tensor(0.5223)
epoch 33 train/loss tensor(2.7009) train/accuracy tensor(0.5906) train/lr 1.162387911111111 val/loss tensor(2.9589) val/accuracy tensor(0.5232)
epoch 34 train/loss tensor(2.6786) train/accuracy tensor(0.5962) train/lr 1.121960138271605 val/loss tensor(2.8544) val/accuracy tensor(0.5465)
epoch 35 train/loss tensor(2.6564) train/accuracy tensor(0.6015) train/lr 1.082247901234568 val/loss tensor(2.8798) val/accuracy tensor(0.5373)
epoch 36 train/loss tensor(2.6299) train/accuracy tensor(0.6083) train/lr 1.0432512 val/loss tensor(2.9431) val/accuracy tensor(0.5292)
epoch 37 train/loss tensor(2.6101) train/accuracy tensor(0.6127) train/lr 1.0049700345679013 val/loss tensor(2.9102) val/accuracy tensor(0.5300)
epoch 38 train/loss tensor(2.5873) train/accuracy tensor(0.6177) train/lr 0.9674044049382714 val/loss tensor(2.8177) val/accuracy tensor(0.5570)
epoch 39 train/loss tensor(2.5689) train/accuracy tensor(0.6219) train/lr 0.930554311111111 val/loss tensor(2.7824) val/accuracy tensor(0.5618)
epoch 40 train/loss tensor(2.5454) train/accuracy tensor(0.6272) train/lr 0.8944197530864199 val/loss tensor(2.7769) val/accuracy tensor(0.5764)
epoch 41 train/loss tensor(2.5283) train/accuracy tensor(0.6317) train/lr 0.8590007308641977 val/loss tensor(2.7498) val/accuracy tensor(0.5676)
epoch 42 train/loss tensor(2.5043) train/accuracy tensor(0.6377) train/lr 0.8242972444444444 val/loss tensor(2.7513) val/accuracy tensor(0.5698)
epoch 43 train/loss tensor(2.4858) train/accuracy tensor(0.6418) train/lr 0.7903092938271603 val/loss tensor(2.6985) val/accuracy tensor(0.5740)
epoch 44 train/loss tensor(2.4664) train/accuracy tensor(0.6467) train/lr 0.7570368790123455 val/loss tensor(2.6338) val/accuracy tensor(0.5985)
epoch 45 train/loss tensor(2.4484) train/accuracy tensor(0.6515) train/lr 0.72448 val/loss tensor(2.5694) val/accuracy tensor(0.6085)
epoch 46 train/loss tensor(2.4296) train/accuracy tensor(0.6560) train/lr 0.6926386567901236 val/loss tensor(2.5109) val/accuracy tensor(0.6269)
epoch 47 train/loss tensor(2.4105) train/accuracy tensor(0.6600) train/lr 0.6615128493827159 val/loss tensor(2.5354) val/accuracy tensor(0.6288)
epoch 48 train/loss tensor(2.3980) train/accuracy tensor(0.6640) train/lr 0.6311025777777778 val/loss tensor(2.5198) val/accuracy tensor(0.6250)
epoch 49 train/loss tensor(2.3797) train/accuracy tensor(0.6678) train/lr 0.6014078419753088 val/loss tensor(2.5196) val/accuracy tensor(0.6319)
epoch 50 train/loss tensor(2.3634) train/accuracy tensor(0.6724) train/lr 0.5724286419753086 val/loss tensor(2.4532) val/accuracy tensor(0.6392)
epoch 51 train/loss tensor(2.3453) train/accuracy tensor(0.6764) train/lr 0.5441649777777778 val/loss tensor(2.4029) val/accuracy tensor(0.6529)
epoch 52 train/loss tensor(2.3288) train/accuracy tensor(0.6803) train/lr 0.5166168493827162 val/loss tensor(2.4747) val/accuracy tensor(0.6360)
epoch 53 train/loss tensor(2.3128) train/accuracy tensor(0.6841) train/lr 0.4897842567901234 val/loss tensor(2.3918) val/accuracy tensor(0.6514)
epoch 54 train/loss tensor(2.2950) train/accuracy tensor(0.6887) train/lr 0.4636672000000001 val/loss tensor(2.3763) val/accuracy tensor(0.6574)
epoch 55 train/loss tensor(2.2797) train/accuracy tensor(0.6931) train/lr 0.43826567901234553 val/loss tensor(2.3906) val/accuracy tensor(0.6550)
epoch 56 train/loss tensor(2.2628) train/accuracy tensor(0.6968) train/lr 0.4135796938271605 val/loss tensor(2.2787) val/accuracy tensor(0.6784)
epoch 57 train/loss tensor(2.2488) train/accuracy tensor(0.7000) train/lr 0.38960924444444456 val/loss tensor(2.3216) val/accuracy tensor(0.6746)
epoch 58 train/loss tensor(2.2345) train/accuracy tensor(0.7043) train/lr 0.36635433086419744 val/loss tensor(2.2829) val/accuracy tensor(0.6807)
epoch 59 train/loss tensor(2.2199) train/accuracy tensor(0.7074) train/lr 0.34381495308641974 val/loss tensor(2.2908) val/accuracy tensor(0.6800)
epoch 60 train/loss tensor(2.2059) train/accuracy tensor(0.7117) train/lr 0.3219911111111112 val/loss tensor(2.3001) val/accuracy tensor(0.6782)
epoch 61 train/loss tensor(2.1904) train/accuracy tensor(0.7152) train/lr 0.3008828049382715 val/loss tensor(2.2597) val/accuracy tensor(0.6868)
epoch 62 train/loss tensor(2.1765) train/accuracy tensor(0.7186) train/lr 0.2804900345679012 val/loss tensor(2.2138) val/accuracy tensor(0.6993)
epoch 63 train/loss tensor(2.1612) train/accuracy tensor(0.7226) train/lr 0.26081280000000007 val/loss tensor(2.2072) val/accuracy tensor(0.6988)
epoch 64 train/loss tensor(2.1495) train/accuracy tensor(0.7257) train/lr 0.24185110123456785 val/loss tensor(2.1813) val/accuracy tensor(0.7068)
epoch 65 train/loss tensor(2.1364) train/accuracy tensor(0.7291) train/lr 0.22360493827160496 val/loss tensor(2.1701) val/accuracy tensor(0.7080)
epoch 66 train/loss tensor(2.1243) train/accuracy tensor(0.7330) train/lr 0.20607431111111119 val/loss tensor(2.1718) val/accuracy tensor(0.7112)
epoch 67 train/loss tensor(2.1139) train/accuracy tensor(0.7352) train/lr 0.18925921975308638 val/loss tensor(2.1662) val/accuracy tensor(0.7086)
epoch 68 train/loss tensor(2.1008) train/accuracy tensor(0.7384) train/lr 0.1731596641975309 val/loss tensor(2.1363) val/accuracy tensor(0.7163)
epoch 69 train/loss tensor(2.0870) train/accuracy tensor(0.7422) train/lr 0.1577756444444444 val/loss tensor(2.1281) val/accuracy tensor(0.7169)
epoch 70 train/loss tensor(2.0783) train/accuracy tensor(0.7445) train/lr 0.14310716049382716 val/loss tensor(2.1221) val/accuracy tensor(0.7201)
epoch 71 train/loss tensor(2.0661) train/accuracy tensor(0.7479) train/lr 0.12915421234567906 val/loss tensor(2.1082) val/accuracy tensor(0.7230)
epoch 72 train/loss tensor(2.0578) train/accuracy tensor(0.7500) train/lr 0.11591679999999994 val/loss tensor(2.0926) val/accuracy tensor(0.7287)
epoch 73 train/loss tensor(2.0472) train/accuracy tensor(0.7527) train/lr 0.10339492345679012 val/loss tensor(2.0887) val/accuracy tensor(0.7270)
epoch 74 train/loss tensor(2.0381) train/accuracy tensor(0.7556) train/lr 0.09158858271604943 val/loss tensor(2.0831) val/accuracy tensor(0.7315)
epoch 75 train/loss tensor(2.0311) train/accuracy tensor(0.7575) train/lr 0.08049777777777775 val/loss tensor(2.0698) val/accuracy tensor(0.7313)
epoch 76 train/loss tensor(2.0219) train/accuracy tensor(0.7593) train/lr 0.0701225086419753 val/loss tensor(2.0719) val/accuracy tensor(0.7353)
epoch 77 train/loss tensor(2.0150) train/accuracy tensor(0.7615) train/lr 0.06046277530864202 val/loss tensor(2.0541) val/accuracy tensor(0.7367)
epoch 78 train/loss tensor(2.0069) train/accuracy tensor(0.7636) train/lr 0.05151857777777776 val/loss tensor(2.0496) val/accuracy tensor(0.7374)
epoch 79 train/loss tensor(2.0000) train/accuracy tensor(0.7656) train/lr 0.043289916049382725 val/loss tensor(2.0496) val/accuracy tensor(0.7375)
epoch 80 train/loss tensor(1.9953) train/accuracy tensor(0.7672) train/lr 0.035776790123456824 val/loss tensor(2.0507) val/accuracy tensor(0.7369)
epoch 81 train/loss tensor(1.9882) train/accuracy tensor(0.7691) train/lr 0.028979199999999986 val/loss tensor(2.0344) val/accuracy tensor(0.7414)
epoch 82 train/loss tensor(1.9814) train/accuracy tensor(0.7709) train/lr 0.022897145679012357 val/loss tensor(2.0373) val/accuracy tensor(0.7422)
epoch 83 train/loss tensor(1.9792) train/accuracy tensor(0.7715) train/lr 0.017530627160493802 val/loss tensor(2.0324) val/accuracy tensor(0.7402)
epoch 84 train/loss tensor(1.9761) train/accuracy tensor(0.7727) train/lr 0.01287964444444444 val/loss tensor(2.0302) val/accuracy tensor(0.7418)
epoch 85 train/loss tensor(1.9747) train/accuracy tensor(0.7729) train/lr 0.008944197530864206 val/loss tensor(2.0314) val/accuracy tensor(0.7420)
epoch 86 train/loss tensor(1.9692) train/accuracy tensor(0.7743) train/lr 0.005724286419753074 val/loss tensor(2.0299) val/accuracy tensor(0.7425)
epoch 87 train/loss tensor(1.9685) train/accuracy tensor(0.7744) train/lr 0.00321991111111111 val/loss tensor(2.0279) val/accuracy tensor(0.7424)
epoch 88 train/loss tensor(1.9683) train/accuracy tensor(0.7745) train/lr 0.0014310716049382758 val/loss tensor(2.0264) val/accuracy tensor(0.7425)
epoch 89 train/loss tensor(1.9667) train/accuracy tensor(0.7752) train/lr 0.00035776790123456543 val/loss tensor(2.0280) val/accuracy tensor(0.7416)
epoch 90 train/loss tensor(1.9665) train/accuracy tensor(0.7750) train/lr 0.0 val/loss tensor(2.0271) val/accuracy tensor(0.7424)

Training time: 0:36:06.113694
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.007 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.007 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5763) train/accuracy tensor(0.0108) train/lr 0.58864 val/loss tensor(6.9831) val/accuracy tensor(0.0056)
epoch 2 train/loss tensor(6.1030) train/accuracy tensor(0.0312) train/lr 1.16596 val/loss tensor(6.5154) val/accuracy tensor(0.0168)
epoch 3 train/loss tensor(5.7772) train/accuracy tensor(0.0564) train/lr 1.74328 val/loss tensor(6.0653) val/accuracy tensor(0.0382)
epoch 4 train/loss tensor(5.5173) train/accuracy tensor(0.0825) train/lr 2.3206 val/loss tensor(5.6226) val/accuracy tensor(0.0765)
epoch 5 train/loss tensor(5.1491) train/accuracy tensor(0.1270) train/lr 2.39497520661157 val/loss tensor(5.6113) val/accuracy tensor(0.0799)
epoch 6 train/loss tensor(4.8100) train/accuracy tensor(0.1751) train/lr 2.3001341884297517 val/loss tensor(5.4993) val/accuracy tensor(0.1170)
epoch 7 train/loss tensor(4.5174) train/accuracy tensor(0.2214) train/lr 2.2072091504132234 val/loss tensor(4.8570) val/accuracy tensor(0.1683)
epoch 8 train/loss tensor(4.2630) train/accuracy tensor(0.2653) train/lr 2.116200092561983 val/loss tensor(4.9644) val/accuracy tensor(0.1762)
epoch 9 train/loss tensor(4.0529) train/accuracy tensor(0.3035) train/lr 2.0271070148760333 val/loss tensor(4.6370) val/accuracy tensor(0.2111)
epoch 10 train/loss tensor(3.8691) train/accuracy tensor(0.3392) train/lr 1.9399299173553717 val/loss tensor(4.1873) val/accuracy tensor(0.2803)
epoch 11 train/loss tensor(3.7238) train/accuracy tensor(0.3682) train/lr 1.8546688000000005 val/loss tensor(3.8493) val/accuracy tensor(0.3354)
epoch 12 train/loss tensor(3.5928) train/accuracy tensor(0.3945) train/lr 1.7713236628099176 val/loss tensor(3.6658) val/accuracy tensor(0.3751)
epoch 13 train/loss tensor(3.4764) train/accuracy tensor(0.4188) train/lr 1.689894505785124 val/loss tensor(3.8827) val/accuracy tensor(0.3462)
epoch 14 train/loss tensor(3.3799) train/accuracy tensor(0.4388) train/lr 1.61038132892562 val/loss tensor(3.7807) val/accuracy tensor(0.3545)
epoch 15 train/loss tensor(3.3007) train/accuracy tensor(0.4560) train/lr 1.532784132231405 val/loss tensor(3.5842) val/accuracy tensor(0.3858)
epoch 16 train/loss tensor(3.2220) train/accuracy tensor(0.4736) train/lr 1.4571029157024795 val/loss tensor(3.5183) val/accuracy tensor(0.4035)
epoch 17 train/loss tensor(3.1582) train/accuracy tensor(0.4875) train/lr 1.383337679338843 val/loss tensor(3.6963) val/accuracy tensor(0.3877)
epoch 18 train/loss tensor(3.0932) train/accuracy tensor(0.5019) train/lr 1.311488423140496 val/loss tensor(3.3423) val/accuracy tensor(0.4401)
epoch 19 train/loss tensor(3.0352) train/accuracy tensor(0.5150) train/lr 1.2415551471074382 val/loss tensor(3.5186) val/accuracy tensor(0.4160)
epoch 20 train/loss tensor(2.9848) train/accuracy tensor(0.5256) train/lr 1.1735378512396695 val/loss tensor(3.1158) val/accuracy tensor(0.4837)
epoch 21 train/loss tensor(2.9334) train/accuracy tensor(0.5380) train/lr 1.10743653553719 val/loss tensor(3.1347) val/accuracy tensor(0.4944)
epoch 22 train/loss tensor(2.8901) train/accuracy tensor(0.5479) train/lr 1.0432512 val/loss tensor(3.1194) val/accuracy tensor(0.4854)
epoch 23 train/loss tensor(2.8448) train/accuracy tensor(0.5587) train/lr 0.9809818446280991 val/loss tensor(2.9653) val/accuracy tensor(0.5171)
epoch 24 train/loss tensor(2.8043) train/accuracy tensor(0.5677) train/lr 0.9206284694214879 val/loss tensor(2.9193) val/accuracy tensor(0.5383)
epoch 25 train/loss tensor(2.7651) train/accuracy tensor(0.5773) train/lr 0.8621910743801652 val/loss tensor(2.9139) val/accuracy tensor(0.5337)
epoch 26 train/loss tensor(2.7312) train/accuracy tensor(0.5844) train/lr 0.8056696595041324 val/loss tensor(2.8089) val/accuracy tensor(0.5601)
epoch 27 train/loss tensor(2.6963) train/accuracy tensor(0.5927) train/lr 0.7510642247933882 val/loss tensor(2.8173) val/accuracy tensor(0.5581)
epoch 28 train/loss tensor(2.6628) train/accuracy tensor(0.6011) train/lr 0.698374770247934 val/loss tensor(2.7669) val/accuracy tensor(0.5684)
epoch 29 train/loss tensor(2.6336) train/accuracy tensor(0.6078) train/lr 0.6476012958677687 val/loss tensor(2.6734) val/accuracy tensor(0.5871)
epoch 30 train/loss tensor(2.6013) train/accuracy tensor(0.6158) train/lr 0.5987438016528926 val/loss tensor(2.7043) val/accuracy tensor(0.5830)
epoch 31 train/loss tensor(2.5719) train/accuracy tensor(0.6230) train/lr 0.5518022876033059 val/loss tensor(2.6001) val/accuracy tensor(0.6084)
epoch 32 train/loss tensor(2.5428) train/accuracy tensor(0.6297) train/lr 0.5067767537190083 val/loss tensor(2.5360) val/accuracy tensor(0.6213)
epoch 33 train/loss tensor(2.5165) train/accuracy tensor(0.6362) train/lr 0.4636672000000001 val/loss tensor(2.5661) val/accuracy tensor(0.6229)
epoch 34 train/loss tensor(2.4872) train/accuracy tensor(0.6431) train/lr 0.422473626446281 val/loss tensor(2.5240) val/accuracy tensor(0.6277)
epoch 35 train/loss tensor(2.4645) train/accuracy tensor(0.6486) train/lr 0.38319603305785127 val/loss tensor(2.4918) val/accuracy tensor(0.6304)
epoch 36 train/loss tensor(2.4406) train/accuracy tensor(0.6545) train/lr 0.34583441983471075 val/loss tensor(2.4261) val/accuracy tensor(0.6472)
epoch 37 train/loss tensor(2.4171) train/accuracy tensor(0.6607) train/lr 0.31038878677685955 val/loss tensor(2.4019) val/accuracy tensor(0.6516)
epoch 38 train/loss tensor(2.3957) train/accuracy tensor(0.6656) train/lr 0.2768591338842975 val/loss tensor(2.3898) val/accuracy tensor(0.6557)
epoch 39 train/loss tensor(2.3745) train/accuracy tensor(0.6713) train/lr 0.24524546115702478 val/loss tensor(2.3769) val/accuracy tensor(0.6659)
epoch 40 train/loss tensor(2.3560) train/accuracy tensor(0.6758) train/lr 0.2155477685950413 val/loss tensor(2.3318) val/accuracy tensor(0.6706)
epoch 41 train/loss tensor(2.3369) train/accuracy tensor(0.6804) train/lr 0.18776605619834705 val/loss tensor(2.3078) val/accuracy tensor(0.6797)
epoch 42 train/loss tensor(2.3152) train/accuracy tensor(0.6859) train/lr 0.1619003239669421 val/loss tensor(2.2699) val/accuracy tensor(0.6842)
epoch 43 train/loss tensor(2.3021) train/accuracy tensor(0.6892) train/lr 0.1379505719008264 val/loss tensor(2.2560) val/accuracy tensor(0.6870)
epoch 44 train/loss tensor(2.2841) train/accuracy tensor(0.6939) train/lr 0.11591679999999994 val/loss tensor(2.2315) val/accuracy tensor(0.6968)
epoch 45 train/loss tensor(2.2695) train/accuracy tensor(0.6975) train/lr 0.09579900826446275 val/loss tensor(2.2053) val/accuracy tensor(0.7001)
epoch 46 train/loss tensor(2.2579) train/accuracy tensor(0.7005) train/lr 0.07759719669421493 val/loss tensor(2.2095) val/accuracy tensor(0.7010)
epoch 47 train/loss tensor(2.2453) train/accuracy tensor(0.7040) train/lr 0.061311365289256244 val/loss tensor(2.1802) val/accuracy tensor(0.7079)
epoch 48 train/loss tensor(2.2345) train/accuracy tensor(0.7066) train/lr 0.04694151404958682 val/loss tensor(2.1699) val/accuracy tensor(0.7104)
epoch 49 train/loss tensor(2.2242) train/accuracy tensor(0.7091) train/lr 0.03448764297520664 val/loss tensor(2.1648) val/accuracy tensor(0.7111)
epoch 50 train/loss tensor(2.2165) train/accuracy tensor(0.7113) train/lr 0.02394975206611572 val/loss tensor(2.1586) val/accuracy tensor(0.7116)
epoch 51 train/loss tensor(2.2114) train/accuracy tensor(0.7130) train/lr 0.015327841322314061 val/loss tensor(2.1545) val/accuracy tensor(0.7137)
epoch 52 train/loss tensor(2.2070) train/accuracy tensor(0.7144) train/lr 0.00862191074380166 val/loss tensor(2.1478) val/accuracy tensor(0.7148)
epoch 53 train/loss tensor(2.2050) train/accuracy tensor(0.7147) train/lr 0.0038319603305785152 val/loss tensor(2.1463) val/accuracy tensor(0.7138)
epoch 54 train/loss tensor(2.2023) train/accuracy tensor(0.7149) train/lr 0.0009579900826446288 val/loss tensor(2.1462) val/accuracy tensor(0.7149)
epoch 55 train/loss tensor(2.2002) train/accuracy tensor(0.7157) train/lr 0.0 val/loss tensor(2.1449) val/accuracy tensor(0.7153)

Training time: 0:21:05.228637
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5886) train/accuracy tensor(0.0102) train/lr 0.58864 val/loss tensor(6.9597) val/accuracy tensor(0.0045)
epoch 2 train/loss tensor(6.1398) train/accuracy tensor(0.0287) train/lr 1.16596 val/loss tensor(6.1635) val/accuracy tensor(0.0284)
epoch 3 train/loss tensor(5.8198) train/accuracy tensor(0.0523) train/lr 1.74328 val/loss tensor(6.1649) val/accuracy tensor(0.0360)
epoch 4 train/loss tensor(5.5950) train/accuracy tensor(0.0752) train/lr 2.3206 val/loss tensor(6.6696) val/accuracy tensor(0.0419)
epoch 5 train/loss tensor(5.3423) train/accuracy tensor(0.1036) train/lr 2.584873086419753 val/loss tensor(5.6548) val/accuracy tensor(0.0895)
epoch 6 train/loss tensor(5.0691) train/accuracy tensor(0.1388) train/lr 2.524410311111111 val/loss tensor(5.5819) val/accuracy tensor(0.1009)
epoch 7 train/loss tensor(4.8275) train/accuracy tensor(0.1725) train/lr 2.4646630716049387 val/loss tensor(5.1199) val/accuracy tensor(0.1475)
epoch 8 train/loss tensor(4.6463) train/accuracy tensor(0.2015) train/lr 2.4056313679012344 val/loss tensor(5.5136) val/accuracy tensor(0.1314)
epoch 9 train/loss tensor(4.4813) train/accuracy tensor(0.2290) train/lr 2.3473152 val/loss tensor(5.7383) val/accuracy tensor(0.1155)
epoch 10 train/loss tensor(4.3341) train/accuracy tensor(0.2534) train/lr 2.2897145679012345 val/loss tensor(5.4499) val/accuracy tensor(0.1306)
epoch 11 train/loss tensor(4.1928) train/accuracy tensor(0.2792) train/lr 2.2328294716049384 val/loss tensor(4.4333) val/accuracy tensor(0.2265)
epoch 12 train/loss tensor(4.0710) train/accuracy tensor(0.3022) train/lr 2.1766599111111113 val/loss tensor(4.7732) val/accuracy tensor(0.1921)
epoch 13 train/loss tensor(3.9522) train/accuracy tensor(0.3242) train/lr 2.1212058864197534 val/loss tensor(4.4767) val/accuracy tensor(0.2443)
epoch 14 train/loss tensor(3.8582) train/accuracy tensor(0.3421) train/lr 2.066467397530864 val/loss tensor(4.3553) val/accuracy tensor(0.2535)
epoch 15 train/loss tensor(3.7718) train/accuracy tensor(0.3590) train/lr 2.0124444444444447 val/loss tensor(4.2681) val/accuracy tensor(0.2683)
epoch 16 train/loss tensor(3.6690) train/accuracy tensor(0.3793) train/lr 1.9591370271604935 val/loss tensor(4.4082) val/accuracy tensor(0.2373)
epoch 17 train/loss tensor(3.6061) train/accuracy tensor(0.3917) train/lr 1.9065451456790126 val/loss tensor(3.9929) val/accuracy tensor(0.3195)
epoch 18 train/loss tensor(3.5380) train/accuracy tensor(0.4062) train/lr 1.8546688000000005 val/loss tensor(4.3287) val/accuracy tensor(0.2711)
epoch 19 train/loss tensor(3.4799) train/accuracy tensor(0.4176) train/lr 1.8035079901234565 val/loss tensor(3.8822) val/accuracy tensor(0.3401)
epoch 20 train/loss tensor(3.4089) train/accuracy tensor(0.4327) train/lr 1.7530627160493828 val/loss tensor(3.9618) val/accuracy tensor(0.3137)
epoch 21 train/loss tensor(3.3614) train/accuracy tensor(0.4429) train/lr 1.7033329777777777 val/loss tensor(3.9012) val/accuracy tensor(0.3359)
epoch 22 train/loss tensor(3.3114) train/accuracy tensor(0.4535) train/lr 1.654318775308642 val/loss tensor(3.7184) val/accuracy tensor(0.3557)
epoch 23 train/loss tensor(3.2647) train/accuracy tensor(0.4638) train/lr 1.6060201086419754 val/loss tensor(3.7185) val/accuracy tensor(0.3672)
epoch 24 train/loss tensor(3.2161) train/accuracy tensor(0.4745) train/lr 1.5584369777777782 val/loss tensor(3.8051) val/accuracy tensor(0.3539)
epoch 25 train/loss tensor(3.1750) train/accuracy tensor(0.4833) train/lr 1.5115693827160495 val/loss tensor(3.7478) val/accuracy tensor(0.3650)
epoch 26 train/loss tensor(3.1312) train/accuracy tensor(0.4925) train/lr 1.4654173234567902 val/loss tensor(3.4475) val/accuracy tensor(0.4064)
epoch 27 train/loss tensor(3.0943) train/accuracy tensor(0.5014) train/lr 1.4199807999999998 val/loss tensor(3.5554) val/accuracy tensor(0.3998)
epoch 28 train/loss tensor(3.0574) train/accuracy tensor(0.5093) train/lr 1.375259812345679 val/loss tensor(3.3144) val/accuracy tensor(0.4414)
epoch 29 train/loss tensor(3.0174) train/accuracy tensor(0.5186) train/lr 1.3312543604938272 val/loss tensor(3.5072) val/accuracy tensor(0.4128)
epoch 30 train/loss tensor(2.9817) train/accuracy tensor(0.5268) train/lr 1.2879644444444447 val/loss tensor(3.5201) val/accuracy tensor(0.3932)
epoch 31 train/loss tensor(2.9524) train/accuracy tensor(0.5337) train/lr 1.2453900641975308 val/loss tensor(3.3269) val/accuracy tensor(0.4460)
epoch 32 train/loss tensor(2.9236) train/accuracy tensor(0.5397) train/lr 1.203531219753086 val/loss tensor(3.2081) val/accuracy tensor(0.4612)
epoch 33 train/loss tensor(2.8860) train/accuracy tensor(0.5489) train/lr 1.162387911111111 val/loss tensor(3.0635) val/accuracy tensor(0.4912)
epoch 34 train/loss tensor(2.8554) train/accuracy tensor(0.5560) train/lr 1.121960138271605 val/loss tensor(3.1925) val/accuracy tensor(0.4647)
epoch 35 train/loss tensor(2.8281) train/accuracy tensor(0.5615) train/lr 1.082247901234568 val/loss tensor(3.0890) val/accuracy tensor(0.4942)
epoch 36 train/loss tensor(2.8014) train/accuracy tensor(0.5683) train/lr 1.0432512 val/loss tensor(3.2051) val/accuracy tensor(0.4665)
epoch 37 train/loss tensor(2.7745) train/accuracy tensor(0.5749) train/lr 1.0049700345679013 val/loss tensor(3.0862) val/accuracy tensor(0.4899)
epoch 38 train/loss tensor(2.7452) train/accuracy tensor(0.5812) train/lr 0.9674044049382714 val/loss tensor(3.1055) val/accuracy tensor(0.4911)
epoch 39 train/loss tensor(2.7201) train/accuracy tensor(0.5872) train/lr 0.930554311111111 val/loss tensor(3.0865) val/accuracy tensor(0.4939)
epoch 40 train/loss tensor(2.6965) train/accuracy tensor(0.5928) train/lr 0.8944197530864199 val/loss tensor(3.0220) val/accuracy tensor(0.5143)
epoch 41 train/loss tensor(2.6730) train/accuracy tensor(0.5980) train/lr 0.8590007308641977 val/loss tensor(2.9034) val/accuracy tensor(0.5374)
epoch 42 train/loss tensor(2.6473) train/accuracy tensor(0.6037) train/lr 0.8242972444444444 val/loss tensor(2.8509) val/accuracy tensor(0.5402)
epoch 43 train/loss tensor(2.6249) train/accuracy tensor(0.6092) train/lr 0.7903092938271603 val/loss tensor(2.8254) val/accuracy tensor(0.5480)
epoch 44 train/loss tensor(2.6030) train/accuracy tensor(0.6149) train/lr 0.7570368790123455 val/loss tensor(2.7899) val/accuracy tensor(0.5598)
epoch 45 train/loss tensor(2.5797) train/accuracy tensor(0.6201) train/lr 0.72448 val/loss tensor(2.7902) val/accuracy tensor(0.5645)
epoch 46 train/loss tensor(2.5561) train/accuracy tensor(0.6261) train/lr 0.6926386567901236 val/loss tensor(2.7410) val/accuracy tensor(0.5679)
epoch 47 train/loss tensor(2.5335) train/accuracy tensor(0.6316) train/lr 0.6615128493827159 val/loss tensor(2.7986) val/accuracy tensor(0.5643)
epoch 48 train/loss tensor(2.5175) train/accuracy tensor(0.6353) train/lr 0.6311025777777778 val/loss tensor(2.7626) val/accuracy tensor(0.5661)
epoch 49 train/loss tensor(2.4936) train/accuracy tensor(0.6402) train/lr 0.6014078419753088 val/loss tensor(2.6368) val/accuracy tensor(0.5975)
epoch 50 train/loss tensor(2.4734) train/accuracy tensor(0.6456) train/lr 0.5724286419753086 val/loss tensor(2.6323) val/accuracy tensor(0.5982)
epoch 51 train/loss tensor(2.4529) train/accuracy tensor(0.6510) train/lr 0.5441649777777778 val/loss tensor(2.6052) val/accuracy tensor(0.6046)
epoch 52 train/loss tensor(2.4311) train/accuracy tensor(0.6556) train/lr 0.5166168493827162 val/loss tensor(2.5633) val/accuracy tensor(0.6201)
epoch 53 train/loss tensor(2.4116) train/accuracy tensor(0.6609) train/lr 0.4897842567901234 val/loss tensor(2.5240) val/accuracy tensor(0.6217)
epoch 54 train/loss tensor(2.3936) train/accuracy tensor(0.6648) train/lr 0.4636672000000001 val/loss tensor(2.5368) val/accuracy tensor(0.6203)
epoch 55 train/loss tensor(2.3744) train/accuracy tensor(0.6700) train/lr 0.43826567901234553 val/loss tensor(2.5016) val/accuracy tensor(0.6292)
epoch 56 train/loss tensor(2.3548) train/accuracy tensor(0.6749) train/lr 0.4135796938271605 val/loss tensor(2.4396) val/accuracy tensor(0.6456)
epoch 57 train/loss tensor(2.3376) train/accuracy tensor(0.6789) train/lr 0.38960924444444456 val/loss tensor(2.4353) val/accuracy tensor(0.6461)
epoch 58 train/loss tensor(2.3169) train/accuracy tensor(0.6843) train/lr 0.36635433086419744 val/loss tensor(2.3512) val/accuracy tensor(0.6680)
epoch 59 train/loss tensor(2.3007) train/accuracy tensor(0.6884) train/lr 0.34381495308641974 val/loss tensor(2.3367) val/accuracy tensor(0.6710)
epoch 60 train/loss tensor(2.2828) train/accuracy tensor(0.6926) train/lr 0.3219911111111112 val/loss tensor(2.3603) val/accuracy tensor(0.6666)
epoch 61 train/loss tensor(2.2636) train/accuracy tensor(0.6977) train/lr 0.3008828049382715 val/loss tensor(2.3355) val/accuracy tensor(0.6670)
epoch 62 train/loss tensor(2.2483) train/accuracy tensor(0.7007) train/lr 0.2804900345679012 val/loss tensor(2.3178) val/accuracy tensor(0.6721)
epoch 63 train/loss tensor(2.2324) train/accuracy tensor(0.7050) train/lr 0.26081280000000007 val/loss tensor(2.2852) val/accuracy tensor(0.6823)
epoch 64 train/loss tensor(2.2159) train/accuracy tensor(0.7096) train/lr 0.24185110123456785 val/loss tensor(2.2755) val/accuracy tensor(0.6841)
epoch 65 train/loss tensor(2.1992) train/accuracy tensor(0.7136) train/lr 0.22360493827160496 val/loss tensor(2.2492) val/accuracy tensor(0.6907)
epoch 66 train/loss tensor(2.1847) train/accuracy tensor(0.7175) train/lr 0.20607431111111119 val/loss tensor(2.2431) val/accuracy tensor(0.6945)
epoch 67 train/loss tensor(2.1676) train/accuracy tensor(0.7214) train/lr 0.18925921975308638 val/loss tensor(2.2281) val/accuracy tensor(0.6919)
epoch 68 train/loss tensor(2.1536) train/accuracy tensor(0.7257) train/lr 0.1731596641975309 val/loss tensor(2.1820) val/accuracy tensor(0.7094)
epoch 69 train/loss tensor(2.1383) train/accuracy tensor(0.7293) train/lr 0.1577756444444444 val/loss tensor(2.1859) val/accuracy tensor(0.7025)
epoch 70 train/loss tensor(2.1233) train/accuracy tensor(0.7329) train/lr 0.14310716049382716 val/loss tensor(2.1438) val/accuracy tensor(0.7145)
epoch 71 train/loss tensor(2.1107) train/accuracy tensor(0.7365) train/lr 0.12915421234567906 val/loss tensor(2.1553) val/accuracy tensor(0.7123)
epoch 72 train/loss tensor(2.0963) train/accuracy tensor(0.7402) train/lr 0.11591679999999994 val/loss tensor(2.1250) val/accuracy tensor(0.7207)
epoch 73 train/loss tensor(2.0849) train/accuracy tensor(0.7432) train/lr 0.10339492345679012 val/loss tensor(2.1115) val/accuracy tensor(0.7212)
epoch 74 train/loss tensor(2.0733) train/accuracy tensor(0.7462) train/lr 0.09158858271604943 val/loss tensor(2.0919) val/accuracy tensor(0.7283)
epoch 75 train/loss tensor(2.0642) train/accuracy tensor(0.7492) train/lr 0.08049777777777775 val/loss tensor(2.0920) val/accuracy tensor(0.7311)
epoch 76 train/loss tensor(2.0509) train/accuracy tensor(0.7529) train/lr 0.0701225086419753 val/loss tensor(2.0751) val/accuracy tensor(0.7344)
epoch 77 train/loss tensor(2.0410) train/accuracy tensor(0.7552) train/lr 0.06046277530864202 val/loss tensor(2.0651) val/accuracy tensor(0.7333)
epoch 78 train/loss tensor(2.0328) train/accuracy tensor(0.7576) train/lr 0.05151857777777776 val/loss tensor(2.0597) val/accuracy tensor(0.7374)
epoch 79 train/loss tensor(2.0230) train/accuracy tensor(0.7596) train/lr 0.043289916049382725 val/loss tensor(2.0470) val/accuracy tensor(0.7407)
epoch 80 train/loss tensor(2.0158) train/accuracy tensor(0.7622) train/lr 0.035776790123456824 val/loss tensor(2.0434) val/accuracy tensor(0.7412)
epoch 81 train/loss tensor(2.0084) train/accuracy tensor(0.7638) train/lr 0.028979199999999986 val/loss tensor(2.0346) val/accuracy tensor(0.7429)
epoch 82 train/loss tensor(2.0007) train/accuracy tensor(0.7662) train/lr 0.022897145679012357 val/loss tensor(2.0352) val/accuracy tensor(0.7464)
epoch 83 train/loss tensor(1.9948) train/accuracy tensor(0.7676) train/lr 0.017530627160493802 val/loss tensor(2.0283) val/accuracy tensor(0.7458)
epoch 84 train/loss tensor(1.9907) train/accuracy tensor(0.7688) train/lr 0.01287964444444444 val/loss tensor(2.0246) val/accuracy tensor(0.7461)
epoch 85 train/loss tensor(1.9872) train/accuracy tensor(0.7700) train/lr 0.008944197530864206 val/loss tensor(2.0214) val/accuracy tensor(0.7493)
epoch 86 train/loss tensor(1.9828) train/accuracy tensor(0.7711) train/lr 0.005724286419753074 val/loss tensor(2.0179) val/accuracy tensor(0.7487)
epoch 87 train/loss tensor(1.9823) train/accuracy tensor(0.7715) train/lr 0.00321991111111111 val/loss tensor(2.0167) val/accuracy tensor(0.7482)
epoch 88 train/loss tensor(1.9788) train/accuracy tensor(0.7722) train/lr 0.0014310716049382758 val/loss tensor(2.0145) val/accuracy tensor(0.7484)
epoch 89 train/loss tensor(1.9786) train/accuracy tensor(0.7719) train/lr 0.00035776790123456543 val/loss tensor(2.0175) val/accuracy tensor(0.7488)
epoch 90 train/loss tensor(1.9785) train/accuracy tensor(0.7725) train/lr 0.0 val/loss tensor(2.0158) val/accuracy tensor(0.7485)

Training time: 0:34:37.515096
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6311) train/accuracy tensor(0.0085) train/lr 0.58864 val/loss tensor(6.8861) val/accuracy tensor(0.0040)
epoch 2 train/loss tensor(6.1883) train/accuracy tensor(0.0262) train/lr 1.16596 val/loss tensor(6.2909) val/accuracy tensor(0.0224)
epoch 3 train/loss tensor(5.8679) train/accuracy tensor(0.0489) train/lr 1.74328 val/loss tensor(6.1460) val/accuracy tensor(0.0377)
epoch 4 train/loss tensor(5.5919) train/accuracy tensor(0.0752) train/lr 2.3206 val/loss tensor(5.8844) val/accuracy tensor(0.0600)
epoch 5 train/loss tensor(5.3103) train/accuracy tensor(0.1075) train/lr 2.39497520661157 val/loss tensor(5.4812) val/accuracy tensor(0.0959)
epoch 6 train/loss tensor(5.0325) train/accuracy tensor(0.1443) train/lr 2.3001341884297517 val/loss tensor(5.4656) val/accuracy tensor(0.1158)
epoch 7 train/loss tensor(4.7815) train/accuracy tensor(0.1805) train/lr 2.2072091504132234 val/loss tensor(5.3082) val/accuracy tensor(0.1307)
epoch 8 train/loss tensor(4.5646) train/accuracy tensor(0.2157) train/lr 2.116200092561983 val/loss tensor(5.1676) val/accuracy tensor(0.1673)
epoch 9 train/loss tensor(4.3717) train/accuracy tensor(0.2480) train/lr 2.0271070148760333 val/loss tensor(5.0517) val/accuracy tensor(0.1683)
epoch 10 train/loss tensor(4.1940) train/accuracy tensor(0.2793) train/lr 1.9399299173553717 val/loss tensor(4.7852) val/accuracy tensor(0.1966)
epoch 11 train/loss tensor(4.0310) train/accuracy tensor(0.3092) train/lr 1.8546688000000005 val/loss tensor(4.4632) val/accuracy tensor(0.2442)
epoch 12 train/loss tensor(3.8899) train/accuracy tensor(0.3359) train/lr 1.7713236628099176 val/loss tensor(4.3080) val/accuracy tensor(0.2733)
epoch 13 train/loss tensor(3.7734) train/accuracy tensor(0.3593) train/lr 1.689894505785124 val/loss tensor(4.3697) val/accuracy tensor(0.2761)
epoch 14 train/loss tensor(3.6614) train/accuracy tensor(0.3814) train/lr 1.61038132892562 val/loss tensor(4.4637) val/accuracy tensor(0.2405)
epoch 15 train/loss tensor(3.5451) train/accuracy tensor(0.4046) train/lr 1.532784132231405 val/loss tensor(3.9386) val/accuracy tensor(0.3264)
epoch 16 train/loss tensor(3.4645) train/accuracy tensor(0.4224) train/lr 1.4571029157024795 val/loss tensor(3.8271) val/accuracy tensor(0.3555)
epoch 17 train/loss tensor(3.3780) train/accuracy tensor(0.4403) train/lr 1.383337679338843 val/loss tensor(3.8486) val/accuracy tensor(0.3703)
epoch 18 train/loss tensor(3.2977) train/accuracy tensor(0.4584) train/lr 1.311488423140496 val/loss tensor(3.6643) val/accuracy tensor(0.3895)
epoch 19 train/loss tensor(3.2247) train/accuracy tensor(0.4739) train/lr 1.2415551471074382 val/loss tensor(3.5198) val/accuracy tensor(0.4001)
epoch 20 train/loss tensor(3.1643) train/accuracy tensor(0.4875) train/lr 1.1735378512396695 val/loss tensor(3.6111) val/accuracy tensor(0.4064)
epoch 21 train/loss tensor(3.1062) train/accuracy tensor(0.4996) train/lr 1.10743653553719 val/loss tensor(3.6471) val/accuracy tensor(0.3899)
epoch 22 train/loss tensor(3.0513) train/accuracy tensor(0.5122) train/lr 1.0432512 val/loss tensor(3.2226) val/accuracy tensor(0.4630)
epoch 23 train/loss tensor(2.9939) train/accuracy tensor(0.5247) train/lr 0.9809818446280991 val/loss tensor(3.1962) val/accuracy tensor(0.4701)
epoch 24 train/loss tensor(2.9493) train/accuracy tensor(0.5354) train/lr 0.9206284694214879 val/loss tensor(3.1168) val/accuracy tensor(0.4910)
epoch 25 train/loss tensor(2.9016) train/accuracy tensor(0.5463) train/lr 0.8621910743801652 val/loss tensor(3.1929) val/accuracy tensor(0.4693)
epoch 26 train/loss tensor(2.8545) train/accuracy tensor(0.5572) train/lr 0.8056696595041324 val/loss tensor(3.2149) val/accuracy tensor(0.4767)
epoch 27 train/loss tensor(2.8154) train/accuracy tensor(0.5664) train/lr 0.7510642247933882 val/loss tensor(2.9862) val/accuracy tensor(0.5259)
epoch 28 train/loss tensor(2.7748) train/accuracy tensor(0.5755) train/lr 0.698374770247934 val/loss tensor(2.9194) val/accuracy tensor(0.5336)
epoch 29 train/loss tensor(2.7388) train/accuracy tensor(0.5841) train/lr 0.6476012958677687 val/loss tensor(2.9429) val/accuracy tensor(0.5339)
epoch 30 train/loss tensor(2.6982) train/accuracy tensor(0.5940) train/lr 0.5987438016528926 val/loss tensor(2.8458) val/accuracy tensor(0.5447)
epoch 31 train/loss tensor(2.6656) train/accuracy tensor(0.6013) train/lr 0.5518022876033059 val/loss tensor(2.7795) val/accuracy tensor(0.5656)
epoch 32 train/loss tensor(2.6326) train/accuracy tensor(0.6095) train/lr 0.5067767537190083 val/loss tensor(2.7212) val/accuracy tensor(0.5793)
epoch 33 train/loss tensor(2.6009) train/accuracy tensor(0.6172) train/lr 0.4636672000000001 val/loss tensor(2.6977) val/accuracy tensor(0.5900)
epoch 34 train/loss tensor(2.5700) train/accuracy tensor(0.6244) train/lr 0.422473626446281 val/loss tensor(2.6315) val/accuracy tensor(0.5973)
epoch 35 train/loss tensor(2.5374) train/accuracy tensor(0.6320) train/lr 0.38319603305785127 val/loss tensor(2.6170) val/accuracy tensor(0.6067)
epoch 36 train/loss tensor(2.5043) train/accuracy tensor(0.6404) train/lr 0.34583441983471075 val/loss tensor(2.5684) val/accuracy tensor(0.6098)
epoch 37 train/loss tensor(2.4778) train/accuracy tensor(0.6473) train/lr 0.31038878677685955 val/loss tensor(2.4829) val/accuracy tensor(0.6369)
epoch 38 train/loss tensor(2.4487) train/accuracy tensor(0.6539) train/lr 0.2768591338842975 val/loss tensor(2.4534) val/accuracy tensor(0.6409)
epoch 39 train/loss tensor(2.4250) train/accuracy tensor(0.6596) train/lr 0.24524546115702478 val/loss tensor(2.4353) val/accuracy tensor(0.6495)
epoch 40 train/loss tensor(2.3988) train/accuracy tensor(0.6660) train/lr 0.2155477685950413 val/loss tensor(2.3754) val/accuracy tensor(0.6608)
epoch 41 train/loss tensor(2.3758) train/accuracy tensor(0.6717) train/lr 0.18776605619834705 val/loss tensor(2.3302) val/accuracy tensor(0.6754)
epoch 42 train/loss tensor(2.3528) train/accuracy tensor(0.6776) train/lr 0.1619003239669421 val/loss tensor(2.2935) val/accuracy tensor(0.6794)
epoch 43 train/loss tensor(2.3328) train/accuracy tensor(0.6828) train/lr 0.1379505719008264 val/loss tensor(2.2819) val/accuracy tensor(0.6837)
epoch 44 train/loss tensor(2.3108) train/accuracy tensor(0.6886) train/lr 0.11591679999999994 val/loss tensor(2.2634) val/accuracy tensor(0.6910)
epoch 45 train/loss tensor(2.2926) train/accuracy tensor(0.6925) train/lr 0.09579900826446275 val/loss tensor(2.2212) val/accuracy tensor(0.7008)
epoch 46 train/loss tensor(2.2742) train/accuracy tensor(0.6973) train/lr 0.07759719669421493 val/loss tensor(2.2180) val/accuracy tensor(0.7010)
epoch 47 train/loss tensor(2.2607) train/accuracy tensor(0.7014) train/lr 0.061311365289256244 val/loss tensor(2.1882) val/accuracy tensor(0.7070)
epoch 48 train/loss tensor(2.2485) train/accuracy tensor(0.7041) train/lr 0.04694151404958682 val/loss tensor(2.1860) val/accuracy tensor(0.7073)
epoch 49 train/loss tensor(2.2352) train/accuracy tensor(0.7075) train/lr 0.03448764297520664 val/loss tensor(2.1663) val/accuracy tensor(0.7128)
epoch 50 train/loss tensor(2.2253) train/accuracy tensor(0.7103) train/lr 0.02394975206611572 val/loss tensor(2.1617) val/accuracy tensor(0.7144)
epoch 51 train/loss tensor(2.2164) train/accuracy tensor(0.7126) train/lr 0.015327841322314061 val/loss tensor(2.1465) val/accuracy tensor(0.7180)
epoch 52 train/loss tensor(2.2089) train/accuracy tensor(0.7146) train/lr 0.00862191074380166 val/loss tensor(2.1438) val/accuracy tensor(0.7173)
epoch 53 train/loss tensor(2.2050) train/accuracy tensor(0.7157) train/lr 0.0038319603305785152 val/loss tensor(2.1378) val/accuracy tensor(0.7192)
epoch 54 train/loss tensor(2.2023) train/accuracy tensor(0.7162) train/lr 0.0009579900826446288 val/loss tensor(2.1376) val/accuracy tensor(0.7194)
epoch 55 train/loss tensor(2.2014) train/accuracy tensor(0.7165) train/lr 0.0 val/loss tensor(2.1382) val/accuracy tensor(0.7196)

Training time: 0:20:50.486610
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.015 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.015 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6896) train/accuracy tensor(0.0073) train/lr 0.58864 val/loss tensor(6.7326) val/accuracy tensor(0.0054)
epoch 2 train/loss tensor(6.2357) train/accuracy tensor(0.0238) train/lr 1.16596 val/loss tensor(6.5510) val/accuracy tensor(0.0175)
epoch 3 train/loss tensor(5.9552) train/accuracy tensor(0.0426) train/lr 1.74328 val/loss tensor(6.5431) val/accuracy tensor(0.0276)
epoch 4 train/loss tensor(5.7458) train/accuracy tensor(0.0601) train/lr 2.3206 val/loss tensor(7.0439) val/accuracy tensor(0.0252)
epoch 5 train/loss tensor(5.6121) train/accuracy tensor(0.0753) train/lr 2.584873086419753 val/loss tensor(7.1326) val/accuracy tensor(0.0237)
epoch 6 train/loss tensor(5.4554) train/accuracy tensor(0.0916) train/lr 2.524410311111111 val/loss tensor(6.5466) val/accuracy tensor(0.0366)
epoch 7 train/loss tensor(5.3264) train/accuracy tensor(0.1076) train/lr 2.4646630716049387 val/loss tensor(6.3351) val/accuracy tensor(0.0643)
epoch 8 train/loss tensor(5.1946) train/accuracy tensor(0.1250) train/lr 2.4056313679012344 val/loss tensor(6.3857) val/accuracy tensor(0.0585)
epoch 9 train/loss tensor(5.0888) train/accuracy tensor(0.1395) train/lr 2.3473152 val/loss tensor(5.7423) val/accuracy tensor(0.0834)
epoch 10 train/loss tensor(5.0073) train/accuracy tensor(0.1508) train/lr 2.2897145679012345 val/loss tensor(5.4396) val/accuracy tensor(0.1039)
epoch 11 train/loss tensor(4.9135) train/accuracy tensor(0.1640) train/lr 2.2328294716049384 val/loss tensor(5.3127) val/accuracy tensor(0.1166)
epoch 12 train/loss tensor(4.8232) train/accuracy tensor(0.1785) train/lr 2.1766599111111113 val/loss tensor(5.8923) val/accuracy tensor(0.0919)
epoch 13 train/loss tensor(4.7517) train/accuracy tensor(0.1897) train/lr 2.1212058864197534 val/loss tensor(6.1700) val/accuracy tensor(0.0866)
epoch 14 train/loss tensor(4.6619) train/accuracy tensor(0.2037) train/lr 2.066467397530864 val/loss tensor(5.3105) val/accuracy tensor(0.1213)
epoch 15 train/loss tensor(4.5632) train/accuracy tensor(0.2178) train/lr 2.0124444444444447 val/loss tensor(5.0862) val/accuracy tensor(0.1346)
epoch 16 train/loss tensor(4.5003) train/accuracy tensor(0.2297) train/lr 1.9591370271604935 val/loss tensor(5.8860) val/accuracy tensor(0.1011)
epoch 17 train/loss tensor(4.3848) train/accuracy tensor(0.2467) train/lr 1.9065451456790126 val/loss tensor(5.3347) val/accuracy tensor(0.1446)
epoch 18 train/loss tensor(4.3039) train/accuracy tensor(0.2621) train/lr 1.8546688000000005 val/loss tensor(4.8048) val/accuracy tensor(0.1933)
epoch 19 train/loss tensor(4.2256) train/accuracy tensor(0.2751) train/lr 1.8035079901234565 val/loss tensor(4.8850) val/accuracy tensor(0.1900)
epoch 20 train/loss tensor(4.1539) train/accuracy tensor(0.2877) train/lr 1.7530627160493828 val/loss tensor(4.5265) val/accuracy tensor(0.2156)
epoch 21 train/loss tensor(4.0406) train/accuracy tensor(0.3085) train/lr 1.7033329777777777 val/loss tensor(5.2315) val/accuracy tensor(0.1702)
epoch 22 train/loss tensor(3.9990) train/accuracy tensor(0.3169) train/lr 1.654318775308642 val/loss tensor(5.0898) val/accuracy tensor(0.1815)
epoch 23 train/loss tensor(3.9170) train/accuracy tensor(0.3317) train/lr 1.6060201086419754 val/loss tensor(4.4046) val/accuracy tensor(0.2430)
epoch 24 train/loss tensor(3.8494) train/accuracy tensor(0.3452) train/lr 1.5584369777777782 val/loss tensor(4.5271) val/accuracy tensor(0.2269)
epoch 25 train/loss tensor(3.7880) train/accuracy tensor(0.3573) train/lr 1.5115693827160495 val/loss tensor(4.4428) val/accuracy tensor(0.2410)
epoch 26 train/loss tensor(3.7191) train/accuracy tensor(0.3698) train/lr 1.4654173234567902 val/loss tensor(4.8934) val/accuracy tensor(0.1881)
epoch 27 train/loss tensor(3.6669) train/accuracy tensor(0.3801) train/lr 1.4199807999999998 val/loss tensor(4.2678) val/accuracy tensor(0.2683)
epoch 28 train/loss tensor(3.6104) train/accuracy tensor(0.3916) train/lr 1.375259812345679 val/loss tensor(4.2577) val/accuracy tensor(0.2747)
epoch 29 train/loss tensor(3.5426) train/accuracy tensor(0.4060) train/lr 1.3312543604938272 val/loss tensor(3.9519) val/accuracy tensor(0.3172)
epoch 30 train/loss tensor(3.4892) train/accuracy tensor(0.4173) train/lr 1.2879644444444447 val/loss tensor(4.1175) val/accuracy tensor(0.3073)
epoch 31 train/loss tensor(3.4408) train/accuracy tensor(0.4270) train/lr 1.2453900641975308 val/loss tensor(4.0799) val/accuracy tensor(0.3026)
epoch 32 train/loss tensor(3.3921) train/accuracy tensor(0.4362) train/lr 1.203531219753086 val/loss tensor(3.9098) val/accuracy tensor(0.3224)
epoch 33 train/loss tensor(3.3347) train/accuracy tensor(0.4499) train/lr 1.162387911111111 val/loss tensor(4.1218) val/accuracy tensor(0.3032)
epoch 34 train/loss tensor(3.2962) train/accuracy tensor(0.4577) train/lr 1.121960138271605 val/loss tensor(3.5824) val/accuracy tensor(0.3891)
epoch 35 train/loss tensor(3.2503) train/accuracy tensor(0.4671) train/lr 1.082247901234568 val/loss tensor(3.7349) val/accuracy tensor(0.3586)
epoch 36 train/loss tensor(3.2073) train/accuracy tensor(0.4770) train/lr 1.0432512 val/loss tensor(3.5969) val/accuracy tensor(0.3840)
epoch 37 train/loss tensor(3.1620) train/accuracy tensor(0.4866) train/lr 1.0049700345679013 val/loss tensor(3.6483) val/accuracy tensor(0.3705)
epoch 38 train/loss tensor(3.1194) train/accuracy tensor(0.4967) train/lr 0.9674044049382714 val/loss tensor(3.6237) val/accuracy tensor(0.3831)
epoch 39 train/loss tensor(3.0830) train/accuracy tensor(0.5047) train/lr 0.930554311111111 val/loss tensor(3.4454) val/accuracy tensor(0.4148)
epoch 40 train/loss tensor(3.0453) train/accuracy tensor(0.5132) train/lr 0.8944197530864199 val/loss tensor(3.3672) val/accuracy tensor(0.4425)
epoch 41 train/loss tensor(3.0113) train/accuracy tensor(0.5204) train/lr 0.8590007308641977 val/loss tensor(3.5295) val/accuracy tensor(0.4219)
epoch 42 train/loss tensor(2.9720) train/accuracy tensor(0.5294) train/lr 0.8242972444444444 val/loss tensor(3.3027) val/accuracy tensor(0.4485)
epoch 43 train/loss tensor(2.9384) train/accuracy tensor(0.5365) train/lr 0.7903092938271603 val/loss tensor(3.4566) val/accuracy tensor(0.4216)
epoch 44 train/loss tensor(2.9107) train/accuracy tensor(0.5432) train/lr 0.7570368790123455 val/loss tensor(3.1555) val/accuracy tensor(0.4897)
epoch 45 train/loss tensor(2.8750) train/accuracy tensor(0.5512) train/lr 0.72448 val/loss tensor(3.2374) val/accuracy tensor(0.4679)
epoch 46 train/loss tensor(2.8417) train/accuracy tensor(0.5593) train/lr 0.6926386567901236 val/loss tensor(3.1412) val/accuracy tensor(0.4821)
epoch 47 train/loss tensor(2.8155) train/accuracy tensor(0.5656) train/lr 0.6615128493827159 val/loss tensor(3.1320) val/accuracy tensor(0.4787)
epoch 48 train/loss tensor(2.7814) train/accuracy tensor(0.5736) train/lr 0.6311025777777778 val/loss tensor(3.2514) val/accuracy tensor(0.4581)
epoch 49 train/loss tensor(2.7530) train/accuracy tensor(0.5801) train/lr 0.6014078419753088 val/loss tensor(3.0146) val/accuracy tensor(0.5144)
epoch 50 train/loss tensor(2.7293) train/accuracy tensor(0.5860) train/lr 0.5724286419753086 val/loss tensor(3.0436) val/accuracy tensor(0.4977)
epoch 51 train/loss tensor(2.6984) train/accuracy tensor(0.5933) train/lr 0.5441649777777778 val/loss tensor(3.0574) val/accuracy tensor(0.5108)
epoch 52 train/loss tensor(2.6728) train/accuracy tensor(0.5989) train/lr 0.5166168493827162 val/loss tensor(2.8492) val/accuracy tensor(0.5457)
epoch 53 train/loss tensor(2.6423) train/accuracy tensor(0.6059) train/lr 0.4897842567901234 val/loss tensor(2.9169) val/accuracy tensor(0.5297)
epoch 54 train/loss tensor(2.6170) train/accuracy tensor(0.6120) train/lr 0.4636672000000001 val/loss tensor(2.8054) val/accuracy tensor(0.5548)
epoch 55 train/loss tensor(2.5968) train/accuracy tensor(0.6170) train/lr 0.43826567901234553 val/loss tensor(2.7733) val/accuracy tensor(0.5614)
epoch 56 train/loss tensor(2.5688) train/accuracy tensor(0.6232) train/lr 0.4135796938271605 val/loss tensor(2.7552) val/accuracy tensor(0.5672)
epoch 57 train/loss tensor(2.5455) train/accuracy tensor(0.6289) train/lr 0.38960924444444456 val/loss tensor(2.7049) val/accuracy tensor(0.5809)
epoch 58 train/loss tensor(2.5218) train/accuracy tensor(0.6354) train/lr 0.36635433086419744 val/loss tensor(2.6405) val/accuracy tensor(0.6069)
epoch 59 train/loss tensor(2.4965) train/accuracy tensor(0.6413) train/lr 0.34381495308641974 val/loss tensor(2.5766) val/accuracy tensor(0.6148)
epoch 60 train/loss tensor(2.4752) train/accuracy tensor(0.6460) train/lr 0.3219911111111112 val/loss tensor(2.6162) val/accuracy tensor(0.5991)
epoch 61 train/loss tensor(2.4517) train/accuracy tensor(0.6521) train/lr 0.3008828049382715 val/loss tensor(2.5290) val/accuracy tensor(0.6204)
epoch 62 train/loss tensor(2.4305) train/accuracy tensor(0.6572) train/lr 0.2804900345679012 val/loss tensor(2.5087) val/accuracy tensor(0.6294)
epoch 63 train/loss tensor(2.4065) train/accuracy tensor(0.6636) train/lr 0.26081280000000007 val/loss tensor(2.4951) val/accuracy tensor(0.6345)
epoch 64 train/loss tensor(2.3836) train/accuracy tensor(0.6684) train/lr 0.24185110123456785 val/loss tensor(2.4159) val/accuracy tensor(0.6511)
epoch 65 train/loss tensor(2.3651) train/accuracy tensor(0.6734) train/lr 0.22360493827160496 val/loss tensor(2.4794) val/accuracy tensor(0.6404)
epoch 66 train/loss tensor(2.3493) train/accuracy tensor(0.6774) train/lr 0.20607431111111119 val/loss tensor(2.3895) val/accuracy tensor(0.6591)
epoch 67 train/loss tensor(2.3257) train/accuracy tensor(0.6828) train/lr 0.18925921975308638 val/loss tensor(2.3401) val/accuracy tensor(0.6686)
epoch 68 train/loss tensor(2.3073) train/accuracy tensor(0.6873) train/lr 0.1731596641975309 val/loss tensor(2.3465) val/accuracy tensor(0.6687)
epoch 69 train/loss tensor(2.2863) train/accuracy tensor(0.6933) train/lr 0.1577756444444444 val/loss tensor(2.2885) val/accuracy tensor(0.6787)
epoch 70 train/loss tensor(2.2670) train/accuracy tensor(0.6980) train/lr 0.14310716049382716 val/loss tensor(2.2686) val/accuracy tensor(0.6832)
epoch 71 train/loss tensor(2.2502) train/accuracy tensor(0.7022) train/lr 0.12915421234567906 val/loss tensor(2.2497) val/accuracy tensor(0.6901)
epoch 72 train/loss tensor(2.2336) train/accuracy tensor(0.7065) train/lr 0.11591679999999994 val/loss tensor(2.2515) val/accuracy tensor(0.6938)
epoch 73 train/loss tensor(2.2169) train/accuracy tensor(0.7109) train/lr 0.10339492345679012 val/loss tensor(2.2199) val/accuracy tensor(0.6969)
epoch 74 train/loss tensor(2.1998) train/accuracy tensor(0.7148) train/lr 0.09158858271604943 val/loss tensor(2.1892) val/accuracy tensor(0.7043)
epoch 75 train/loss tensor(2.1855) train/accuracy tensor(0.7189) train/lr 0.08049777777777775 val/loss tensor(2.1829) val/accuracy tensor(0.7065)
epoch 76 train/loss tensor(2.1699) train/accuracy tensor(0.7231) train/lr 0.0701225086419753 val/loss tensor(2.1773) val/accuracy tensor(0.7084)
epoch 77 train/loss tensor(2.1573) train/accuracy tensor(0.7260) train/lr 0.06046277530864202 val/loss tensor(2.1521) val/accuracy tensor(0.7151)
epoch 78 train/loss tensor(2.1432) train/accuracy tensor(0.7295) train/lr 0.05151857777777776 val/loss tensor(2.1393) val/accuracy tensor(0.7185)
epoch 79 train/loss tensor(2.1310) train/accuracy tensor(0.7331) train/lr 0.043289916049382725 val/loss tensor(2.1188) val/accuracy tensor(0.7210)
epoch 80 train/loss tensor(2.1205) train/accuracy tensor(0.7360) train/lr 0.035776790123456824 val/loss tensor(2.1174) val/accuracy tensor(0.7226)
epoch 81 train/loss tensor(2.1098) train/accuracy tensor(0.7390) train/lr 0.028979199999999986 val/loss tensor(2.0896) val/accuracy tensor(0.7290)
epoch 82 train/loss tensor(2.1003) train/accuracy tensor(0.7414) train/lr 0.022897145679012357 val/loss tensor(2.0963) val/accuracy tensor(0.7279)
epoch 83 train/loss tensor(2.0925) train/accuracy tensor(0.7435) train/lr 0.017530627160493802 val/loss tensor(2.0877) val/accuracy tensor(0.7302)
epoch 84 train/loss tensor(2.0850) train/accuracy tensor(0.7457) train/lr 0.01287964444444444 val/loss tensor(2.0759) val/accuracy tensor(0.7325)
epoch 85 train/loss tensor(2.0789) train/accuracy tensor(0.7466) train/lr 0.008944197530864206 val/loss tensor(2.0750) val/accuracy tensor(0.7338)
epoch 86 train/loss tensor(2.0741) train/accuracy tensor(0.7483) train/lr 0.005724286419753074 val/loss tensor(2.0738) val/accuracy tensor(0.7353)
epoch 87 train/loss tensor(2.0717) train/accuracy tensor(0.7494) train/lr 0.00321991111111111 val/loss tensor(2.0703) val/accuracy tensor(0.7330)
epoch 88 train/loss tensor(2.0696) train/accuracy tensor(0.7495) train/lr 0.0014310716049382758 val/loss tensor(2.0666) val/accuracy tensor(0.7351)
epoch 89 train/loss tensor(2.0675) train/accuracy tensor(0.7503) train/lr 0.00035776790123456543 val/loss tensor(2.0703) val/accuracy tensor(0.7352)
epoch 90 train/loss tensor(2.0671) train/accuracy tensor(0.7504) train/lr 0.0 val/loss tensor(2.0677) val/accuracy tensor(0.7348)

Training time: 0:34:19.539593
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.015 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.015 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6937) train/accuracy tensor(0.0068) train/lr 0.58864 val/loss tensor(6.6634) val/accuracy tensor(0.0044)
epoch 2 train/loss tensor(6.2814) train/accuracy tensor(0.0214) train/lr 1.16596 val/loss tensor(6.3501) val/accuracy tensor(0.0186)
epoch 3 train/loss tensor(5.9685) train/accuracy tensor(0.0413) train/lr 1.74328 val/loss tensor(6.3255) val/accuracy tensor(0.0317)
epoch 4 train/loss tensor(5.7766) train/accuracy tensor(0.0584) train/lr 2.3206 val/loss tensor(7.0817) val/accuracy tensor(0.0324)
epoch 5 train/loss tensor(5.6223) train/accuracy tensor(0.0744) train/lr 2.39497520661157 val/loss tensor(6.4133) val/accuracy tensor(0.0519)
epoch 6 train/loss tensor(5.3732) train/accuracy tensor(0.1011) train/lr 2.3001341884297517 val/loss tensor(6.3144) val/accuracy tensor(0.0517)
epoch 7 train/loss tensor(5.1971) train/accuracy tensor(0.1234) train/lr 2.2072091504132234 val/loss tensor(5.4589) val/accuracy tensor(0.0948)
epoch 8 train/loss tensor(5.0457) train/accuracy tensor(0.1449) train/lr 2.116200092561983 val/loss tensor(6.0961) val/accuracy tensor(0.0871)
epoch 9 train/loss tensor(4.9004) train/accuracy tensor(0.1654) train/lr 2.0271070148760333 val/loss tensor(5.4109) val/accuracy tensor(0.1200)
epoch 10 train/loss tensor(4.7727) train/accuracy tensor(0.1846) train/lr 1.9399299173553717 val/loss tensor(5.6278) val/accuracy tensor(0.1007)
epoch 11 train/loss tensor(4.6468) train/accuracy tensor(0.2038) train/lr 1.8546688000000005 val/loss tensor(5.3200) val/accuracy tensor(0.1259)
epoch 12 train/loss tensor(4.5174) train/accuracy tensor(0.2257) train/lr 1.7713236628099176 val/loss tensor(5.4086) val/accuracy tensor(0.1366)
epoch 13 train/loss tensor(4.3794) train/accuracy tensor(0.2483) train/lr 1.689894505785124 val/loss tensor(5.5576) val/accuracy tensor(0.1291)
epoch 14 train/loss tensor(4.2585) train/accuracy tensor(0.2695) train/lr 1.61038132892562 val/loss tensor(4.7725) val/accuracy tensor(0.1880)
epoch 15 train/loss tensor(4.1276) train/accuracy tensor(0.2928) train/lr 1.532784132231405 val/loss tensor(4.6896) val/accuracy tensor(0.2161)
epoch 16 train/loss tensor(4.0162) train/accuracy tensor(0.3140) train/lr 1.4571029157024795 val/loss tensor(4.6977) val/accuracy tensor(0.2088)
epoch 17 train/loss tensor(3.8938) train/accuracy tensor(0.3356) train/lr 1.383337679338843 val/loss tensor(4.3700) val/accuracy tensor(0.2446)
epoch 18 train/loss tensor(3.7814) train/accuracy tensor(0.3578) train/lr 1.311488423140496 val/loss tensor(4.6459) val/accuracy tensor(0.2196)
epoch 19 train/loss tensor(3.6937) train/accuracy tensor(0.3749) train/lr 1.2415551471074382 val/loss tensor(4.4659) val/accuracy tensor(0.2538)
epoch 20 train/loss tensor(3.5961) train/accuracy tensor(0.3953) train/lr 1.1735378512396695 val/loss tensor(3.8512) val/accuracy tensor(0.3378)
epoch 21 train/loss tensor(3.5133) train/accuracy tensor(0.4128) train/lr 1.10743653553719 val/loss tensor(3.9541) val/accuracy tensor(0.3314)
epoch 22 train/loss tensor(3.4363) train/accuracy tensor(0.4285) train/lr 1.0432512 val/loss tensor(4.0214) val/accuracy tensor(0.3082)
epoch 23 train/loss tensor(3.3584) train/accuracy tensor(0.4453) train/lr 0.9809818446280991 val/loss tensor(3.6232) val/accuracy tensor(0.3777)
epoch 24 train/loss tensor(3.2872) train/accuracy tensor(0.4612) train/lr 0.9206284694214879 val/loss tensor(3.9593) val/accuracy tensor(0.3251)
epoch 25 train/loss tensor(3.2235) train/accuracy tensor(0.4744) train/lr 0.8621910743801652 val/loss tensor(3.4566) val/accuracy tensor(0.4147)
epoch 26 train/loss tensor(3.1569) train/accuracy tensor(0.4893) train/lr 0.8056696595041324 val/loss tensor(3.5458) val/accuracy tensor(0.3988)
epoch 27 train/loss tensor(3.1031) train/accuracy tensor(0.5013) train/lr 0.7510642247933882 val/loss tensor(3.4628) val/accuracy tensor(0.4252)
epoch 28 train/loss tensor(3.0447) train/accuracy tensor(0.5148) train/lr 0.698374770247934 val/loss tensor(3.3700) val/accuracy tensor(0.4365)
epoch 29 train/loss tensor(2.9911) train/accuracy tensor(0.5262) train/lr 0.6476012958677687 val/loss tensor(3.3118) val/accuracy tensor(0.4535)
epoch 30 train/loss tensor(2.9347) train/accuracy tensor(0.5395) train/lr 0.5987438016528926 val/loss tensor(3.1487) val/accuracy tensor(0.4809)
epoch 31 train/loss tensor(2.8922) train/accuracy tensor(0.5496) train/lr 0.5518022876033059 val/loss tensor(3.1027) val/accuracy tensor(0.5043)
epoch 32 train/loss tensor(2.8480) train/accuracy tensor(0.5596) train/lr 0.5067767537190083 val/loss tensor(2.9852) val/accuracy tensor(0.5180)
epoch 33 train/loss tensor(2.8012) train/accuracy tensor(0.5710) train/lr 0.4636672000000001 val/loss tensor(2.8444) val/accuracy tensor(0.5528)
epoch 34 train/loss tensor(2.7550) train/accuracy tensor(0.5816) train/lr 0.422473626446281 val/loss tensor(2.8986) val/accuracy tensor(0.5368)
epoch 35 train/loss tensor(2.7197) train/accuracy tensor(0.5895) train/lr 0.38319603305785127 val/loss tensor(2.8217) val/accuracy tensor(0.5523)
epoch 36 train/loss tensor(2.6792) train/accuracy tensor(0.5994) train/lr 0.34583441983471075 val/loss tensor(2.8192) val/accuracy tensor(0.5613)
epoch 37 train/loss tensor(2.6433) train/accuracy tensor(0.6080) train/lr 0.31038878677685955 val/loss tensor(2.7240) val/accuracy tensor(0.5781)
epoch 38 train/loss tensor(2.6069) train/accuracy tensor(0.6162) train/lr 0.2768591338842975 val/loss tensor(2.6124) val/accuracy tensor(0.6094)
epoch 39 train/loss tensor(2.5716) train/accuracy tensor(0.6248) train/lr 0.24524546115702478 val/loss tensor(2.5958) val/accuracy tensor(0.6121)
epoch 40 train/loss tensor(2.5391) train/accuracy tensor(0.6336) train/lr 0.2155477685950413 val/loss tensor(2.5367) val/accuracy tensor(0.6313)
epoch 41 train/loss tensor(2.5072) train/accuracy tensor(0.6408) train/lr 0.18776605619834705 val/loss tensor(2.4827) val/accuracy tensor(0.6323)
epoch 42 train/loss tensor(2.4776) train/accuracy tensor(0.6482) train/lr 0.1619003239669421 val/loss tensor(2.4668) val/accuracy tensor(0.6426)
epoch 43 train/loss tensor(2.4491) train/accuracy tensor(0.6552) train/lr 0.1379505719008264 val/loss tensor(2.3829) val/accuracy tensor(0.6595)
epoch 44 train/loss tensor(2.4210) train/accuracy tensor(0.6623) train/lr 0.11591679999999994 val/loss tensor(2.3607) val/accuracy tensor(0.6645)
epoch 45 train/loss tensor(2.3981) train/accuracy tensor(0.6681) train/lr 0.09579900826446275 val/loss tensor(2.3590) val/accuracy tensor(0.6693)
epoch 46 train/loss tensor(2.3740) train/accuracy tensor(0.6742) train/lr 0.07759719669421493 val/loss tensor(2.2935) val/accuracy tensor(0.6808)
epoch 47 train/loss tensor(2.3522) train/accuracy tensor(0.6796) train/lr 0.061311365289256244 val/loss tensor(2.2852) val/accuracy tensor(0.6846)
epoch 48 train/loss tensor(2.3343) train/accuracy tensor(0.6846) train/lr 0.04694151404958682 val/loss tensor(2.2425) val/accuracy tensor(0.6945)
epoch 49 train/loss tensor(2.3186) train/accuracy tensor(0.6883) train/lr 0.03448764297520664 val/loss tensor(2.2169) val/accuracy tensor(0.7015)
epoch 50 train/loss tensor(2.3032) train/accuracy tensor(0.6925) train/lr 0.02394975206611572 val/loss tensor(2.2060) val/accuracy tensor(0.7045)
epoch 51 train/loss tensor(2.2898) train/accuracy tensor(0.6956) train/lr 0.015327841322314061 val/loss tensor(2.1990) val/accuracy tensor(0.7066)
epoch 52 train/loss tensor(2.2828) train/accuracy tensor(0.6981) train/lr 0.00862191074380166 val/loss tensor(2.1872) val/accuracy tensor(0.7090)
epoch 53 train/loss tensor(2.2746) train/accuracy tensor(0.6998) train/lr 0.0038319603305785152 val/loss tensor(2.1833) val/accuracy tensor(0.7103)
epoch 54 train/loss tensor(2.2715) train/accuracy tensor(0.7003) train/lr 0.0009579900826446288 val/loss tensor(2.1821) val/accuracy tensor(0.7103)
epoch 55 train/loss tensor(2.2686) train/accuracy tensor(0.7016) train/lr 0.0 val/loss tensor(2.1808) val/accuracy tensor(0.7111)

Training time: 0:20:42.698443
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.02 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.02 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6655) train/accuracy tensor(0.0072) train/lr 0.58864 val/loss tensor(6.9808) val/accuracy tensor(0.0021)
epoch 2 train/loss tensor(6.2308) train/accuracy tensor(0.0230) train/lr 1.16596 val/loss tensor(6.6296) val/accuracy tensor(0.0174)
epoch 3 train/loss tensor(5.9952) train/accuracy tensor(0.0398) train/lr 1.74328 val/loss tensor(6.8435) val/accuracy tensor(0.0164)
epoch 4 train/loss tensor(5.8873) train/accuracy tensor(0.0487) train/lr 2.3206 val/loss tensor(8.3223) val/accuracy tensor(0.0231)
epoch 5 train/loss tensor(5.8290) train/accuracy tensor(0.0541) train/lr 2.584873086419753 val/loss tensor(7.1461) val/accuracy tensor(0.0210)
epoch 6 train/loss tensor(5.8128) train/accuracy tensor(0.0564) train/lr 2.524410311111111 val/loss tensor(6.8799) val/accuracy tensor(0.0266)
epoch 7 train/loss tensor(5.7240) train/accuracy tensor(0.0645) train/lr 2.4646630716049387 val/loss tensor(7.5295) val/accuracy tensor(0.0164)
epoch 8 train/loss tensor(5.6893) train/accuracy tensor(0.0685) train/lr 2.4056313679012344 val/loss tensor(6.3375) val/accuracy tensor(0.0376)
epoch 9 train/loss tensor(5.6233) train/accuracy tensor(0.0748) train/lr 2.3473152 val/loss tensor(7.0861) val/accuracy tensor(0.0328)
epoch 10 train/loss tensor(5.5625) train/accuracy tensor(0.0812) train/lr 2.2897145679012345 val/loss tensor(6.3204) val/accuracy tensor(0.0358)
epoch 11 train/loss tensor(5.5001) train/accuracy tensor(0.0887) train/lr 2.2328294716049384 val/loss tensor(6.8782) val/accuracy tensor(0.0307)
epoch 12 train/loss tensor(5.4444) train/accuracy tensor(0.0951) train/lr 2.1766599111111113 val/loss tensor(6.7703) val/accuracy tensor(0.0365)
epoch 13 train/loss tensor(5.3771) train/accuracy tensor(0.1036) train/lr 2.1212058864197534 val/loss tensor(6.4893) val/accuracy tensor(0.0420)
epoch 14 train/loss tensor(5.3356) train/accuracy tensor(0.1098) train/lr 2.066467397530864 val/loss tensor(5.7802) val/accuracy tensor(0.0703)
epoch 15 train/loss tensor(5.2514) train/accuracy tensor(0.1185) train/lr 2.0124444444444447 val/loss tensor(6.0418) val/accuracy tensor(0.0611)
epoch 16 train/loss tensor(5.1996) train/accuracy tensor(0.1263) train/lr 1.9591370271604935 val/loss tensor(5.7793) val/accuracy tensor(0.0760)
epoch 17 train/loss tensor(5.1118) train/accuracy tensor(0.1376) train/lr 1.9065451456790126 val/loss tensor(5.8792) val/accuracy tensor(0.0703)
epoch 18 train/loss tensor(5.0433) train/accuracy tensor(0.1459) train/lr 1.8546688000000005 val/loss tensor(5.9128) val/accuracy tensor(0.0780)
epoch 19 train/loss tensor(4.9796) train/accuracy tensor(0.1549) train/lr 1.8035079901234565 val/loss tensor(5.7267) val/accuracy tensor(0.0888)
epoch 20 train/loss tensor(4.9087) train/accuracy tensor(0.1660) train/lr 1.7530627160493828 val/loss tensor(6.1103) val/accuracy tensor(0.0707)
epoch 21 train/loss tensor(4.8174) train/accuracy tensor(0.1803) train/lr 1.7033329777777777 val/loss tensor(5.2312) val/accuracy tensor(0.1333)
epoch 22 train/loss tensor(4.7620) train/accuracy tensor(0.1888) train/lr 1.654318775308642 val/loss tensor(5.4910) val/accuracy tensor(0.0887)
epoch 23 train/loss tensor(4.6683) train/accuracy tensor(0.2026) train/lr 1.6060201086419754 val/loss tensor(5.7415) val/accuracy tensor(0.0892)
epoch 24 train/loss tensor(4.6074) train/accuracy tensor(0.2133) train/lr 1.5584369777777782 val/loss tensor(5.3686) val/accuracy tensor(0.1269)
epoch 25 train/loss tensor(4.5367) train/accuracy tensor(0.2255) train/lr 1.5115693827160495 val/loss tensor(5.8865) val/accuracy tensor(0.0875)
epoch 26 train/loss tensor(4.4857) train/accuracy tensor(0.2338) train/lr 1.4654173234567902 val/loss tensor(5.5299) val/accuracy tensor(0.1144)
epoch 27 train/loss tensor(4.3586) train/accuracy tensor(0.2526) train/lr 1.4199807999999998 val/loss tensor(5.4201) val/accuracy tensor(0.1133)
epoch 28 train/loss tensor(4.2740) train/accuracy tensor(0.2679) train/lr 1.375259812345679 val/loss tensor(5.1777) val/accuracy tensor(0.1549)
epoch 29 train/loss tensor(4.1992) train/accuracy tensor(0.2816) train/lr 1.3312543604938272 val/loss tensor(5.1682) val/accuracy tensor(0.1574)
epoch 30 train/loss tensor(4.1570) train/accuracy tensor(0.2899) train/lr 1.2879644444444447 val/loss tensor(5.4382) val/accuracy tensor(0.1415)
epoch 31 train/loss tensor(4.0606) train/accuracy tensor(0.3069) train/lr 1.2453900641975308 val/loss tensor(5.0302) val/accuracy tensor(0.1697)
epoch 32 train/loss tensor(3.9779) train/accuracy tensor(0.3214) train/lr 1.203531219753086 val/loss tensor(4.7846) val/accuracy tensor(0.1879)
epoch 33 train/loss tensor(3.9213) train/accuracy tensor(0.3329) train/lr 1.162387911111111 val/loss tensor(4.6138) val/accuracy tensor(0.2155)
epoch 34 train/loss tensor(3.8306) train/accuracy tensor(0.3501) train/lr 1.121960138271605 val/loss tensor(4.7029) val/accuracy tensor(0.2113)
epoch 35 train/loss tensor(3.7744) train/accuracy tensor(0.3609) train/lr 1.082247901234568 val/loss tensor(4.3995) val/accuracy tensor(0.2510)
epoch 36 train/loss tensor(3.7119) train/accuracy tensor(0.3735) train/lr 1.0432512 val/loss tensor(4.4675) val/accuracy tensor(0.2547)
epoch 37 train/loss tensor(3.6405) train/accuracy tensor(0.3881) train/lr 1.0049700345679013 val/loss tensor(4.4490) val/accuracy tensor(0.2541)
epoch 38 train/loss tensor(3.5797) train/accuracy tensor(0.3998) train/lr 0.9674044049382714 val/loss tensor(4.0902) val/accuracy tensor(0.2954)
epoch 39 train/loss tensor(3.5239) train/accuracy tensor(0.4122) train/lr 0.930554311111111 val/loss tensor(4.1433) val/accuracy tensor(0.2845)
epoch 40 train/loss tensor(3.4609) train/accuracy tensor(0.4251) train/lr 0.8944197530864199 val/loss tensor(4.0741) val/accuracy tensor(0.3026)
epoch 41 train/loss tensor(3.4144) train/accuracy tensor(0.4348) train/lr 0.8590007308641977 val/loss tensor(3.9828) val/accuracy tensor(0.3105)
epoch 42 train/loss tensor(3.3607) train/accuracy tensor(0.4461) train/lr 0.8242972444444444 val/loss tensor(4.0354) val/accuracy tensor(0.3170)
epoch 43 train/loss tensor(3.3161) train/accuracy tensor(0.4556) train/lr 0.7903092938271603 val/loss tensor(3.8980) val/accuracy tensor(0.3357)
epoch 44 train/loss tensor(3.2640) train/accuracy tensor(0.4678) train/lr 0.7570368790123455 val/loss tensor(3.6341) val/accuracy tensor(0.3832)
epoch 45 train/loss tensor(3.2098) train/accuracy tensor(0.4795) train/lr 0.72448 val/loss tensor(3.5910) val/accuracy tensor(0.3895)
epoch 46 train/loss tensor(3.1703) train/accuracy tensor(0.4879) train/lr 0.6926386567901236 val/loss tensor(3.6127) val/accuracy tensor(0.3838)
epoch 47 train/loss tensor(3.1309) train/accuracy tensor(0.4967) train/lr 0.6615128493827159 val/loss tensor(3.4722) val/accuracy tensor(0.4240)
epoch 48 train/loss tensor(3.0894) train/accuracy tensor(0.5063) train/lr 0.6311025777777778 val/loss tensor(3.4349) val/accuracy tensor(0.4207)
epoch 49 train/loss tensor(3.0498) train/accuracy tensor(0.5151) train/lr 0.6014078419753088 val/loss tensor(3.1788) val/accuracy tensor(0.4716)
epoch 50 train/loss tensor(3.0044) train/accuracy tensor(0.5249) train/lr 0.5724286419753086 val/loss tensor(3.2986) val/accuracy tensor(0.4524)
epoch 51 train/loss tensor(2.9682) train/accuracy tensor(0.5337) train/lr 0.5441649777777778 val/loss tensor(3.2843) val/accuracy tensor(0.4583)
epoch 52 train/loss tensor(2.9368) train/accuracy tensor(0.5409) train/lr 0.5166168493827162 val/loss tensor(3.2525) val/accuracy tensor(0.4753)
epoch 53 train/loss tensor(2.9020) train/accuracy tensor(0.5489) train/lr 0.4897842567901234 val/loss tensor(3.1730) val/accuracy tensor(0.4943)
epoch 54 train/loss tensor(2.8702) train/accuracy tensor(0.5560) train/lr 0.4636672000000001 val/loss tensor(3.1295) val/accuracy tensor(0.4967)
epoch 55 train/loss tensor(2.8313) train/accuracy tensor(0.5653) train/lr 0.43826567901234553 val/loss tensor(3.0313) val/accuracy tensor(0.5035)
epoch 56 train/loss tensor(2.8006) train/accuracy tensor(0.5723) train/lr 0.4135796938271605 val/loss tensor(2.9671) val/accuracy tensor(0.5259)
epoch 57 train/loss tensor(2.7723) train/accuracy tensor(0.5786) train/lr 0.38960924444444456 val/loss tensor(3.0576) val/accuracy tensor(0.5104)
epoch 58 train/loss tensor(2.7378) train/accuracy tensor(0.5868) train/lr 0.36635433086419744 val/loss tensor(2.9119) val/accuracy tensor(0.5401)
epoch 59 train/loss tensor(2.7095) train/accuracy tensor(0.5931) train/lr 0.34381495308641974 val/loss tensor(2.8423) val/accuracy tensor(0.5502)
epoch 60 train/loss tensor(2.6822) train/accuracy tensor(0.5997) train/lr 0.3219911111111112 val/loss tensor(2.8795) val/accuracy tensor(0.5393)
epoch 61 train/loss tensor(2.6509) train/accuracy tensor(0.6076) train/lr 0.3008828049382715 val/loss tensor(2.7797) val/accuracy tensor(0.5629)
epoch 62 train/loss tensor(2.6284) train/accuracy tensor(0.6132) train/lr 0.2804900345679012 val/loss tensor(2.6907) val/accuracy tensor(0.5906)
epoch 63 train/loss tensor(2.5996) train/accuracy tensor(0.6200) train/lr 0.26081280000000007 val/loss tensor(2.7015) val/accuracy tensor(0.5873)
epoch 64 train/loss tensor(2.5741) train/accuracy tensor(0.6254) train/lr 0.24185110123456785 val/loss tensor(2.6825) val/accuracy tensor(0.5924)
epoch 65 train/loss tensor(2.5499) train/accuracy tensor(0.6319) train/lr 0.22360493827160496 val/loss tensor(2.6175) val/accuracy tensor(0.6063)
epoch 66 train/loss tensor(2.5238) train/accuracy tensor(0.6381) train/lr 0.20607431111111119 val/loss tensor(2.5447) val/accuracy tensor(0.6222)
epoch 67 train/loss tensor(2.5005) train/accuracy tensor(0.6437) train/lr 0.18925921975308638 val/loss tensor(2.5635) val/accuracy tensor(0.6257)
epoch 68 train/loss tensor(2.4769) train/accuracy tensor(0.6498) train/lr 0.1731596641975309 val/loss tensor(2.5294) val/accuracy tensor(0.6292)
epoch 69 train/loss tensor(2.4527) train/accuracy tensor(0.6557) train/lr 0.1577756444444444 val/loss tensor(2.4513) val/accuracy tensor(0.6431)
epoch 70 train/loss tensor(2.4300) train/accuracy tensor(0.6612) train/lr 0.14310716049382716 val/loss tensor(2.4711) val/accuracy tensor(0.6398)
epoch 71 train/loss tensor(2.4078) train/accuracy tensor(0.6668) train/lr 0.12915421234567906 val/loss tensor(2.3901) val/accuracy tensor(0.6609)
epoch 72 train/loss tensor(2.3891) train/accuracy tensor(0.6713) train/lr 0.11591679999999994 val/loss tensor(2.3962) val/accuracy tensor(0.6631)
epoch 73 train/loss tensor(2.3682) train/accuracy tensor(0.6764) train/lr 0.10339492345679012 val/loss tensor(2.3396) val/accuracy tensor(0.6687)
epoch 74 train/loss tensor(2.3463) train/accuracy tensor(0.6818) train/lr 0.09158858271604943 val/loss tensor(2.3046) val/accuracy tensor(0.6810)
epoch 75 train/loss tensor(2.3292) train/accuracy tensor(0.6864) train/lr 0.08049777777777775 val/loss tensor(2.3115) val/accuracy tensor(0.6794)
epoch 76 train/loss tensor(2.3112) train/accuracy tensor(0.6912) train/lr 0.0701225086419753 val/loss tensor(2.2721) val/accuracy tensor(0.6900)
epoch 77 train/loss tensor(2.2933) train/accuracy tensor(0.6952) train/lr 0.06046277530864202 val/loss tensor(2.2464) val/accuracy tensor(0.6947)
epoch 78 train/loss tensor(2.2771) train/accuracy tensor(0.6998) train/lr 0.05151857777777776 val/loss tensor(2.2513) val/accuracy tensor(0.6956)
epoch 79 train/loss tensor(2.2612) train/accuracy tensor(0.7037) train/lr 0.043289916049382725 val/loss tensor(2.2197) val/accuracy tensor(0.7007)
epoch 80 train/loss tensor(2.2513) train/accuracy tensor(0.7066) train/lr 0.035776790123456824 val/loss tensor(2.2120) val/accuracy tensor(0.7069)
epoch 81 train/loss tensor(2.2388) train/accuracy tensor(0.7096) train/lr 0.028979199999999986 val/loss tensor(2.1884) val/accuracy tensor(0.7104)
epoch 82 train/loss tensor(2.2268) train/accuracy tensor(0.7124) train/lr 0.022897145679012357 val/loss tensor(2.1750) val/accuracy tensor(0.7113)
epoch 83 train/loss tensor(2.2137) train/accuracy tensor(0.7159) train/lr 0.017530627160493802 val/loss tensor(2.1666) val/accuracy tensor(0.7160)
epoch 84 train/loss tensor(2.2057) train/accuracy tensor(0.7183) train/lr 0.01287964444444444 val/loss tensor(2.1588) val/accuracy tensor(0.7160)
epoch 85 train/loss tensor(2.2009) train/accuracy tensor(0.7197) train/lr 0.008944197530864206 val/loss tensor(2.1518) val/accuracy tensor(0.7189)
epoch 86 train/loss tensor(2.1921) train/accuracy tensor(0.7222) train/lr 0.005724286419753074 val/loss tensor(2.1433) val/accuracy tensor(0.7203)
epoch 87 train/loss tensor(2.1892) train/accuracy tensor(0.7227) train/lr 0.00321991111111111 val/loss tensor(2.1451) val/accuracy tensor(0.7210)
epoch 88 train/loss tensor(2.1864) train/accuracy tensor(0.7229) train/lr 0.0014310716049382758 val/loss tensor(2.1409) val/accuracy tensor(0.7209)
epoch 89 train/loss tensor(2.1842) train/accuracy tensor(0.7240) train/lr 0.00035776790123456543 val/loss tensor(2.1407) val/accuracy tensor(0.7214)
epoch 90 train/loss tensor(2.1832) train/accuracy tensor(0.7241) train/lr 0.0 val/loss tensor(2.1417) val/accuracy tensor(0.7208)

Training time: 0:34:12.263521
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.02 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.02 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.7179) train/accuracy tensor(0.0067) train/lr 0.58864 val/loss tensor(6.7391) val/accuracy tensor(0.0035)
epoch 2 train/loss tensor(6.2537) train/accuracy tensor(0.0231) train/lr 1.16596 val/loss tensor(6.4871) val/accuracy tensor(0.0215)
epoch 3 train/loss tensor(5.9811) train/accuracy tensor(0.0417) train/lr 1.74328 val/loss tensor(6.2621) val/accuracy tensor(0.0337)
epoch 4 train/loss tensor(5.8745) train/accuracy tensor(0.0503) train/lr 2.3206 val/loss tensor(8.7547) val/accuracy tensor(0.0148)
epoch 5 train/loss tensor(5.7796) train/accuracy tensor(0.0592) train/lr 2.39497520661157 val/loss tensor(6.5615) val/accuracy tensor(0.0310)
epoch 6 train/loss tensor(5.6860) train/accuracy tensor(0.0690) train/lr 2.3001341884297517 val/loss tensor(8.0705) val/accuracy tensor(0.0208)
epoch 7 train/loss tensor(5.6232) train/accuracy tensor(0.0755) train/lr 2.2072091504132234 val/loss tensor(6.1685) val/accuracy tensor(0.0554)
epoch 8 train/loss tensor(5.4955) train/accuracy tensor(0.0895) train/lr 2.116200092561983 val/loss tensor(6.3149) val/accuracy tensor(0.0544)
epoch 9 train/loss tensor(5.3664) train/accuracy tensor(0.1040) train/lr 2.0271070148760333 val/loss tensor(5.7317) val/accuracy tensor(0.0738)
epoch 10 train/loss tensor(5.2968) train/accuracy tensor(0.1119) train/lr 1.9399299173553717 val/loss tensor(6.4459) val/accuracy tensor(0.0464)
epoch 11 train/loss tensor(5.1557) train/accuracy tensor(0.1307) train/lr 1.8546688000000005 val/loss tensor(5.2890) val/accuracy tensor(0.1121)
epoch 12 train/loss tensor(5.0433) train/accuracy tensor(0.1464) train/lr 1.7713236628099176 val/loss tensor(6.0369) val/accuracy tensor(0.0731)
epoch 13 train/loss tensor(4.9220) train/accuracy tensor(0.1632) train/lr 1.689894505785124 val/loss tensor(5.6983) val/accuracy tensor(0.0979)
epoch 14 train/loss tensor(4.8079) train/accuracy tensor(0.1804) train/lr 1.61038132892562 val/loss tensor(5.2475) val/accuracy tensor(0.1172)
epoch 15 train/loss tensor(4.6839) train/accuracy tensor(0.1987) train/lr 1.532784132231405 val/loss tensor(5.3896) val/accuracy tensor(0.1290)
epoch 16 train/loss tensor(4.5841) train/accuracy tensor(0.2150) train/lr 1.4571029157024795 val/loss tensor(5.3035) val/accuracy tensor(0.1325)
epoch 17 train/loss tensor(4.4678) train/accuracy tensor(0.2352) train/lr 1.383337679338843 val/loss tensor(4.9474) val/accuracy tensor(0.1664)
epoch 18 train/loss tensor(4.3511) train/accuracy tensor(0.2544) train/lr 1.311488423140496 val/loss tensor(5.2754) val/accuracy tensor(0.1478)
epoch 19 train/loss tensor(4.2248) train/accuracy tensor(0.2759) train/lr 1.2415551471074382 val/loss tensor(4.7118) val/accuracy tensor(0.1986)
epoch 20 train/loss tensor(4.1118) train/accuracy tensor(0.2979) train/lr 1.1735378512396695 val/loss tensor(4.6223) val/accuracy tensor(0.2081)
epoch 21 train/loss tensor(3.9914) train/accuracy tensor(0.3188) train/lr 1.10743653553719 val/loss tensor(4.8443) val/accuracy tensor(0.2135)
epoch 22 train/loss tensor(3.8903) train/accuracy tensor(0.3387) train/lr 1.0432512 val/loss tensor(4.4690) val/accuracy tensor(0.2451)
epoch 23 train/loss tensor(3.7832) train/accuracy tensor(0.3584) train/lr 0.9809818446280991 val/loss tensor(4.2428) val/accuracy tensor(0.2763)
epoch 24 train/loss tensor(3.6971) train/accuracy tensor(0.3747) train/lr 0.9206284694214879 val/loss tensor(4.3499) val/accuracy tensor(0.2546)
epoch 25 train/loss tensor(3.6062) train/accuracy tensor(0.3937) train/lr 0.8621910743801652 val/loss tensor(4.0668) val/accuracy tensor(0.3089)
epoch 26 train/loss tensor(3.5163) train/accuracy tensor(0.4123) train/lr 0.8056696595041324 val/loss tensor(3.9371) val/accuracy tensor(0.3203)
epoch 27 train/loss tensor(3.4421) train/accuracy tensor(0.4282) train/lr 0.7510642247933882 val/loss tensor(3.8853) val/accuracy tensor(0.3381)
epoch 28 train/loss tensor(3.3638) train/accuracy tensor(0.4451) train/lr 0.698374770247934 val/loss tensor(3.7878) val/accuracy tensor(0.3573)
epoch 29 train/loss tensor(3.2953) train/accuracy tensor(0.4602) train/lr 0.6476012958677687 val/loss tensor(3.5953) val/accuracy tensor(0.3846)
epoch 30 train/loss tensor(3.2182) train/accuracy tensor(0.4767) train/lr 0.5987438016528926 val/loss tensor(3.5258) val/accuracy tensor(0.4008)
epoch 31 train/loss tensor(3.1577) train/accuracy tensor(0.4896) train/lr 0.5518022876033059 val/loss tensor(3.3966) val/accuracy tensor(0.4297)
epoch 32 train/loss tensor(3.0941) train/accuracy tensor(0.5036) train/lr 0.5067767537190083 val/loss tensor(3.1808) val/accuracy tensor(0.4725)
epoch 33 train/loss tensor(3.0369) train/accuracy tensor(0.5173) train/lr 0.4636672000000001 val/loss tensor(3.2961) val/accuracy tensor(0.4568)
epoch 34 train/loss tensor(2.9876) train/accuracy tensor(0.5284) train/lr 0.422473626446281 val/loss tensor(3.2808) val/accuracy tensor(0.4504)
epoch 35 train/loss tensor(2.9340) train/accuracy tensor(0.5406) train/lr 0.38319603305785127 val/loss tensor(3.0073) val/accuracy tensor(0.5076)
epoch 36 train/loss tensor(2.8806) train/accuracy tensor(0.5529) train/lr 0.34583441983471075 val/loss tensor(3.0379) val/accuracy tensor(0.5142)
epoch 37 train/loss tensor(2.8340) train/accuracy tensor(0.5640) train/lr 0.31038878677685955 val/loss tensor(3.1069) val/accuracy tensor(0.5024)
epoch 38 train/loss tensor(2.7936) train/accuracy tensor(0.5734) train/lr 0.2768591338842975 val/loss tensor(2.8344) val/accuracy tensor(0.5498)
epoch 39 train/loss tensor(2.7468) train/accuracy tensor(0.5842) train/lr 0.24524546115702478 val/loss tensor(2.8079) val/accuracy tensor(0.5640)
epoch 40 train/loss tensor(2.7046) train/accuracy tensor(0.5943) train/lr 0.2155477685950413 val/loss tensor(2.7670) val/accuracy tensor(0.5718)
epoch 41 train/loss tensor(2.6635) train/accuracy tensor(0.6046) train/lr 0.18776605619834705 val/loss tensor(2.6534) val/accuracy tensor(0.5992)
epoch 42 train/loss tensor(2.6261) train/accuracy tensor(0.6132) train/lr 0.1619003239669421 val/loss tensor(2.6530) val/accuracy tensor(0.5956)
epoch 43 train/loss tensor(2.5933) train/accuracy tensor(0.6210) train/lr 0.1379505719008264 val/loss tensor(2.5540) val/accuracy tensor(0.6223)
epoch 44 train/loss tensor(2.5590) train/accuracy tensor(0.6299) train/lr 0.11591679999999994 val/loss tensor(2.4968) val/accuracy tensor(0.6333)
epoch 45 train/loss tensor(2.5287) train/accuracy tensor(0.6369) train/lr 0.09579900826446275 val/loss tensor(2.4647) val/accuracy tensor(0.6455)
epoch 46 train/loss tensor(2.4954) train/accuracy tensor(0.6451) train/lr 0.07759719669421493 val/loss tensor(2.4097) val/accuracy tensor(0.6542)
epoch 47 train/loss tensor(2.4728) train/accuracy tensor(0.6514) train/lr 0.061311365289256244 val/loss tensor(2.3866) val/accuracy tensor(0.6593)
epoch 48 train/loss tensor(2.4453) train/accuracy tensor(0.6575) train/lr 0.04694151404958682 val/loss tensor(2.3502) val/accuracy tensor(0.6687)
epoch 49 train/loss tensor(2.4266) train/accuracy tensor(0.6626) train/lr 0.03448764297520664 val/loss tensor(2.3147) val/accuracy tensor(0.6751)
epoch 50 train/loss tensor(2.4066) train/accuracy tensor(0.6677) train/lr 0.02394975206611572 val/loss tensor(2.2990) val/accuracy tensor(0.6824)
epoch 51 train/loss tensor(2.3910) train/accuracy tensor(0.6715) train/lr 0.015327841322314061 val/loss tensor(2.2826) val/accuracy tensor(0.6845)
epoch 52 train/loss tensor(2.3796) train/accuracy tensor(0.6749) train/lr 0.00862191074380166 val/loss tensor(2.2659) val/accuracy tensor(0.6900)
epoch 53 train/loss tensor(2.3697) train/accuracy tensor(0.6769) train/lr 0.0038319603305785152 val/loss tensor(2.2623) val/accuracy tensor(0.6910)
epoch 54 train/loss tensor(2.3649) train/accuracy tensor(0.6785) train/lr 0.0009579900826446288 val/loss tensor(2.2588) val/accuracy tensor(0.6916)
epoch 55 train/loss tensor(2.3628) train/accuracy tensor(0.6786) train/lr 0.0 val/loss tensor(2.2578) val/accuracy tensor(0.6923)

Training time: 0:20:47.344075
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.025 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.025 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.025 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.025 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8143) train/accuracy tensor(0.0041) train/lr 0.58864 val/loss tensor(6.7386) val/accuracy tensor(0.0045)
epoch 2 train/loss tensor(6.3498) train/accuracy tensor(0.0179) train/lr 1.16596 val/loss tensor(6.5597) val/accuracy tensor(0.0176)
epoch 3 train/loss tensor(6.1030) train/accuracy tensor(0.0323) train/lr 1.74328 val/loss tensor(7.0588) val/accuracy tensor(0.0176)
epoch 4 train/loss tensor(6.0575) train/accuracy tensor(0.0363) train/lr 2.3206 val/loss tensor(8.0240) val/accuracy tensor(0.0125)
epoch 5 train/loss tensor(6.0605) train/accuracy tensor(0.0362) train/lr 2.39497520661157 val/loss tensor(6.8426) val/accuracy tensor(0.0155)
epoch 6 train/loss tensor(6.0503) train/accuracy tensor(0.0376) train/lr 2.3001341884297517 val/loss tensor(6.5360) val/accuracy tensor(0.0239)
epoch 7 train/loss tensor(6.0190) train/accuracy tensor(0.0404) train/lr 2.2072091504132234 val/loss tensor(6.7158) val/accuracy tensor(0.0210)
epoch 8 train/loss tensor(5.9257) train/accuracy tensor(0.0476) train/lr 2.116200092561983 val/loss tensor(6.9326) val/accuracy tensor(0.0184)
epoch 9 train/loss tensor(5.8256) train/accuracy tensor(0.0557) train/lr 2.0271070148760333 val/loss tensor(6.3037) val/accuracy tensor(0.0330)
epoch 10 train/loss tensor(5.7528) train/accuracy tensor(0.0620) train/lr 1.9399299173553717 val/loss tensor(6.2710) val/accuracy tensor(0.0377)
epoch 11 train/loss tensor(5.6674) train/accuracy tensor(0.0709) train/lr 1.8546688000000005 val/loss tensor(6.4187) val/accuracy tensor(0.0349)
epoch 12 train/loss tensor(5.5664) train/accuracy tensor(0.0822) train/lr 1.7713236628099176 val/loss tensor(6.4820) val/accuracy tensor(0.0394)
epoch 13 train/loss tensor(5.5032) train/accuracy tensor(0.0886) train/lr 1.689894505785124 val/loss tensor(6.0128) val/accuracy tensor(0.0567)
epoch 14 train/loss tensor(5.4029) train/accuracy tensor(0.1008) train/lr 1.61038132892562 val/loss tensor(5.7237) val/accuracy tensor(0.0683)
epoch 15 train/loss tensor(5.3004) train/accuracy tensor(0.1120) train/lr 1.532784132231405 val/loss tensor(5.8147) val/accuracy tensor(0.0654)
epoch 16 train/loss tensor(5.1856) train/accuracy tensor(0.1285) train/lr 1.4571029157024795 val/loss tensor(5.5946) val/accuracy tensor(0.0840)
epoch 17 train/loss tensor(5.0924) train/accuracy tensor(0.1404) train/lr 1.383337679338843 val/loss tensor(5.6322) val/accuracy tensor(0.0976)
epoch 18 train/loss tensor(4.9374) train/accuracy tensor(0.1609) train/lr 1.311488423140496 val/loss tensor(5.7661) val/accuracy tensor(0.0864)
epoch 19 train/loss tensor(4.8359) train/accuracy tensor(0.1759) train/lr 1.2415551471074382 val/loss tensor(5.5301) val/accuracy tensor(0.1107)
epoch 20 train/loss tensor(4.7260) train/accuracy tensor(0.1929) train/lr 1.1735378512396695 val/loss tensor(5.0561) val/accuracy tensor(0.1431)
epoch 21 train/loss tensor(4.5862) train/accuracy tensor(0.2149) train/lr 1.10743653553719 val/loss tensor(5.2857) val/accuracy tensor(0.1272)
epoch 22 train/loss tensor(4.4648) train/accuracy tensor(0.2342) train/lr 1.0432512 val/loss tensor(4.9137) val/accuracy tensor(0.1665)
epoch 23 train/loss tensor(4.3470) train/accuracy tensor(0.2538) train/lr 0.9809818446280991 val/loss tensor(4.7286) val/accuracy tensor(0.1940)
epoch 24 train/loss tensor(4.2218) train/accuracy tensor(0.2762) train/lr 0.9206284694214879 val/loss tensor(4.6022) val/accuracy tensor(0.2085)
epoch 25 train/loss tensor(4.0962) train/accuracy tensor(0.2993) train/lr 0.8621910743801652 val/loss tensor(4.4525) val/accuracy tensor(0.2361)
epoch 26 train/loss tensor(3.9912) train/accuracy tensor(0.3188) train/lr 0.8056696595041324 val/loss tensor(4.4438) val/accuracy tensor(0.2375)
epoch 27 train/loss tensor(3.8862) train/accuracy tensor(0.3393) train/lr 0.7510642247933882 val/loss tensor(4.2651) val/accuracy tensor(0.2657)
epoch 28 train/loss tensor(3.7751) train/accuracy tensor(0.3602) train/lr 0.698374770247934 val/loss tensor(4.5059) val/accuracy tensor(0.2527)
epoch 29 train/loss tensor(3.6684) train/accuracy tensor(0.3823) train/lr 0.6476012958677687 val/loss tensor(3.9452) val/accuracy tensor(0.3186)
epoch 30 train/loss tensor(3.5742) train/accuracy tensor(0.4012) train/lr 0.5987438016528926 val/loss tensor(3.7852) val/accuracy tensor(0.3475)
epoch 31 train/loss tensor(3.4899) train/accuracy tensor(0.4188) train/lr 0.5518022876033059 val/loss tensor(3.9498) val/accuracy tensor(0.3191)
epoch 32 train/loss tensor(3.4079) train/accuracy tensor(0.4357) train/lr 0.5067767537190083 val/loss tensor(3.5968) val/accuracy tensor(0.3872)
epoch 33 train/loss tensor(3.3274) train/accuracy tensor(0.4530) train/lr 0.4636672000000001 val/loss tensor(3.5291) val/accuracy tensor(0.4035)
epoch 34 train/loss tensor(3.2537) train/accuracy tensor(0.4697) train/lr 0.422473626446281 val/loss tensor(3.6273) val/accuracy tensor(0.3881)
epoch 35 train/loss tensor(3.1849) train/accuracy tensor(0.4847) train/lr 0.38319603305785127 val/loss tensor(3.3668) val/accuracy tensor(0.4317)
epoch 36 train/loss tensor(3.1163) train/accuracy tensor(0.5003) train/lr 0.34583441983471075 val/loss tensor(3.3048) val/accuracy tensor(0.4494)
epoch 37 train/loss tensor(3.0545) train/accuracy tensor(0.5138) train/lr 0.31038878677685955 val/loss tensor(3.2475) val/accuracy tensor(0.4685)
epoch 38 train/loss tensor(2.9983) train/accuracy tensor(0.5272) train/lr 0.2768591338842975 val/loss tensor(3.1410) val/accuracy tensor(0.4890)
epoch 39 train/loss tensor(2.9442) train/accuracy tensor(0.5397) train/lr 0.24524546115702478 val/loss tensor(3.0161) val/accuracy tensor(0.5175)
epoch 40 train/loss tensor(2.8897) train/accuracy tensor(0.5525) train/lr 0.2155477685950413 val/loss tensor(2.9604) val/accuracy tensor(0.5230)
epoch 41 train/loss tensor(2.8415) train/accuracy tensor(0.5628) train/lr 0.18776605619834705 val/loss tensor(2.9115) val/accuracy tensor(0.5348)
epoch 42 train/loss tensor(2.7926) train/accuracy tensor(0.5745) train/lr 0.1619003239669421 val/loss tensor(2.8477) val/accuracy tensor(0.5538)
epoch 43 train/loss tensor(2.7522) train/accuracy tensor(0.5849) train/lr 0.1379505719008264 val/loss tensor(2.7382) val/accuracy tensor(0.5825)
epoch 44 train/loss tensor(2.7094) train/accuracy tensor(0.5943) train/lr 0.11591679999999994 val/loss tensor(2.6555) val/accuracy tensor(0.5974)
epoch 45 train/loss tensor(2.6721) train/accuracy tensor(0.6035) train/lr 0.09579900826446275 val/loss tensor(2.6255) val/accuracy tensor(0.6087)
epoch 46 train/loss tensor(2.6327) train/accuracy tensor(0.6132) train/lr 0.07759719669421493 val/loss tensor(2.5484) val/accuracy tensor(0.6263)
epoch 47 train/loss tensor(2.6010) train/accuracy tensor(0.6211) train/lr 0.061311365289256244 val/loss tensor(2.5048) val/accuracy tensor(0.6363)
epoch 48 train/loss tensor(2.5722) train/accuracy tensor(0.6279) train/lr 0.04694151404958682 val/loss tensor(2.4571) val/accuracy tensor(0.6475)
epoch 49 train/loss tensor(2.5464) train/accuracy tensor(0.6346) train/lr 0.03448764297520664 val/loss tensor(2.4205) val/accuracy tensor(0.6530)
epoch 50 train/loss tensor(2.5210) train/accuracy tensor(0.6408) train/lr 0.02394975206611572 val/loss tensor(2.4003) val/accuracy tensor(0.6592)
epoch 51 train/loss tensor(2.5023) train/accuracy tensor(0.6452) train/lr 0.015327841322314061 val/loss tensor(2.3789) val/accuracy tensor(0.6661)
epoch 52 train/loss tensor(2.4874) train/accuracy tensor(0.6494) train/lr 0.00862191074380166 val/loss tensor(2.3535) val/accuracy tensor(0.6687)
epoch 53 train/loss tensor(2.4774) train/accuracy tensor(0.6519) train/lr 0.0038319603305785152 val/loss tensor(2.3459) val/accuracy tensor(0.6691)
epoch 54 train/loss tensor(2.4727) train/accuracy tensor(0.6527) train/lr 0.0009579900826446288 val/loss tensor(2.3426) val/accuracy tensor(0.6701)
epoch 55 train/loss tensor(2.4691) train/accuracy tensor(0.6543) train/lr 0.0 val/loss tensor(2.3422) val/accuracy tensor(0.6713)

Training time: 0:21:16.400462
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.7829) train/accuracy tensor(0.0051) train/lr 0.58864 val/loss tensor(6.7524) val/accuracy tensor(0.0033)
epoch 2 train/loss tensor(6.3826) train/accuracy tensor(0.0169) train/lr 1.16596 val/loss tensor(6.7635) val/accuracy tensor(0.0157)
epoch 3 train/loss tensor(6.1693) train/accuracy tensor(0.0282) train/lr 1.74328 val/loss tensor(8.0473) val/accuracy tensor(0.0088)
epoch 4 train/loss tensor(6.1986) train/accuracy tensor(0.0273) train/lr 2.3206 val/loss tensor(16.9413) val/accuracy tensor(0.0027)
epoch 5 train/loss tensor(6.3448) train/accuracy tensor(0.0195) train/lr 2.584873086419753 val/loss tensor(8.4393) val/accuracy tensor(0.0044)
epoch 6 train/loss tensor(6.3976) train/accuracy tensor(0.0162) train/lr 2.524410311111111 val/loss tensor(7.0281) val/accuracy tensor(0.0048)
epoch 7 train/loss tensor(6.4193) train/accuracy tensor(0.0154) train/lr 2.4646630716049387 val/loss tensor(7.0768) val/accuracy tensor(0.0044)
epoch 8 train/loss tensor(6.3512) train/accuracy tensor(0.0183) train/lr 2.4056313679012344 val/loss tensor(6.8949) val/accuracy tensor(0.0058)
epoch 9 train/loss tensor(6.3307) train/accuracy tensor(0.0197) train/lr 2.3473152 val/loss tensor(7.3342) val/accuracy tensor(0.0060)
epoch 10 train/loss tensor(6.3032) train/accuracy tensor(0.0213) train/lr 2.2897145679012345 val/loss tensor(6.4398) val/accuracy tensor(0.0143)
epoch 11 train/loss tensor(6.2926) train/accuracy tensor(0.0217) train/lr 2.2328294716049384 val/loss tensor(7.2864) val/accuracy tensor(0.0069)
epoch 12 train/loss tensor(6.2957) train/accuracy tensor(0.0215) train/lr 2.1766599111111113 val/loss tensor(6.6142) val/accuracy tensor(0.0093)
epoch 13 train/loss tensor(6.2564) train/accuracy tensor(0.0230) train/lr 2.1212058864197534 val/loss tensor(6.8181) val/accuracy tensor(0.0113)
epoch 14 train/loss tensor(6.2226) train/accuracy tensor(0.0256) train/lr 2.066467397530864 val/loss tensor(6.8730) val/accuracy tensor(0.0074)
epoch 15 train/loss tensor(6.1880) train/accuracy tensor(0.0281) train/lr 2.0124444444444447 val/loss tensor(6.5848) val/accuracy tensor(0.0135)
epoch 16 train/loss tensor(6.1563) train/accuracy tensor(0.0297) train/lr 1.9591370271604935 val/loss tensor(7.7517) val/accuracy tensor(0.0049)
epoch 17 train/loss tensor(6.1258) train/accuracy tensor(0.0317) train/lr 1.9065451456790126 val/loss tensor(6.9929) val/accuracy tensor(0.0136)
epoch 18 train/loss tensor(6.0769) train/accuracy tensor(0.0352) train/lr 1.8546688000000005 val/loss tensor(6.4525) val/accuracy tensor(0.0213)
epoch 19 train/loss tensor(6.0312) train/accuracy tensor(0.0388) train/lr 1.8035079901234565 val/loss tensor(6.4887) val/accuracy tensor(0.0204)
epoch 20 train/loss tensor(5.9788) train/accuracy tensor(0.0424) train/lr 1.7530627160493828 val/loss tensor(6.4451) val/accuracy tensor(0.0217)
epoch 21 train/loss tensor(5.9104) train/accuracy tensor(0.0479) train/lr 1.7033329777777777 val/loss tensor(6.9670) val/accuracy tensor(0.0207)
epoch 22 train/loss tensor(5.8567) train/accuracy tensor(0.0539) train/lr 1.654318775308642 val/loss tensor(6.2968) val/accuracy tensor(0.0249)
epoch 23 train/loss tensor(5.8304) train/accuracy tensor(0.0550) train/lr 1.6060201086419754 val/loss tensor(7.1506) val/accuracy tensor(0.0204)
epoch 24 train/loss tensor(5.7846) train/accuracy tensor(0.0603) train/lr 1.5584369777777782 val/loss tensor(6.2167) val/accuracy tensor(0.0342)
epoch 25 train/loss tensor(5.7317) train/accuracy tensor(0.0651) train/lr 1.5115693827160495 val/loss tensor(6.3433) val/accuracy tensor(0.0338)
epoch 26 train/loss tensor(5.6384) train/accuracy tensor(0.0742) train/lr 1.4654173234567902 val/loss tensor(6.0919) val/accuracy tensor(0.0436)
epoch 27 train/loss tensor(5.5840) train/accuracy tensor(0.0802) train/lr 1.4199807999999998 val/loss tensor(6.0884) val/accuracy tensor(0.0431)
epoch 28 train/loss tensor(5.4890) train/accuracy tensor(0.0900) train/lr 1.375259812345679 val/loss tensor(5.7618) val/accuracy tensor(0.0626)
epoch 29 train/loss tensor(5.4382) train/accuracy tensor(0.0977) train/lr 1.3312543604938272 val/loss tensor(5.9762) val/accuracy tensor(0.0602)
epoch 30 train/loss tensor(5.3742) train/accuracy tensor(0.1045) train/lr 1.2879644444444447 val/loss tensor(5.9048) val/accuracy tensor(0.0622)
epoch 31 train/loss tensor(5.2584) train/accuracy tensor(0.1190) train/lr 1.2453900641975308 val/loss tensor(5.6230) val/accuracy tensor(0.0833)
epoch 32 train/loss tensor(5.2201) train/accuracy tensor(0.1256) train/lr 1.203531219753086 val/loss tensor(5.8914) val/accuracy tensor(0.0697)
epoch 33 train/loss tensor(5.1541) train/accuracy tensor(0.1353) train/lr 1.162387911111111 val/loss tensor(5.8740) val/accuracy tensor(0.0822)
epoch 34 train/loss tensor(5.0609) train/accuracy tensor(0.1482) train/lr 1.121960138271605 val/loss tensor(5.5362) val/accuracy tensor(0.1005)
epoch 35 train/loss tensor(4.9942) train/accuracy tensor(0.1577) train/lr 1.082247901234568 val/loss tensor(5.3623) val/accuracy tensor(0.1130)
epoch 36 train/loss tensor(4.8942) train/accuracy tensor(0.1703) train/lr 1.0432512 val/loss tensor(5.8053) val/accuracy tensor(0.0974)
epoch 37 train/loss tensor(4.7710) train/accuracy tensor(0.1882) train/lr 1.0049700345679013 val/loss tensor(5.2014) val/accuracy tensor(0.1305)
epoch 38 train/loss tensor(4.6806) train/accuracy tensor(0.2031) train/lr 0.9674044049382714 val/loss tensor(5.5293) val/accuracy tensor(0.1047)
epoch 39 train/loss tensor(4.6091) train/accuracy tensor(0.2159) train/lr 0.930554311111111 val/loss tensor(5.0418) val/accuracy tensor(0.1566)
epoch 40 train/loss tensor(4.5154) train/accuracy tensor(0.2314) train/lr 0.8944197530864199 val/loss tensor(5.2145) val/accuracy tensor(0.1447)
epoch 41 train/loss tensor(4.3976) train/accuracy tensor(0.2506) train/lr 0.8590007308641977 val/loss tensor(5.2231) val/accuracy tensor(0.1561)
epoch 42 train/loss tensor(4.3217) train/accuracy tensor(0.2630) train/lr 0.8242972444444444 val/loss tensor(4.6370) val/accuracy tensor(0.2208)
epoch 43 train/loss tensor(4.2266) train/accuracy tensor(0.2801) train/lr 0.7903092938271603 val/loss tensor(4.3703) val/accuracy tensor(0.2503)
epoch 44 train/loss tensor(4.1651) train/accuracy tensor(0.2924) train/lr 0.7570368790123455 val/loss tensor(4.4113) val/accuracy tensor(0.2434)
epoch 45 train/loss tensor(4.0827) train/accuracy tensor(0.3067) train/lr 0.72448 val/loss tensor(4.2786) val/accuracy tensor(0.2629)
epoch 46 train/loss tensor(3.9827) train/accuracy tensor(0.3247) train/lr 0.6926386567901236 val/loss tensor(4.3493) val/accuracy tensor(0.2598)
epoch 47 train/loss tensor(3.9215) train/accuracy tensor(0.3377) train/lr 0.6615128493827159 val/loss tensor(4.1625) val/accuracy tensor(0.2838)
epoch 48 train/loss tensor(3.8465) train/accuracy tensor(0.3513) train/lr 0.6311025777777778 val/loss tensor(4.0760) val/accuracy tensor(0.3010)
epoch 49 train/loss tensor(3.7726) train/accuracy tensor(0.3660) train/lr 0.6014078419753088 val/loss tensor(4.2870) val/accuracy tensor(0.2718)
epoch 50 train/loss tensor(3.7019) train/accuracy tensor(0.3798) train/lr 0.5724286419753086 val/loss tensor(3.9986) val/accuracy tensor(0.3285)
epoch 51 train/loss tensor(3.6322) train/accuracy tensor(0.3935) train/lr 0.5441649777777778 val/loss tensor(4.1608) val/accuracy tensor(0.2980)
epoch 52 train/loss tensor(3.5784) train/accuracy tensor(0.4045) train/lr 0.5166168493827162 val/loss tensor(3.6831) val/accuracy tensor(0.3768)
epoch 53 train/loss tensor(3.5155) train/accuracy tensor(0.4176) train/lr 0.4897842567901234 val/loss tensor(3.8154) val/accuracy tensor(0.3561)
epoch 54 train/loss tensor(3.4586) train/accuracy tensor(0.4289) train/lr 0.4636672000000001 val/loss tensor(3.5909) val/accuracy tensor(0.3920)
epoch 55 train/loss tensor(3.4032) train/accuracy tensor(0.4410) train/lr 0.43826567901234553 val/loss tensor(3.5788) val/accuracy tensor(0.3881)
epoch 56 train/loss tensor(3.3462) train/accuracy tensor(0.4532) train/lr 0.4135796938271605 val/loss tensor(3.6178) val/accuracy tensor(0.3869)
epoch 57 train/loss tensor(3.3024) train/accuracy tensor(0.4628) train/lr 0.38960924444444456 val/loss tensor(3.5122) val/accuracy tensor(0.4055)
epoch 58 train/loss tensor(3.2548) train/accuracy tensor(0.4723) train/lr 0.36635433086419744 val/loss tensor(3.5352) val/accuracy tensor(0.4082)
epoch 59 train/loss tensor(3.2098) train/accuracy tensor(0.4821) train/lr 0.34381495308641974 val/loss tensor(3.3399) val/accuracy tensor(0.4482)
epoch 60 train/loss tensor(3.1662) train/accuracy tensor(0.4920) train/lr 0.3219911111111112 val/loss tensor(3.3277) val/accuracy tensor(0.4511)
epoch 61 train/loss tensor(3.1166) train/accuracy tensor(0.5026) train/lr 0.3008828049382715 val/loss tensor(3.1890) val/accuracy tensor(0.4831)
epoch 62 train/loss tensor(3.0762) train/accuracy tensor(0.5115) train/lr 0.2804900345679012 val/loss tensor(3.2063) val/accuracy tensor(0.4755)
epoch 63 train/loss tensor(3.0367) train/accuracy tensor(0.5200) train/lr 0.26081280000000007 val/loss tensor(3.1107) val/accuracy tensor(0.5007)
epoch 64 train/loss tensor(2.9967) train/accuracy tensor(0.5288) train/lr 0.24185110123456785 val/loss tensor(3.0246) val/accuracy tensor(0.5158)
epoch 65 train/loss tensor(2.9575) train/accuracy tensor(0.5375) train/lr 0.22360493827160496 val/loss tensor(2.9996) val/accuracy tensor(0.5244)
epoch 66 train/loss tensor(2.9248) train/accuracy tensor(0.5447) train/lr 0.20607431111111119 val/loss tensor(2.8924) val/accuracy tensor(0.5397)
epoch 67 train/loss tensor(2.8901) train/accuracy tensor(0.5525) train/lr 0.18925921975308638 val/loss tensor(2.9107) val/accuracy tensor(0.5423)
epoch 68 train/loss tensor(2.8543) train/accuracy tensor(0.5608) train/lr 0.1731596641975309 val/loss tensor(2.8955) val/accuracy tensor(0.5435)
epoch 69 train/loss tensor(2.8183) train/accuracy tensor(0.5687) train/lr 0.1577756444444444 val/loss tensor(2.8223) val/accuracy tensor(0.5682)
epoch 70 train/loss tensor(2.7901) train/accuracy tensor(0.5749) train/lr 0.14310716049382716 val/loss tensor(2.7560) val/accuracy tensor(0.5720)
epoch 71 train/loss tensor(2.7598) train/accuracy tensor(0.5816) train/lr 0.12915421234567906 val/loss tensor(2.7303) val/accuracy tensor(0.5813)
epoch 72 train/loss tensor(2.7297) train/accuracy tensor(0.5888) train/lr 0.11591679999999994 val/loss tensor(2.7043) val/accuracy tensor(0.5871)
epoch 73 train/loss tensor(2.7030) train/accuracy tensor(0.5947) train/lr 0.10339492345679012 val/loss tensor(2.6133) val/accuracy tensor(0.6067)
epoch 74 train/loss tensor(2.6728) train/accuracy tensor(0.6023) train/lr 0.09158858271604943 val/loss tensor(2.6082) val/accuracy tensor(0.6053)
epoch 75 train/loss tensor(2.6488) train/accuracy tensor(0.6069) train/lr 0.08049777777777775 val/loss tensor(2.5598) val/accuracy tensor(0.6209)
epoch 76 train/loss tensor(2.6234) train/accuracy tensor(0.6135) train/lr 0.0701225086419753 val/loss tensor(2.5573) val/accuracy tensor(0.6252)
epoch 77 train/loss tensor(2.5983) train/accuracy tensor(0.6191) train/lr 0.06046277530864202 val/loss tensor(2.4886) val/accuracy tensor(0.6340)
epoch 78 train/loss tensor(2.5757) train/accuracy tensor(0.6243) train/lr 0.05151857777777776 val/loss tensor(2.4814) val/accuracy tensor(0.6413)
epoch 79 train/loss tensor(2.5550) train/accuracy tensor(0.6293) train/lr 0.043289916049382725 val/loss tensor(2.4251) val/accuracy tensor(0.6491)
epoch 80 train/loss tensor(2.5398) train/accuracy tensor(0.6328) train/lr 0.035776790123456824 val/loss tensor(2.4255) val/accuracy tensor(0.6550)
epoch 81 train/loss tensor(2.5178) train/accuracy tensor(0.6381) train/lr 0.028979199999999986 val/loss tensor(2.3728) val/accuracy tensor(0.6612)
epoch 82 train/loss tensor(2.5025) train/accuracy tensor(0.6421) train/lr 0.022897145679012357 val/loss tensor(2.3589) val/accuracy tensor(0.6658)
epoch 83 train/loss tensor(2.4880) train/accuracy tensor(0.6454) train/lr 0.017530627160493802 val/loss tensor(2.3367) val/accuracy tensor(0.6685)
epoch 84 train/loss tensor(2.4746) train/accuracy tensor(0.6482) train/lr 0.01287964444444444 val/loss tensor(2.3315) val/accuracy tensor(0.6705)
epoch 85 train/loss tensor(2.4642) train/accuracy tensor(0.6516) train/lr 0.008944197530864206 val/loss tensor(2.3173) val/accuracy tensor(0.6751)
epoch 86 train/loss tensor(2.4549) train/accuracy tensor(0.6530) train/lr 0.005724286419753074 val/loss tensor(2.3072) val/accuracy tensor(0.6764)
epoch 87 train/loss tensor(2.4501) train/accuracy tensor(0.6545) train/lr 0.00321991111111111 val/loss tensor(2.3030) val/accuracy tensor(0.6764)
epoch 88 train/loss tensor(2.4429) train/accuracy tensor(0.6561) train/lr 0.0014310716049382758 val/loss tensor(2.3003) val/accuracy tensor(0.6775)
epoch 89 train/loss tensor(2.4417) train/accuracy tensor(0.6569) train/lr 0.00035776790123456543 val/loss tensor(2.2994) val/accuracy tensor(0.6777)
epoch 90 train/loss tensor(2.4394) train/accuracy tensor(0.6574) train/lr 0.0 val/loss tensor(2.2977) val/accuracy tensor(0.6776)

Training time: 0:35:59.044620
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001133  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.03 --kfac-inv-update-steps=0
Launching rank 0 on local node nid001133
Launching rank 1 on remote node nid001136
Launching rank 2 on remote node nid001220
Launching rank 3 on remote node nid001229
Launching rank 4 on remote node nid001417
Launching rank 5 on remote node nid001420
Launching rank 6 on remote node nid001421
Launching rank 7 on remote node nid001424
Launching rank 8 on remote node nid001425
Launching rank 9 on remote node nid001481
Launching rank 10 on remote node nid001484
Launching rank 11 on remote node nid001485
Launching rank 12 on remote node nid001488
Launching rank 13 on remote node nid001492
Launching rank 14 on remote node nid001513
Launching rank 15 on remote node nid001544
Launching rank 16 on remote node nid001616
Launching rank 17 on remote node nid001624
Launching rank 18 on remote node nid001632
Launching rank 19 on remote node nid001640
Launching rank 20 on remote node nid001649
Launching rank 21 on remote node nid001665
Launching rank 22 on remote node nid001709
Launching rank 23 on remote node nid001720
Launching rank 24 on remote node nid001736
Launching rank 25 on remote node nid001744
Launching rank 26 on remote node nid001773
Launching rank 27 on remote node nid001776
Launching rank 28 on remote node nid001777
Launching rank 29 on remote node nid001780
Launching rank 30 on remote node nid001781
Launching rank 31 on remote node nid001784
Launching rank 32 on remote node nid001785
Launching rank 33 on remote node nid001788
Launching rank 34 on remote node nid003181
Launching rank 35 on remote node nid003184
Launching rank 36 on remote node nid003185
Launching rank 37 on remote node nid003188
Launching rank 38 on remote node nid003189
Launching rank 39 on remote node nid003192
Launching rank 40 on remote node nid003296
Launching rank 41 on remote node nid003297
Launching rank 42 on remote node nid003300
Launching rank 43 on remote node nid003301
Launching rank 44 on remote node nid003304
Launching rank 45 on remote node nid003305
Launching rank 46 on remote node nid003308
Launching rank 47 on remote node nid003309
Launching rank 48 on remote node nid003312
Launching rank 49 on remote node nid003313
Launching rank 50 on remote node nid003316
Launching rank 51 on remote node nid003317
Launching rank 52 on remote node nid003320
Launching rank 53 on remote node nid003321
Launching rank 54 on remote node nid003324
Launching rank 55 on remote node nid003433
Launching rank 56 on remote node nid003436
Launching rank 57 on remote node nid003437
Launching rank 58 on remote node nid003440
Launching rank 59 on remote node nid003441
Launching rank 60 on remote node nid003452
Launching rank 61 on remote node nid003453
Launching rank 62 on remote node nid003537
Launching rank 63 on remote node nid003540
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.8504) train/accuracy tensor(0.0034) train/lr 0.58864 val/loss tensor(6.7695) val/accuracy tensor(0.0037)
epoch 2 train/loss tensor(6.4507) train/accuracy tensor(0.0140) train/lr 1.16596 val/loss tensor(7.8682) val/accuracy tensor(0.0074)
epoch 3 train/loss tensor(6.2090) train/accuracy tensor(0.0257) train/lr 1.74328 val/loss tensor(7.5929) val/accuracy tensor(0.0141)
epoch 4 train/loss tensor(6.2274) train/accuracy tensor(0.0256) train/lr 2.3206 val/loss tensor(8.4961) val/accuracy tensor(0.0085)
epoch 5 train/loss tensor(6.2992) train/accuracy tensor(0.0221) train/lr 2.39497520661157 val/loss tensor(6.9209) val/accuracy tensor(0.0101)
epoch 6 train/loss tensor(6.2714) train/accuracy tensor(0.0236) train/lr 2.3001341884297517 val/loss tensor(6.7151) val/accuracy tensor(0.0098)
epoch 7 train/loss tensor(6.3529) train/accuracy tensor(0.0189) train/lr 2.2072091504132234 val/loss tensor(7.0609) val/accuracy tensor(0.0082)
epoch 8 train/loss tensor(6.2636) train/accuracy tensor(0.0231) train/lr 2.116200092561983 val/loss tensor(6.6011) val/accuracy tensor(0.0133)
epoch 9 train/loss tensor(6.1758) train/accuracy tensor(0.0280) train/lr 2.0271070148760333 val/loss tensor(7.1168) val/accuracy tensor(0.0092)
epoch 10 train/loss tensor(6.1028) train/accuracy tensor(0.0332) train/lr 1.9399299173553717 val/loss tensor(6.2154) val/accuracy tensor(0.0284)
epoch 11 train/loss tensor(6.0401) train/accuracy tensor(0.0377) train/lr 1.8546688000000005 val/loss tensor(6.5616) val/accuracy tensor(0.0207)
epoch 12 train/loss tensor(5.9707) train/accuracy tensor(0.0435) train/lr 1.7713236628099176 val/loss tensor(6.4458) val/accuracy tensor(0.0259)
epoch 13 train/loss tensor(5.9184) train/accuracy tensor(0.0477) train/lr 1.689894505785124 val/loss tensor(6.7496) val/accuracy tensor(0.0222)
epoch 14 train/loss tensor(5.8417) train/accuracy tensor(0.0542) train/lr 1.61038132892562 val/loss tensor(6.6208) val/accuracy tensor(0.0210)
epoch 15 train/loss tensor(5.7635) train/accuracy tensor(0.0620) train/lr 1.532784132231405 val/loss tensor(6.1272) val/accuracy tensor(0.0421)
epoch 16 train/loss tensor(5.6906) train/accuracy tensor(0.0692) train/lr 1.4571029157024795 val/loss tensor(6.1809) val/accuracy tensor(0.0429)
epoch 17 train/loss tensor(5.5914) train/accuracy tensor(0.0791) train/lr 1.383337679338843 val/loss tensor(5.9646) val/accuracy tensor(0.0557)
epoch 18 train/loss tensor(5.4993) train/accuracy tensor(0.0903) train/lr 1.311488423140496 val/loss tensor(6.2591) val/accuracy tensor(0.0501)
epoch 19 train/loss tensor(5.3941) train/accuracy tensor(0.1020) train/lr 1.2415551471074382 val/loss tensor(6.0142) val/accuracy tensor(0.0543)
epoch 20 train/loss tensor(5.2882) train/accuracy tensor(0.1165) train/lr 1.1735378512396695 val/loss tensor(5.9320) val/accuracy tensor(0.0724)
epoch 21 train/loss tensor(5.1773) train/accuracy tensor(0.1293) train/lr 1.10743653553719 val/loss tensor(6.0816) val/accuracy tensor(0.0697)
epoch 22 train/loss tensor(5.0647) train/accuracy tensor(0.1447) train/lr 1.0432512 val/loss tensor(5.6533) val/accuracy tensor(0.0819)
epoch 23 train/loss tensor(4.9575) train/accuracy tensor(0.1605) train/lr 0.9809818446280991 val/loss tensor(5.2793) val/accuracy tensor(0.1203)
epoch 24 train/loss tensor(4.8286) train/accuracy tensor(0.1807) train/lr 0.9206284694214879 val/loss tensor(5.4549) val/accuracy tensor(0.1099)
epoch 25 train/loss tensor(4.7236) train/accuracy tensor(0.1965) train/lr 0.8621910743801652 val/loss tensor(5.4452) val/accuracy tensor(0.1084)
epoch 26 train/loss tensor(4.6045) train/accuracy tensor(0.2157) train/lr 0.8056696595041324 val/loss tensor(5.0453) val/accuracy tensor(0.1490)
epoch 27 train/loss tensor(4.4691) train/accuracy tensor(0.2386) train/lr 0.7510642247933882 val/loss tensor(4.6967) val/accuracy tensor(0.1966)
epoch 28 train/loss tensor(4.3437) train/accuracy tensor(0.2594) train/lr 0.698374770247934 val/loss tensor(4.9455) val/accuracy tensor(0.1876)
epoch 29 train/loss tensor(4.2139) train/accuracy tensor(0.2830) train/lr 0.6476012958677687 val/loss tensor(4.9713) val/accuracy tensor(0.1773)
epoch 30 train/loss tensor(4.1040) train/accuracy tensor(0.3042) train/lr 0.5987438016528926 val/loss tensor(4.7547) val/accuracy tensor(0.2061)
epoch 31 train/loss tensor(3.9805) train/accuracy tensor(0.3273) train/lr 0.5518022876033059 val/loss tensor(4.3583) val/accuracy tensor(0.2608)
epoch 32 train/loss tensor(3.8744) train/accuracy tensor(0.3470) train/lr 0.5067767537190083 val/loss tensor(4.2862) val/accuracy tensor(0.2626)
epoch 33 train/loss tensor(3.7734) train/accuracy tensor(0.3675) train/lr 0.4636672000000001 val/loss tensor(4.0662) val/accuracy tensor(0.3125)
epoch 34 train/loss tensor(3.6810) train/accuracy tensor(0.3859) train/lr 0.422473626446281 val/loss tensor(4.0147) val/accuracy tensor(0.3226)
epoch 35 train/loss tensor(3.5933) train/accuracy tensor(0.4038) train/lr 0.38319603305785127 val/loss tensor(3.8639) val/accuracy tensor(0.3438)
epoch 36 train/loss tensor(3.5043) train/accuracy tensor(0.4220) train/lr 0.34583441983471075 val/loss tensor(3.7913) val/accuracy tensor(0.3584)
epoch 37 train/loss tensor(3.4256) train/accuracy tensor(0.4389) train/lr 0.31038878677685955 val/loss tensor(3.7732) val/accuracy tensor(0.3736)
epoch 38 train/loss tensor(3.3517) train/accuracy tensor(0.4537) train/lr 0.2768591338842975 val/loss tensor(3.4752) val/accuracy tensor(0.4231)
epoch 39 train/loss tensor(3.2768) train/accuracy tensor(0.4699) train/lr 0.24524546115702478 val/loss tensor(3.3753) val/accuracy tensor(0.4461)
epoch 40 train/loss tensor(3.2061) train/accuracy tensor(0.4852) train/lr 0.2155477685950413 val/loss tensor(3.2368) val/accuracy tensor(0.4702)
epoch 41 train/loss tensor(3.1418) train/accuracy tensor(0.4992) train/lr 0.18776605619834705 val/loss tensor(3.1987) val/accuracy tensor(0.4825)
epoch 42 train/loss tensor(3.0868) train/accuracy tensor(0.5111) train/lr 0.1619003239669421 val/loss tensor(3.1226) val/accuracy tensor(0.4936)
epoch 43 train/loss tensor(3.0295) train/accuracy tensor(0.5237) train/lr 0.1379505719008264 val/loss tensor(3.0129) val/accuracy tensor(0.5136)
epoch 44 train/loss tensor(2.9770) train/accuracy tensor(0.5358) train/lr 0.11591679999999994 val/loss tensor(2.8736) val/accuracy tensor(0.5499)
epoch 45 train/loss tensor(2.9276) train/accuracy tensor(0.5466) train/lr 0.09579900826446275 val/loss tensor(2.9055) val/accuracy tensor(0.5440)
epoch 46 train/loss tensor(2.8791) train/accuracy tensor(0.5573) train/lr 0.07759719669421493 val/loss tensor(2.7634) val/accuracy tensor(0.5772)
epoch 47 train/loss tensor(2.8386) train/accuracy tensor(0.5667) train/lr 0.061311365289256244 val/loss tensor(2.7152) val/accuracy tensor(0.5861)
epoch 48 train/loss tensor(2.8011) train/accuracy tensor(0.5756) train/lr 0.04694151404958682 val/loss tensor(2.6739) val/accuracy tensor(0.5967)
epoch 49 train/loss tensor(2.7687) train/accuracy tensor(0.5829) train/lr 0.03448764297520664 val/loss tensor(2.6024) val/accuracy tensor(0.6115)
epoch 50 train/loss tensor(2.7374) train/accuracy tensor(0.5903) train/lr 0.02394975206611572 val/loss tensor(2.5618) val/accuracy tensor(0.6199)
epoch 51 train/loss tensor(2.7113) train/accuracy tensor(0.5966) train/lr 0.015327841322314061 val/loss tensor(2.5373) val/accuracy tensor(0.6293)
epoch 52 train/loss tensor(2.6916) train/accuracy tensor(0.6016) train/lr 0.00862191074380166 val/loss tensor(2.5115) val/accuracy tensor(0.6301)
epoch 53 train/loss tensor(2.6779) train/accuracy tensor(0.6045) train/lr 0.0038319603305785152 val/loss tensor(2.4923) val/accuracy tensor(0.6360)
epoch 54 train/loss tensor(2.6701) train/accuracy tensor(0.6063) train/lr 0.0009579900826446288 val/loss tensor(2.4848) val/accuracy tensor(0.6385)
epoch 55 train/loss tensor(2.6673) train/accuracy tensor(0.6072) train/lr 0.0 val/loss tensor(2.4836) val/accuracy tensor(0.6389)

Training time: 0:22:54.313140
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.007 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001076  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.007 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001076
Launching rank 1 on remote node nid001077
Launching rank 2 on remote node nid001080
Launching rank 3 on remote node nid001081
Launching rank 4 on remote node nid001084
Launching rank 5 on remote node nid001085
Launching rank 6 on remote node nid001088
Launching rank 7 on remote node nid001089
Launching rank 8 on remote node nid001092
Launching rank 9 on remote node nid001264
Launching rank 10 on remote node nid001265
Launching rank 11 on remote node nid001268
Launching rank 12 on remote node nid001269
Launching rank 13 on remote node nid001341
Launching rank 14 on remote node nid001344
Launching rank 15 on remote node nid001345
Launching rank 16 on remote node nid001348
Launching rank 17 on remote node nid001349
Launching rank 18 on remote node nid001352
Launching rank 19 on remote node nid001353
Launching rank 20 on remote node nid001356
Launching rank 21 on remote node nid001357
Launching rank 22 on remote node nid001428
Launching rank 23 on remote node nid001429
Launching rank 24 on remote node nid001432
Launching rank 25 on remote node nid001433
Launching rank 26 on remote node nid001436
Launching rank 27 on remote node nid001437
Launching rank 28 on remote node nid001440
Launching rank 29 on remote node nid001441
Launching rank 30 on remote node nid001444
Launching rank 31 on remote node nid001452
Launching rank 32 on remote node nid001453
Launching rank 33 on remote node nid001456
Launching rank 34 on remote node nid001457
Launching rank 35 on remote node nid001460
Launching rank 36 on remote node nid001461
Launching rank 37 on remote node nid001464
Launching rank 38 on remote node nid001465
Launching rank 39 on remote node nid001468
Launching rank 40 on remote node nid001469
Launching rank 41 on remote node nid001472
Launching rank 42 on remote node nid001709
Launching rank 43 on remote node nid001712
Launching rank 44 on remote node nid001713
Launching rank 45 on remote node nid001716
Launching rank 46 on remote node nid001717
Launching rank 47 on remote node nid001720
Launching rank 48 on remote node nid001721
Launching rank 49 on remote node nid001724
Launching rank 50 on remote node nid001725
Launching rank 51 on remote node nid001728
Launching rank 52 on remote node nid001729
Launching rank 53 on remote node nid001741
Launching rank 54 on remote node nid001744
Launching rank 55 on remote node nid001745
Launching rank 56 on remote node nid001748
Launching rank 57 on remote node nid001749
Launching rank 58 on remote node nid001752
Launching rank 59 on remote node nid001753
Launching rank 60 on remote node nid001756
Launching rank 61 on remote node nid001757
Launching rank 62 on remote node nid001760
Launching rank 63 on remote node nid001761
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5808) train/accuracy tensor(0.0108) train/lr 0.5890624999999999 val/loss tensor(6.8677) val/accuracy tensor(0.0059)
epoch 2 train/loss tensor(6.0950) train/accuracy tensor(0.0316) train/lr 1.166796875 val/loss tensor(6.4037) val/accuracy tensor(0.0162)
epoch 3 train/loss tensor(5.7599) train/accuracy tensor(0.0578) train/lr 1.7445312499999999 val/loss tensor(5.8382) val/accuracy tensor(0.0475)
epoch 4 train/loss tensor(5.4971) train/accuracy tensor(0.0848) train/lr 2.322265625 val/loss tensor(5.9697) val/accuracy tensor(0.0561)
epoch 5 train/loss tensor(5.1983) train/accuracy tensor(0.1206) train/lr 2.586728395061728 val/loss tensor(5.5967) val/accuracy tensor(0.0979)
epoch 6 train/loss tensor(4.8695) train/accuracy tensor(0.1661) train/lr 2.526222222222222 val/loss tensor(4.9518) val/accuracy tensor(0.1478)
epoch 7 train/loss tensor(4.5847) train/accuracy tensor(0.2102) train/lr 2.4664320987654325 val/loss tensor(5.0606) val/accuracy tensor(0.1467)
epoch 8 train/loss tensor(4.3445) train/accuracy tensor(0.2511) train/lr 2.4073580246913577 val/loss tensor(4.8535) val/accuracy tensor(0.1762)
epoch 9 train/loss tensor(4.1336) train/accuracy tensor(0.2886) train/lr 2.349 val/loss tensor(4.6422) val/accuracy tensor(0.2136)
epoch 10 train/loss tensor(3.9661) train/accuracy tensor(0.3199) train/lr 2.2913580246913576 val/loss tensor(4.2911) val/accuracy tensor(0.2660)
epoch 11 train/loss tensor(3.8285) train/accuracy tensor(0.3468) train/lr 2.2344320987654323 val/loss tensor(4.0150) val/accuracy tensor(0.2999)
epoch 12 train/loss tensor(3.6847) train/accuracy tensor(0.3754) train/lr 2.1782222222222223 val/loss tensor(4.0111) val/accuracy tensor(0.3182)
epoch 13 train/loss tensor(3.5893) train/accuracy tensor(0.3939) train/lr 2.1227283950617286 val/loss tensor(4.0571) val/accuracy tensor(0.3295)
epoch 14 train/loss tensor(3.4984) train/accuracy tensor(0.4132) train/lr 2.0679506172839504 val/loss tensor(4.1410) val/accuracy tensor(0.2909)
epoch 15 train/loss tensor(3.4147) train/accuracy tensor(0.4311) train/lr 2.0138888888888893 val/loss tensor(4.3340) val/accuracy tensor(0.2851)
epoch 16 train/loss tensor(3.3523) train/accuracy tensor(0.4442) train/lr 1.960543209876543 val/loss tensor(3.7392) val/accuracy tensor(0.3667)
epoch 17 train/loss tensor(3.2815) train/accuracy tensor(0.4595) train/lr 1.9079135802469136 val/loss tensor(3.5768) val/accuracy tensor(0.3918)
epoch 18 train/loss tensor(3.2236) train/accuracy tensor(0.4715) train/lr 1.8560000000000003 val/loss tensor(3.5420) val/accuracy tensor(0.4010)
epoch 19 train/loss tensor(3.1758) train/accuracy tensor(0.4820) train/lr 1.8048024691358022 val/loss tensor(3.8235) val/accuracy tensor(0.3501)
epoch 20 train/loss tensor(3.1309) train/accuracy tensor(0.4922) train/lr 1.754320987654321 val/loss tensor(3.5113) val/accuracy tensor(0.4005)
epoch 21 train/loss tensor(3.0824) train/accuracy tensor(0.5031) train/lr 1.7045555555555554 val/loss tensor(3.5538) val/accuracy tensor(0.3947)
epoch 22 train/loss tensor(3.0382) train/accuracy tensor(0.5132) train/lr 1.655506172839506 val/loss tensor(3.3113) val/accuracy tensor(0.4405)
epoch 23 train/loss tensor(2.9930) train/accuracy tensor(0.5229) train/lr 1.6071728395061728 val/loss tensor(3.3575) val/accuracy tensor(0.4281)
epoch 24 train/loss tensor(2.9643) train/accuracy tensor(0.5295) train/lr 1.5595555555555558 val/loss tensor(3.2885) val/accuracy tensor(0.4422)
epoch 25 train/loss tensor(2.9261) train/accuracy tensor(0.5386) train/lr 1.5126543209876542 val/loss tensor(3.2019) val/accuracy tensor(0.4694)
epoch 26 train/loss tensor(2.8940) train/accuracy tensor(0.5450) train/lr 1.466469135802469 val/loss tensor(3.2188) val/accuracy tensor(0.4689)
epoch 27 train/loss tensor(2.8629) train/accuracy tensor(0.5530) train/lr 1.4209999999999998 val/loss tensor(3.2310) val/accuracy tensor(0.4584)
epoch 28 train/loss tensor(2.8296) train/accuracy tensor(0.5610) train/lr 1.3762469135802469 val/loss tensor(3.2818) val/accuracy tensor(0.4612)
epoch 29 train/loss tensor(2.8042) train/accuracy tensor(0.5666) train/lr 1.33220987654321 val/loss tensor(3.2397) val/accuracy tensor(0.4663)
epoch 30 train/loss tensor(2.7738) train/accuracy tensor(0.5738) train/lr 1.2888888888888892 val/loss tensor(3.1934) val/accuracy tensor(0.4651)
epoch 31 train/loss tensor(2.7501) train/accuracy tensor(0.5784) train/lr 1.2462839506172838 val/loss tensor(2.9274) val/accuracy tensor(0.5336)
epoch 32 train/loss tensor(2.7242) train/accuracy tensor(0.5855) train/lr 1.2043950617283947 val/loss tensor(2.9949) val/accuracy tensor(0.5086)
epoch 33 train/loss tensor(2.6993) train/accuracy tensor(0.5910) train/lr 1.1632222222222222 val/loss tensor(2.8241) val/accuracy tensor(0.5473)
epoch 34 train/loss tensor(2.6743) train/accuracy tensor(0.5965) train/lr 1.1227654320987654 val/loss tensor(2.9380) val/accuracy tensor(0.5236)
epoch 35 train/loss tensor(2.6524) train/accuracy tensor(0.6016) train/lr 1.0830246913580248 val/loss tensor(2.8550) val/accuracy tensor(0.5555)
epoch 36 train/loss tensor(2.6310) train/accuracy tensor(0.6071) train/lr 1.044 val/loss tensor(2.9643) val/accuracy tensor(0.5208)
epoch 37 train/loss tensor(2.6067) train/accuracy tensor(0.6126) train/lr 1.0056913580246916 val/loss tensor(2.8428) val/accuracy tensor(0.5547)
epoch 38 train/loss tensor(2.5850) train/accuracy tensor(0.6181) train/lr 0.9680987654320986 val/loss tensor(2.7840) val/accuracy tensor(0.5597)
epoch 39 train/loss tensor(2.5652) train/accuracy tensor(0.6227) train/lr 0.9312222222222221 val/loss tensor(2.7163) val/accuracy tensor(0.5747)
epoch 40 train/loss tensor(2.5453) train/accuracy tensor(0.6272) train/lr 0.8950617283950618 val/loss tensor(2.6860) val/accuracy tensor(0.5816)
epoch 41 train/loss tensor(2.5255) train/accuracy tensor(0.6322) train/lr 0.8596172839506174 val/loss tensor(2.7211) val/accuracy tensor(0.5775)
epoch 42 train/loss tensor(2.5048) train/accuracy tensor(0.6368) train/lr 0.8248888888888889 val/loss tensor(2.6650) val/accuracy tensor(0.5834)
epoch 43 train/loss tensor(2.4873) train/accuracy tensor(0.6408) train/lr 0.7908765432098763 val/loss tensor(2.6046) val/accuracy tensor(0.6016)
epoch 44 train/loss tensor(2.4688) train/accuracy tensor(0.6453) train/lr 0.7575802469135801 val/loss tensor(2.6035) val/accuracy tensor(0.6057)
epoch 45 train/loss tensor(2.4524) train/accuracy tensor(0.6496) train/lr 0.725 val/loss tensor(2.7017) val/accuracy tensor(0.5776)
epoch 46 train/loss tensor(2.4308) train/accuracy tensor(0.6547) train/lr 0.6931358024691359 val/loss tensor(2.5521) val/accuracy tensor(0.6187)
epoch 47 train/loss tensor(2.4122) train/accuracy tensor(0.6591) train/lr 0.6619876543209875 val/loss tensor(2.5008) val/accuracy tensor(0.6269)
epoch 48 train/loss tensor(2.3924) train/accuracy tensor(0.6647) train/lr 0.6315555555555555 val/loss tensor(2.5565) val/accuracy tensor(0.6192)
epoch 49 train/loss tensor(2.3773) train/accuracy tensor(0.6672) train/lr 0.6018395061728397 val/loss tensor(2.4803) val/accuracy tensor(0.6349)
epoch 50 train/loss tensor(2.3604) train/accuracy tensor(0.6722) train/lr 0.5728395061728394 val/loss tensor(2.5369) val/accuracy tensor(0.6143)
epoch 51 train/loss tensor(2.3434) train/accuracy tensor(0.6770) train/lr 0.5445555555555556 val/loss tensor(2.4515) val/accuracy tensor(0.6407)
epoch 52 train/loss tensor(2.3249) train/accuracy tensor(0.6807) train/lr 0.5169876543209878 val/loss tensor(2.4381) val/accuracy tensor(0.6405)
epoch 53 train/loss tensor(2.3122) train/accuracy tensor(0.6842) train/lr 0.49013580246913574 val/loss tensor(2.3801) val/accuracy tensor(0.6598)
epoch 54 train/loss tensor(2.2977) train/accuracy tensor(0.6874) train/lr 0.4640000000000001 val/loss tensor(2.3948) val/accuracy tensor(0.6516)
epoch 55 train/loss tensor(2.2804) train/accuracy tensor(0.6922) train/lr 0.4385802469135801 val/loss tensor(2.3395) val/accuracy tensor(0.6648)
epoch 56 train/loss tensor(2.2613) train/accuracy tensor(0.6970) train/lr 0.4138765432098765 val/loss tensor(2.3443) val/accuracy tensor(0.6705)
epoch 57 train/loss tensor(2.2488) train/accuracy tensor(0.7000) train/lr 0.38988888888888895 val/loss tensor(2.3222) val/accuracy tensor(0.6729)
epoch 58 train/loss tensor(2.2338) train/accuracy tensor(0.7039) train/lr 0.3666172839506172 val/loss tensor(2.3224) val/accuracy tensor(0.6690)
epoch 59 train/loss tensor(2.2182) train/accuracy tensor(0.7074) train/lr 0.3440617283950617 val/loss tensor(2.2918) val/accuracy tensor(0.6766)
epoch 60 train/loss tensor(2.2041) train/accuracy tensor(0.7110) train/lr 0.3222222222222223 val/loss tensor(2.2640) val/accuracy tensor(0.6850)
epoch 61 train/loss tensor(2.1903) train/accuracy tensor(0.7149) train/lr 0.3010987654320987 val/loss tensor(2.2605) val/accuracy tensor(0.6868)
epoch 62 train/loss tensor(2.1742) train/accuracy tensor(0.7189) train/lr 0.28069135802469136 val/loss tensor(2.2014) val/accuracy tensor(0.7000)
epoch 63 train/loss tensor(2.1614) train/accuracy tensor(0.7223) train/lr 0.26100000000000007 val/loss tensor(2.2435) val/accuracy tensor(0.6935)
epoch 64 train/loss tensor(2.1484) train/accuracy tensor(0.7256) train/lr 0.24202469135802465 val/loss tensor(2.1810) val/accuracy tensor(0.7053)
epoch 65 train/loss tensor(2.1368) train/accuracy tensor(0.7288) train/lr 0.22376543209876545 val/loss tensor(2.2203) val/accuracy tensor(0.6956)
epoch 66 train/loss tensor(2.1248) train/accuracy tensor(0.7317) train/lr 0.2062222222222223 val/loss tensor(2.1790) val/accuracy tensor(0.7066)
epoch 67 train/loss tensor(2.1116) train/accuracy tensor(0.7353) train/lr 0.18939506172839501 val/loss tensor(2.1455) val/accuracy tensor(0.7142)
epoch 68 train/loss tensor(2.1005) train/accuracy tensor(0.7381) train/lr 0.17328395061728397 val/loss tensor(2.1511) val/accuracy tensor(0.7149)
epoch 69 train/loss tensor(2.0881) train/accuracy tensor(0.7419) train/lr 0.1578888888888888 val/loss tensor(2.1237) val/accuracy tensor(0.7171)
epoch 70 train/loss tensor(2.0758) train/accuracy tensor(0.7443) train/lr 0.14320987654320985 val/loss tensor(2.1084) val/accuracy tensor(0.7232)
epoch 71 train/loss tensor(2.0665) train/accuracy tensor(0.7471) train/lr 0.12924691358024695 val/loss tensor(2.1206) val/accuracy tensor(0.7218)
epoch 72 train/loss tensor(2.0576) train/accuracy tensor(0.7498) train/lr 0.11599999999999994 val/loss tensor(2.0923) val/accuracy tensor(0.7243)
epoch 73 train/loss tensor(2.0472) train/accuracy tensor(0.7525) train/lr 0.10346913580246912 val/loss tensor(2.0790) val/accuracy tensor(0.7299)
epoch 74 train/loss tensor(2.0361) train/accuracy tensor(0.7557) train/lr 0.09165432098765436 val/loss tensor(2.0772) val/accuracy tensor(0.7299)
epoch 75 train/loss tensor(2.0290) train/accuracy tensor(0.7575) train/lr 0.08055555555555552 val/loss tensor(2.0730) val/accuracy tensor(0.7324)
epoch 76 train/loss tensor(2.0203) train/accuracy tensor(0.7596) train/lr 0.07017283950617284 val/loss tensor(2.0668) val/accuracy tensor(0.7357)
epoch 77 train/loss tensor(2.0124) train/accuracy tensor(0.7615) train/lr 0.06050617283950621 val/loss tensor(2.0574) val/accuracy tensor(0.7365)
epoch 78 train/loss tensor(2.0043) train/accuracy tensor(0.7639) train/lr 0.051555555555555535 val/loss tensor(2.0547) val/accuracy tensor(0.7375)
epoch 79 train/loss tensor(1.9988) train/accuracy tensor(0.7658) train/lr 0.04332098765432099 val/loss tensor(2.0443) val/accuracy tensor(0.7395)
epoch 80 train/loss tensor(1.9950) train/accuracy tensor(0.7665) train/lr 0.035802469135802505 val/loss tensor(2.0384) val/accuracy tensor(0.7408)
epoch 81 train/loss tensor(1.9872) train/accuracy tensor(0.7687) train/lr 0.028999999999999984 val/loss tensor(2.0397) val/accuracy tensor(0.7415)
epoch 82 train/loss tensor(1.9832) train/accuracy tensor(0.7700) train/lr 0.02291358024691359 val/loss tensor(2.0398) val/accuracy tensor(0.7434)
epoch 83 train/loss tensor(1.9790) train/accuracy tensor(0.7710) train/lr 0.017543209876543186 val/loss tensor(2.0303) val/accuracy tensor(0.7451)
epoch 84 train/loss tensor(1.9757) train/accuracy tensor(0.7719) train/lr 0.012888888888888884 val/loss tensor(2.0286) val/accuracy tensor(0.7441)
epoch 85 train/loss tensor(1.9726) train/accuracy tensor(0.7728) train/lr 0.008950617283950626 val/loss tensor(2.0297) val/accuracy tensor(0.7446)
epoch 86 train/loss tensor(1.9696) train/accuracy tensor(0.7740) train/lr 0.005728395061728383 val/loss tensor(2.0250) val/accuracy tensor(0.7451)
epoch 87 train/loss tensor(1.9680) train/accuracy tensor(0.7746) train/lr 0.003222222222222221 val/loss tensor(2.0273) val/accuracy tensor(0.7445)
epoch 88 train/loss tensor(1.9674) train/accuracy tensor(0.7746) train/lr 0.0014320987654321028 val/loss tensor(2.0238) val/accuracy tensor(0.7464)
epoch 89 train/loss tensor(1.9670) train/accuracy tensor(0.7745) train/lr 0.0003580246913580222 val/loss tensor(2.0256) val/accuracy tensor(0.7449)
epoch 90 train/loss tensor(1.9645) train/accuracy tensor(0.7756) train/lr 0.0 val/loss tensor(2.0236) val/accuracy tensor(0.7454)

Training time: 0:48:45.619944
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.008 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001076  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.008 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001076
Launching rank 1 on remote node nid001077
Launching rank 2 on remote node nid001080
Launching rank 3 on remote node nid001081
Launching rank 4 on remote node nid001084
Launching rank 5 on remote node nid001085
Launching rank 6 on remote node nid001088
Launching rank 7 on remote node nid001089
Launching rank 8 on remote node nid001092
Launching rank 9 on remote node nid001264
Launching rank 10 on remote node nid001265
Launching rank 11 on remote node nid001268
Launching rank 12 on remote node nid001269
Launching rank 13 on remote node nid001341
Launching rank 14 on remote node nid001344
Launching rank 15 on remote node nid001345
Launching rank 16 on remote node nid001348
Launching rank 17 on remote node nid001349
Launching rank 18 on remote node nid001352
Launching rank 19 on remote node nid001353
Launching rank 20 on remote node nid001356
Launching rank 21 on remote node nid001357
Launching rank 22 on remote node nid001428
Launching rank 23 on remote node nid001429
Launching rank 24 on remote node nid001432
Launching rank 25 on remote node nid001433
Launching rank 26 on remote node nid001436
Launching rank 27 on remote node nid001437
Launching rank 28 on remote node nid001440
Launching rank 29 on remote node nid001441
Launching rank 30 on remote node nid001444
Launching rank 31 on remote node nid001452
Launching rank 32 on remote node nid001453
Launching rank 33 on remote node nid001456
Launching rank 34 on remote node nid001457
Launching rank 35 on remote node nid001460
Launching rank 36 on remote node nid001461
Launching rank 37 on remote node nid001464
Launching rank 38 on remote node nid001465
Launching rank 39 on remote node nid001468
Launching rank 40 on remote node nid001469
Launching rank 41 on remote node nid001472
Launching rank 42 on remote node nid001709
Launching rank 43 on remote node nid001712
Launching rank 44 on remote node nid001713
Launching rank 45 on remote node nid001716
Launching rank 46 on remote node nid001717
Launching rank 47 on remote node nid001720
Launching rank 48 on remote node nid001721
Launching rank 49 on remote node nid001724
Launching rank 50 on remote node nid001725
Launching rank 51 on remote node nid001728
Launching rank 52 on remote node nid001729
Launching rank 53 on remote node nid001741
Launching rank 54 on remote node nid001744
Launching rank 55 on remote node nid001745
Launching rank 56 on remote node nid001748
Launching rank 57 on remote node nid001749
Launching rank 58 on remote node nid001752
Launching rank 59 on remote node nid001753
Launching rank 60 on remote node nid001756
Launching rank 61 on remote node nid001757
Launching rank 62 on remote node nid001760
Launching rank 63 on remote node nid001761
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5711) train/accuracy tensor(0.0112) train/lr 0.5890624999999999 val/loss tensor(6.9491) val/accuracy tensor(0.0043)
epoch 2 train/loss tensor(6.1200) train/accuracy tensor(0.0304) train/lr 1.166796875 val/loss tensor(6.2272) val/accuracy tensor(0.0214)
epoch 3 train/loss tensor(5.7724) train/accuracy tensor(0.0570) train/lr 1.7445312499999999 val/loss tensor(5.9419) val/accuracy tensor(0.0450)
epoch 4 train/loss tensor(5.5043) train/accuracy tensor(0.0840) train/lr 2.322265625 val/loss tensor(6.2405) val/accuracy tensor(0.0534)
epoch 5 train/loss tensor(5.2378) train/accuracy tensor(0.1166) train/lr 2.586728395061728 val/loss tensor(5.5138) val/accuracy tensor(0.0930)
epoch 6 train/loss tensor(4.9186) train/accuracy tensor(0.1591) train/lr 2.526222222222222 val/loss tensor(5.1001) val/accuracy tensor(0.1383)
epoch 7 train/loss tensor(4.6436) train/accuracy tensor(0.2009) train/lr 2.4664320987654325 val/loss tensor(4.9179) val/accuracy tensor(0.1702)
epoch 8 train/loss tensor(4.4213) train/accuracy tensor(0.2385) train/lr 2.4073580246913577 val/loss tensor(5.1800) val/accuracy tensor(0.1525)
epoch 9 train/loss tensor(4.2362) train/accuracy tensor(0.2700) train/lr 2.349 val/loss tensor(4.5014) val/accuracy tensor(0.2169)
epoch 10 train/loss tensor(4.0711) train/accuracy tensor(0.3002) train/lr 2.2913580246913576 val/loss tensor(4.4196) val/accuracy tensor(0.2402)
epoch 11 train/loss tensor(3.9262) train/accuracy tensor(0.3276) train/lr 2.2344320987654323 val/loss tensor(4.2419) val/accuracy tensor(0.2682)
epoch 12 train/loss tensor(3.7994) train/accuracy tensor(0.3530) train/lr 2.1782222222222223 val/loss tensor(4.0449) val/accuracy tensor(0.3030)
epoch 13 train/loss tensor(3.7018) train/accuracy tensor(0.3722) train/lr 2.1227283950617286 val/loss tensor(4.0855) val/accuracy tensor(0.3202)
epoch 14 train/loss tensor(3.6019) train/accuracy tensor(0.3922) train/lr 2.0679506172839504 val/loss tensor(4.4332) val/accuracy tensor(0.2380)
epoch 15 train/loss tensor(3.5245) train/accuracy tensor(0.4087) train/lr 2.0138888888888893 val/loss tensor(3.8643) val/accuracy tensor(0.3343)
epoch 16 train/loss tensor(3.4464) train/accuracy tensor(0.4252) train/lr 1.960543209876543 val/loss tensor(3.9601) val/accuracy tensor(0.3165)
epoch 17 train/loss tensor(3.3810) train/accuracy tensor(0.4386) train/lr 1.9079135802469136 val/loss tensor(3.6596) val/accuracy tensor(0.3708)
epoch 18 train/loss tensor(3.3163) train/accuracy tensor(0.4535) train/lr 1.8560000000000003 val/loss tensor(3.7291) val/accuracy tensor(0.3684)
epoch 19 train/loss tensor(3.2627) train/accuracy tensor(0.4636) train/lr 1.8048024691358022 val/loss tensor(3.7028) val/accuracy tensor(0.3716)
epoch 20 train/loss tensor(3.2210) train/accuracy tensor(0.4732) train/lr 1.754320987654321 val/loss tensor(3.6599) val/accuracy tensor(0.3866)
epoch 21 train/loss tensor(3.1710) train/accuracy tensor(0.4841) train/lr 1.7045555555555554 val/loss tensor(3.7092) val/accuracy tensor(0.3790)
epoch 22 train/loss tensor(3.1243) train/accuracy tensor(0.4942) train/lr 1.655506172839506 val/loss tensor(3.4972) val/accuracy tensor(0.4065)
epoch 23 train/loss tensor(3.0766) train/accuracy tensor(0.5052) train/lr 1.6071728395061728 val/loss tensor(3.4200) val/accuracy tensor(0.4227)
epoch 24 train/loss tensor(3.0379) train/accuracy tensor(0.5134) train/lr 1.5595555555555558 val/loss tensor(3.4271) val/accuracy tensor(0.4227)
epoch 25 train/loss tensor(2.9999) train/accuracy tensor(0.5223) train/lr 1.5126543209876542 val/loss tensor(3.5537) val/accuracy tensor(0.4090)
epoch 26 train/loss tensor(2.9633) train/accuracy tensor(0.5303) train/lr 1.466469135802469 val/loss tensor(3.2905) val/accuracy tensor(0.4444)
epoch 27 train/loss tensor(2.9342) train/accuracy tensor(0.5369) train/lr 1.4209999999999998 val/loss tensor(3.3031) val/accuracy tensor(0.4450)
epoch 28 train/loss tensor(2.9010) train/accuracy tensor(0.5442) train/lr 1.3762469135802469 val/loss tensor(3.2557) val/accuracy tensor(0.4551)
epoch 29 train/loss tensor(2.8695) train/accuracy tensor(0.5516) train/lr 1.33220987654321 val/loss tensor(3.4479) val/accuracy tensor(0.4226)
epoch 30 train/loss tensor(2.8376) train/accuracy tensor(0.5593) train/lr 1.2888888888888892 val/loss tensor(3.1879) val/accuracy tensor(0.4693)
epoch 31 train/loss tensor(2.8106) train/accuracy tensor(0.5658) train/lr 1.2462839506172838 val/loss tensor(3.1513) val/accuracy tensor(0.4856)
epoch 32 train/loss tensor(2.7877) train/accuracy tensor(0.5711) train/lr 1.2043950617283947 val/loss tensor(3.2014) val/accuracy tensor(0.4659)
epoch 33 train/loss tensor(2.7528) train/accuracy tensor(0.5792) train/lr 1.1632222222222222 val/loss tensor(2.9841) val/accuracy tensor(0.5102)
epoch 34 train/loss tensor(2.7299) train/accuracy tensor(0.5841) train/lr 1.1227654320987654 val/loss tensor(2.9520) val/accuracy tensor(0.5279)
epoch 35 train/loss tensor(2.7093) train/accuracy tensor(0.5890) train/lr 1.0830246913580248 val/loss tensor(2.9316) val/accuracy tensor(0.5256)
epoch 36 train/loss tensor(2.6819) train/accuracy tensor(0.5961) train/lr 1.044 val/loss tensor(3.0595) val/accuracy tensor(0.5085)
epoch 37 train/loss tensor(2.6594) train/accuracy tensor(0.6013) train/lr 1.0056913580246916 val/loss tensor(2.9007) val/accuracy tensor(0.5308)
epoch 38 train/loss tensor(2.6399) train/accuracy tensor(0.6053) train/lr 0.9680987654320986 val/loss tensor(2.8226) val/accuracy tensor(0.5499)
epoch 39 train/loss tensor(2.6171) train/accuracy tensor(0.6111) train/lr 0.9312222222222221 val/loss tensor(2.7415) val/accuracy tensor(0.5685)
epoch 40 train/loss tensor(2.5927) train/accuracy tensor(0.6165) train/lr 0.8950617283950618 val/loss tensor(2.7599) val/accuracy tensor(0.5686)
epoch 41 train/loss tensor(2.5712) train/accuracy tensor(0.6218) train/lr 0.8596172839506174 val/loss tensor(2.8443) val/accuracy tensor(0.5483)
epoch 42 train/loss tensor(2.5530) train/accuracy tensor(0.6262) train/lr 0.8248888888888889 val/loss tensor(2.7461) val/accuracy tensor(0.5718)
epoch 43 train/loss tensor(2.5267) train/accuracy tensor(0.6324) train/lr 0.7908765432098763 val/loss tensor(2.7911) val/accuracy tensor(0.5554)
epoch 44 train/loss tensor(2.5099) train/accuracy tensor(0.6368) train/lr 0.7575802469135801 val/loss tensor(2.6429) val/accuracy tensor(0.5932)
epoch 45 train/loss tensor(2.4914) train/accuracy tensor(0.6411) train/lr 0.725 val/loss tensor(2.7045) val/accuracy tensor(0.5838)
epoch 46 train/loss tensor(2.4709) train/accuracy tensor(0.6459) train/lr 0.6931358024691359 val/loss tensor(2.5939) val/accuracy tensor(0.6087)
epoch 47 train/loss tensor(2.4522) train/accuracy tensor(0.6510) train/lr 0.6619876543209875 val/loss tensor(2.6263) val/accuracy tensor(0.5954)
epoch 48 train/loss tensor(2.4335) train/accuracy tensor(0.6546) train/lr 0.6315555555555555 val/loss tensor(2.5863) val/accuracy tensor(0.6104)
epoch 49 train/loss tensor(2.4156) train/accuracy tensor(0.6589) train/lr 0.6018395061728397 val/loss tensor(2.4777) val/accuracy tensor(0.6349)
epoch 50 train/loss tensor(2.3985) train/accuracy tensor(0.6637) train/lr 0.5728395061728394 val/loss tensor(2.5170) val/accuracy tensor(0.6213)
epoch 51 train/loss tensor(2.3774) train/accuracy tensor(0.6691) train/lr 0.5445555555555556 val/loss tensor(2.4798) val/accuracy tensor(0.6346)
epoch 52 train/loss tensor(2.3607) train/accuracy tensor(0.6724) train/lr 0.5169876543209878 val/loss tensor(2.4432) val/accuracy tensor(0.6483)
epoch 53 train/loss tensor(2.3448) train/accuracy tensor(0.6762) train/lr 0.49013580246913574 val/loss tensor(2.4449) val/accuracy tensor(0.6425)
epoch 54 train/loss tensor(2.3278) train/accuracy tensor(0.6810) train/lr 0.4640000000000001 val/loss tensor(2.4140) val/accuracy tensor(0.6497)
epoch 55 train/loss tensor(2.3054) train/accuracy tensor(0.6862) train/lr 0.4385802469135801 val/loss tensor(2.3955) val/accuracy tensor(0.6502)
epoch 56 train/loss tensor(2.2937) train/accuracy tensor(0.6893) train/lr 0.4138765432098765 val/loss tensor(2.3814) val/accuracy tensor(0.6566)
epoch 57 train/loss tensor(2.2774) train/accuracy tensor(0.6946) train/lr 0.38988888888888895 val/loss tensor(2.3282) val/accuracy tensor(0.6721)
epoch 58 train/loss tensor(2.2604) train/accuracy tensor(0.6979) train/lr 0.3666172839506172 val/loss tensor(2.3985) val/accuracy tensor(0.6522)
epoch 59 train/loss tensor(2.2446) train/accuracy tensor(0.7017) train/lr 0.3440617283950617 val/loss tensor(2.3432) val/accuracy tensor(0.6760)
epoch 60 train/loss tensor(2.2297) train/accuracy tensor(0.7056) train/lr 0.3222222222222223 val/loss tensor(2.3202) val/accuracy tensor(0.6722)
epoch 61 train/loss tensor(2.2128) train/accuracy tensor(0.7097) train/lr 0.3010987654320987 val/loss tensor(2.2767) val/accuracy tensor(0.6818)
epoch 62 train/loss tensor(2.1995) train/accuracy tensor(0.7134) train/lr 0.28069135802469136 val/loss tensor(2.2487) val/accuracy tensor(0.6892)
epoch 63 train/loss tensor(2.1842) train/accuracy tensor(0.7174) train/lr 0.26100000000000007 val/loss tensor(2.2316) val/accuracy tensor(0.6933)
epoch 64 train/loss tensor(2.1697) train/accuracy tensor(0.7214) train/lr 0.24202469135802465 val/loss tensor(2.2224) val/accuracy tensor(0.6936)
epoch 65 train/loss tensor(2.1552) train/accuracy tensor(0.7245) train/lr 0.22376543209876545 val/loss tensor(2.2068) val/accuracy tensor(0.6998)
epoch 66 train/loss tensor(2.1421) train/accuracy tensor(0.7281) train/lr 0.2062222222222223 val/loss tensor(2.2106) val/accuracy tensor(0.7008)
epoch 67 train/loss tensor(2.1291) train/accuracy tensor(0.7310) train/lr 0.18939506172839501 val/loss tensor(2.1659) val/accuracy tensor(0.7085)
epoch 68 train/loss tensor(2.1154) train/accuracy tensor(0.7350) train/lr 0.17328395061728397 val/loss tensor(2.1583) val/accuracy tensor(0.7103)
epoch 69 train/loss tensor(2.1023) train/accuracy tensor(0.7382) train/lr 0.1578888888888888 val/loss tensor(2.1408) val/accuracy tensor(0.7138)
epoch 70 train/loss tensor(2.0905) train/accuracy tensor(0.7412) train/lr 0.14320987654320985 val/loss tensor(2.1315) val/accuracy tensor(0.7183)
epoch 71 train/loss tensor(2.0794) train/accuracy tensor(0.7446) train/lr 0.12924691358024695 val/loss tensor(2.1199) val/accuracy tensor(0.7225)
epoch 72 train/loss tensor(2.0684) train/accuracy tensor(0.7475) train/lr 0.11599999999999994 val/loss tensor(2.1063) val/accuracy tensor(0.7254)
epoch 73 train/loss tensor(2.0556) train/accuracy tensor(0.7504) train/lr 0.10346913580246912 val/loss tensor(2.0892) val/accuracy tensor(0.7273)
epoch 74 train/loss tensor(2.0461) train/accuracy tensor(0.7532) train/lr 0.09165432098765436 val/loss tensor(2.0856) val/accuracy tensor(0.7296)
epoch 75 train/loss tensor(2.0379) train/accuracy tensor(0.7556) train/lr 0.08055555555555552 val/loss tensor(2.0766) val/accuracy tensor(0.7320)
epoch 76 train/loss tensor(2.0293) train/accuracy tensor(0.7580) train/lr 0.07017283950617284 val/loss tensor(2.0620) val/accuracy tensor(0.7335)
epoch 77 train/loss tensor(2.0220) train/accuracy tensor(0.7602) train/lr 0.06050617283950621 val/loss tensor(2.0615) val/accuracy tensor(0.7335)
epoch 78 train/loss tensor(2.0129) train/accuracy tensor(0.7624) train/lr 0.051555555555555535 val/loss tensor(2.0519) val/accuracy tensor(0.7382)
epoch 79 train/loss tensor(2.0045) train/accuracy tensor(0.7645) train/lr 0.04332098765432099 val/loss tensor(2.0442) val/accuracy tensor(0.7391)
epoch 80 train/loss tensor(1.9972) train/accuracy tensor(0.7670) train/lr 0.035802469135802505 val/loss tensor(2.0442) val/accuracy tensor(0.7380)
epoch 81 train/loss tensor(1.9920) train/accuracy tensor(0.7679) train/lr 0.028999999999999984 val/loss tensor(2.0353) val/accuracy tensor(0.7416)
epoch 82 train/loss tensor(1.9886) train/accuracy tensor(0.7691) train/lr 0.02291358024691359 val/loss tensor(2.0309) val/accuracy tensor(0.7429)
epoch 83 train/loss tensor(1.9816) train/accuracy tensor(0.7709) train/lr 0.017543209876543186 val/loss tensor(2.0279) val/accuracy tensor(0.7437)
epoch 84 train/loss tensor(1.9788) train/accuracy tensor(0.7717) train/lr 0.012888888888888884 val/loss tensor(2.0264) val/accuracy tensor(0.7430)
epoch 85 train/loss tensor(1.9745) train/accuracy tensor(0.7730) train/lr 0.008950617283950626 val/loss tensor(2.0271) val/accuracy tensor(0.7443)
epoch 86 train/loss tensor(1.9705) train/accuracy tensor(0.7740) train/lr 0.005728395061728383 val/loss tensor(2.0208) val/accuracy tensor(0.7457)
epoch 87 train/loss tensor(1.9715) train/accuracy tensor(0.7742) train/lr 0.003222222222222221 val/loss tensor(2.0206) val/accuracy tensor(0.7460)
epoch 88 train/loss tensor(1.9709) train/accuracy tensor(0.7744) train/lr 0.0014320987654321028 val/loss tensor(2.0188) val/accuracy tensor(0.7464)
epoch 89 train/loss tensor(1.9677) train/accuracy tensor(0.7747) train/lr 0.0003580246913580222 val/loss tensor(2.0201) val/accuracy tensor(0.7451)
epoch 90 train/loss tensor(1.9676) train/accuracy tensor(0.7747) train/lr 0.0 val/loss tensor(2.0197) val/accuracy tensor(0.7468)

Training time: 0:45:04.708582
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.009 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001076  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.009 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001076
Launching rank 1 on remote node nid001077
Launching rank 2 on remote node nid001080
Launching rank 3 on remote node nid001081
Launching rank 4 on remote node nid001084
Launching rank 5 on remote node nid001085
Launching rank 6 on remote node nid001088
Launching rank 7 on remote node nid001089
Launching rank 8 on remote node nid001092
Launching rank 9 on remote node nid001264
Launching rank 10 on remote node nid001265
Launching rank 11 on remote node nid001268
Launching rank 12 on remote node nid001269
Launching rank 13 on remote node nid001341
Launching rank 14 on remote node nid001344
Launching rank 15 on remote node nid001345
Launching rank 16 on remote node nid001348
Launching rank 17 on remote node nid001349
Launching rank 18 on remote node nid001352
Launching rank 19 on remote node nid001353
Launching rank 20 on remote node nid001356
Launching rank 21 on remote node nid001357
Launching rank 22 on remote node nid001428
Launching rank 23 on remote node nid001429
Launching rank 24 on remote node nid001432
Launching rank 25 on remote node nid001433
Launching rank 26 on remote node nid001436
Launching rank 27 on remote node nid001437
Launching rank 28 on remote node nid001440
Launching rank 29 on remote node nid001441
Launching rank 30 on remote node nid001444
Launching rank 31 on remote node nid001452
Launching rank 32 on remote node nid001453
Launching rank 33 on remote node nid001456
Launching rank 34 on remote node nid001457
Launching rank 35 on remote node nid001460
Launching rank 36 on remote node nid001461
Launching rank 37 on remote node nid001464
Launching rank 38 on remote node nid001465
Launching rank 39 on remote node nid001468
Launching rank 40 on remote node nid001469
Launching rank 41 on remote node nid001472
Launching rank 42 on remote node nid001709
Launching rank 43 on remote node nid001712
Launching rank 44 on remote node nid001713
Launching rank 45 on remote node nid001716
Launching rank 46 on remote node nid001717
Launching rank 47 on remote node nid001720
Launching rank 48 on remote node nid001721
Launching rank 49 on remote node nid001724
Launching rank 50 on remote node nid001725
Launching rank 51 on remote node nid001728
Launching rank 52 on remote node nid001729
Launching rank 53 on remote node nid001741
Launching rank 54 on remote node nid001744
Launching rank 55 on remote node nid001745
Launching rank 56 on remote node nid001748
Launching rank 57 on remote node nid001749
Launching rank 58 on remote node nid001752
Launching rank 59 on remote node nid001753
Launching rank 60 on remote node nid001756
Launching rank 61 on remote node nid001757
Launching rank 62 on remote node nid001760
Launching rank 63 on remote node nid001761
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5953) train/accuracy tensor(0.0102) train/lr 0.5890624999999999 val/loss tensor(6.6836) val/accuracy tensor(0.0061)
epoch 2 train/loss tensor(6.1740) train/accuracy tensor(0.0276) train/lr 1.166796875 val/loss tensor(6.8587) val/accuracy tensor(0.0122)
epoch 3 train/loss tensor(5.8319) train/accuracy tensor(0.0522) train/lr 1.7445312499999999 val/loss tensor(5.9276) val/accuracy tensor(0.0493)
epoch 4 train/loss tensor(5.5411) train/accuracy tensor(0.0807) train/lr 2.322265625 val/loss tensor(6.1004) val/accuracy tensor(0.0575)
epoch 5 train/loss tensor(5.3003) train/accuracy tensor(0.1092) train/lr 2.586728395061728 val/loss tensor(5.6481) val/accuracy tensor(0.0879)
epoch 6 train/loss tensor(5.0357) train/accuracy tensor(0.1447) train/lr 2.526222222222222 val/loss tensor(5.0737) val/accuracy tensor(0.1417)
epoch 7 train/loss tensor(4.7676) train/accuracy tensor(0.1826) train/lr 2.4664320987654325 val/loss tensor(5.1085) val/accuracy tensor(0.1397)
epoch 8 train/loss tensor(4.5605) train/accuracy tensor(0.2155) train/lr 2.4073580246913577 val/loss tensor(4.9470) val/accuracy tensor(0.1774)
epoch 9 train/loss tensor(4.3761) train/accuracy tensor(0.2466) train/lr 2.349 val/loss tensor(5.0856) val/accuracy tensor(0.1754)
epoch 10 train/loss tensor(4.2308) train/accuracy tensor(0.2727) train/lr 2.2913580246913576 val/loss tensor(5.2955) val/accuracy tensor(0.1574)
epoch 11 train/loss tensor(4.0787) train/accuracy tensor(0.2997) train/lr 2.2344320987654323 val/loss tensor(4.7630) val/accuracy tensor(0.1842)
epoch 12 train/loss tensor(3.9596) train/accuracy tensor(0.3232) train/lr 2.1782222222222223 val/loss tensor(4.3457) val/accuracy tensor(0.2579)
epoch 13 train/loss tensor(3.8410) train/accuracy tensor(0.3454) train/lr 2.1227283950617286 val/loss tensor(4.3673) val/accuracy tensor(0.2523)
epoch 14 train/loss tensor(3.7505) train/accuracy tensor(0.3643) train/lr 2.0679506172839504 val/loss tensor(4.5122) val/accuracy tensor(0.2227)
epoch 15 train/loss tensor(3.6623) train/accuracy tensor(0.3812) train/lr 2.0138888888888893 val/loss tensor(4.3754) val/accuracy tensor(0.2838)
epoch 16 train/loss tensor(3.5791) train/accuracy tensor(0.3977) train/lr 1.960543209876543 val/loss tensor(4.3390) val/accuracy tensor(0.2599)
epoch 17 train/loss tensor(3.5055) train/accuracy tensor(0.4126) train/lr 1.9079135802469136 val/loss tensor(4.0994) val/accuracy tensor(0.2985)
epoch 18 train/loss tensor(3.4470) train/accuracy tensor(0.4253) train/lr 1.8560000000000003 val/loss tensor(4.0175) val/accuracy tensor(0.3131)
epoch 19 train/loss tensor(3.3808) train/accuracy tensor(0.4392) train/lr 1.8048024691358022 val/loss tensor(3.9952) val/accuracy tensor(0.3286)
epoch 20 train/loss tensor(3.3362) train/accuracy tensor(0.4496) train/lr 1.754320987654321 val/loss tensor(3.8270) val/accuracy tensor(0.3449)
epoch 21 train/loss tensor(3.2784) train/accuracy tensor(0.4609) train/lr 1.7045555555555554 val/loss tensor(3.9017) val/accuracy tensor(0.3406)
epoch 22 train/loss tensor(3.2285) train/accuracy tensor(0.4718) train/lr 1.655506172839506 val/loss tensor(3.7223) val/accuracy tensor(0.3666)
epoch 23 train/loss tensor(3.1883) train/accuracy tensor(0.4811) train/lr 1.6071728395061728 val/loss tensor(3.5211) val/accuracy tensor(0.4001)
epoch 24 train/loss tensor(3.1333) train/accuracy tensor(0.4928) train/lr 1.5595555555555558 val/loss tensor(3.6497) val/accuracy tensor(0.3732)
epoch 25 train/loss tensor(3.0948) train/accuracy tensor(0.5019) train/lr 1.5126543209876542 val/loss tensor(3.4339) val/accuracy tensor(0.4180)
epoch 26 train/loss tensor(3.0590) train/accuracy tensor(0.5093) train/lr 1.466469135802469 val/loss tensor(3.5307) val/accuracy tensor(0.3976)
epoch 27 train/loss tensor(3.0215) train/accuracy tensor(0.5180) train/lr 1.4209999999999998 val/loss tensor(3.4696) val/accuracy tensor(0.4141)
epoch 28 train/loss tensor(2.9893) train/accuracy tensor(0.5255) train/lr 1.3762469135802469 val/loss tensor(3.3998) val/accuracy tensor(0.4219)
epoch 29 train/loss tensor(2.9531) train/accuracy tensor(0.5338) train/lr 1.33220987654321 val/loss tensor(3.3131) val/accuracy tensor(0.4525)
epoch 30 train/loss tensor(2.9178) train/accuracy tensor(0.5416) train/lr 1.2888888888888892 val/loss tensor(3.4035) val/accuracy tensor(0.4207)
epoch 31 train/loss tensor(2.8913) train/accuracy tensor(0.5483) train/lr 1.2462839506172838 val/loss tensor(3.3044) val/accuracy tensor(0.4562)
epoch 32 train/loss tensor(2.8599) train/accuracy tensor(0.5549) train/lr 1.2043950617283947 val/loss tensor(3.3185) val/accuracy tensor(0.4408)
epoch 33 train/loss tensor(2.8304) train/accuracy tensor(0.5617) train/lr 1.1632222222222222 val/loss tensor(3.1252) val/accuracy tensor(0.4942)
epoch 34 train/loss tensor(2.8038) train/accuracy tensor(0.5682) train/lr 1.1227654320987654 val/loss tensor(3.2375) val/accuracy tensor(0.4635)
epoch 35 train/loss tensor(2.7781) train/accuracy tensor(0.5743) train/lr 1.0830246913580248 val/loss tensor(3.1707) val/accuracy tensor(0.4654)
epoch 36 train/loss tensor(2.7522) train/accuracy tensor(0.5797) train/lr 1.044 val/loss tensor(3.0706) val/accuracy tensor(0.5007)
epoch 37 train/loss tensor(2.7223) train/accuracy tensor(0.5868) train/lr 1.0056913580246916 val/loss tensor(2.9941) val/accuracy tensor(0.5148)
epoch 38 train/loss tensor(2.7000) train/accuracy tensor(0.5916) train/lr 0.9680987654320986 val/loss tensor(2.8703) val/accuracy tensor(0.5383)
epoch 39 train/loss tensor(2.6770) train/accuracy tensor(0.5978) train/lr 0.9312222222222221 val/loss tensor(2.8765) val/accuracy tensor(0.5393)
epoch 40 train/loss tensor(2.6557) train/accuracy tensor(0.6024) train/lr 0.8950617283950618 val/loss tensor(2.9824) val/accuracy tensor(0.5280)
epoch 41 train/loss tensor(2.6266) train/accuracy tensor(0.6091) train/lr 0.8596172839506174 val/loss tensor(2.8305) val/accuracy tensor(0.5464)
epoch 42 train/loss tensor(2.6057) train/accuracy tensor(0.6146) train/lr 0.8248888888888889 val/loss tensor(2.8349) val/accuracy tensor(0.5581)
epoch 43 train/loss tensor(2.5843) train/accuracy tensor(0.6191) train/lr 0.7908765432098763 val/loss tensor(2.7889) val/accuracy tensor(0.5591)
epoch 44 train/loss tensor(2.5632) train/accuracy tensor(0.6242) train/lr 0.7575802469135801 val/loss tensor(2.8792) val/accuracy tensor(0.5400)
epoch 45 train/loss tensor(2.5415) train/accuracy tensor(0.6292) train/lr 0.725 val/loss tensor(2.6851) val/accuracy tensor(0.5790)
epoch 46 train/loss tensor(2.5192) train/accuracy tensor(0.6351) train/lr 0.6931358024691359 val/loss tensor(2.6654) val/accuracy tensor(0.5888)
epoch 47 train/loss tensor(2.5000) train/accuracy tensor(0.6397) train/lr 0.6619876543209875 val/loss tensor(2.6657) val/accuracy tensor(0.5873)
epoch 48 train/loss tensor(2.4838) train/accuracy tensor(0.6439) train/lr 0.6315555555555555 val/loss tensor(2.6754) val/accuracy tensor(0.5943)
epoch 49 train/loss tensor(2.4615) train/accuracy tensor(0.6490) train/lr 0.6018395061728397 val/loss tensor(2.5796) val/accuracy tensor(0.6166)
epoch 50 train/loss tensor(2.4433) train/accuracy tensor(0.6533) train/lr 0.5728395061728394 val/loss tensor(2.6840) val/accuracy tensor(0.5837)
epoch 51 train/loss tensor(2.4221) train/accuracy tensor(0.6585) train/lr 0.5445555555555556 val/loss tensor(2.5316) val/accuracy tensor(0.6220)
epoch 52 train/loss tensor(2.4027) train/accuracy tensor(0.6630) train/lr 0.5169876543209878 val/loss tensor(2.5750) val/accuracy tensor(0.6135)
epoch 53 train/loss tensor(2.3863) train/accuracy tensor(0.6673) train/lr 0.49013580246913574 val/loss tensor(2.6062) val/accuracy tensor(0.6079)
epoch 54 train/loss tensor(2.3666) train/accuracy tensor(0.6718) train/lr 0.4640000000000001 val/loss tensor(2.4711) val/accuracy tensor(0.6319)
epoch 55 train/loss tensor(2.3492) train/accuracy tensor(0.6761) train/lr 0.4385802469135801 val/loss tensor(2.4226) val/accuracy tensor(0.6464)
epoch 56 train/loss tensor(2.3300) train/accuracy tensor(0.6806) train/lr 0.4138765432098765 val/loss tensor(2.4231) val/accuracy tensor(0.6480)
epoch 57 train/loss tensor(2.3173) train/accuracy tensor(0.6839) train/lr 0.38988888888888895 val/loss tensor(2.4778) val/accuracy tensor(0.6378)
epoch 58 train/loss tensor(2.2929) train/accuracy tensor(0.6901) train/lr 0.3666172839506172 val/loss tensor(2.4167) val/accuracy tensor(0.6513)
epoch 59 train/loss tensor(2.2789) train/accuracy tensor(0.6939) train/lr 0.3440617283950617 val/loss tensor(2.4516) val/accuracy tensor(0.6486)
epoch 60 train/loss tensor(2.2637) train/accuracy tensor(0.6978) train/lr 0.3222222222222223 val/loss tensor(2.2960) val/accuracy tensor(0.6784)
epoch 61 train/loss tensor(2.2461) train/accuracy tensor(0.7019) train/lr 0.3010987654320987 val/loss tensor(2.3145) val/accuracy tensor(0.6739)
epoch 62 train/loss tensor(2.2319) train/accuracy tensor(0.7058) train/lr 0.28069135802469136 val/loss tensor(2.3222) val/accuracy tensor(0.6736)
epoch 63 train/loss tensor(2.2128) train/accuracy tensor(0.7106) train/lr 0.26100000000000007 val/loss tensor(2.3021) val/accuracy tensor(0.6787)
epoch 64 train/loss tensor(2.1994) train/accuracy tensor(0.7139) train/lr 0.24202469135802465 val/loss tensor(2.2824) val/accuracy tensor(0.6825)
epoch 65 train/loss tensor(2.1836) train/accuracy tensor(0.7181) train/lr 0.22376543209876545 val/loss tensor(2.2338) val/accuracy tensor(0.6940)
epoch 66 train/loss tensor(2.1680) train/accuracy tensor(0.7218) train/lr 0.2062222222222223 val/loss tensor(2.2119) val/accuracy tensor(0.6999)
epoch 67 train/loss tensor(2.1558) train/accuracy tensor(0.7251) train/lr 0.18939506172839501 val/loss tensor(2.1943) val/accuracy tensor(0.7025)
epoch 68 train/loss tensor(2.1410) train/accuracy tensor(0.7285) train/lr 0.17328395061728397 val/loss tensor(2.1800) val/accuracy tensor(0.7040)
epoch 69 train/loss tensor(2.1269) train/accuracy tensor(0.7323) train/lr 0.1578888888888888 val/loss tensor(2.1493) val/accuracy tensor(0.7102)
epoch 70 train/loss tensor(2.1142) train/accuracy tensor(0.7357) train/lr 0.14320987654320985 val/loss tensor(2.1371) val/accuracy tensor(0.7155)
epoch 71 train/loss tensor(2.1018) train/accuracy tensor(0.7391) train/lr 0.12924691358024695 val/loss tensor(2.1224) val/accuracy tensor(0.7208)
epoch 72 train/loss tensor(2.0909) train/accuracy tensor(0.7421) train/lr 0.11599999999999994 val/loss tensor(2.1154) val/accuracy tensor(0.7221)
epoch 73 train/loss tensor(2.0777) train/accuracy tensor(0.7452) train/lr 0.10346913580246912 val/loss tensor(2.1133) val/accuracy tensor(0.7233)
epoch 74 train/loss tensor(2.0657) train/accuracy tensor(0.7489) train/lr 0.09165432098765436 val/loss tensor(2.1082) val/accuracy tensor(0.7237)
epoch 75 train/loss tensor(2.0566) train/accuracy tensor(0.7511) train/lr 0.08055555555555552 val/loss tensor(2.1056) val/accuracy tensor(0.7271)
epoch 76 train/loss tensor(2.0462) train/accuracy tensor(0.7540) train/lr 0.07017283950617284 val/loss tensor(2.0813) val/accuracy tensor(0.7316)
epoch 77 train/loss tensor(2.0383) train/accuracy tensor(0.7561) train/lr 0.06050617283950621 val/loss tensor(2.0701) val/accuracy tensor(0.7339)
epoch 78 train/loss tensor(2.0284) train/accuracy tensor(0.7588) train/lr 0.051555555555555535 val/loss tensor(2.0662) val/accuracy tensor(0.7357)
epoch 79 train/loss tensor(2.0211) train/accuracy tensor(0.7606) train/lr 0.04332098765432099 val/loss tensor(2.0539) val/accuracy tensor(0.7383)
epoch 80 train/loss tensor(2.0132) train/accuracy tensor(0.7627) train/lr 0.035802469135802505 val/loss tensor(2.0555) val/accuracy tensor(0.7409)
epoch 81 train/loss tensor(2.0068) train/accuracy tensor(0.7646) train/lr 0.028999999999999984 val/loss tensor(2.0438) val/accuracy tensor(0.7404)
epoch 82 train/loss tensor(1.9994) train/accuracy tensor(0.7668) train/lr 0.02291358024691359 val/loss tensor(2.0435) val/accuracy tensor(0.7405)
epoch 83 train/loss tensor(1.9964) train/accuracy tensor(0.7679) train/lr 0.017543209876543186 val/loss tensor(2.0375) val/accuracy tensor(0.7412)
epoch 84 train/loss tensor(1.9918) train/accuracy tensor(0.7690) train/lr 0.012888888888888884 val/loss tensor(2.0335) val/accuracy tensor(0.7438)
epoch 85 train/loss tensor(1.9882) train/accuracy tensor(0.7697) train/lr 0.008950617283950626 val/loss tensor(2.0310) val/accuracy tensor(0.7441)
epoch 86 train/loss tensor(1.9842) train/accuracy tensor(0.7710) train/lr 0.005728395061728383 val/loss tensor(2.0305) val/accuracy tensor(0.7439)
epoch 87 train/loss tensor(1.9839) train/accuracy tensor(0.7710) train/lr 0.003222222222222221 val/loss tensor(2.0313) val/accuracy tensor(0.7430)
epoch 88 train/loss tensor(1.9815) train/accuracy tensor(0.7718) train/lr 0.0014320987654321028 val/loss tensor(2.0295) val/accuracy tensor(0.7447)
epoch 89 train/loss tensor(1.9813) train/accuracy tensor(0.7721) train/lr 0.0003580246913580222 val/loss tensor(2.0295) val/accuracy tensor(0.7449)
epoch 90 train/loss tensor(1.9795) train/accuracy tensor(0.7720) train/lr 0.0 val/loss tensor(2.0279) val/accuracy tensor(0.7439)

Training time: 0:46:44.979848
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001076  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.01 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001076
Launching rank 1 on remote node nid001077
Launching rank 2 on remote node nid001080
Launching rank 3 on remote node nid001081
Launching rank 4 on remote node nid001084
Launching rank 5 on remote node nid001085
Launching rank 6 on remote node nid001088
Launching rank 7 on remote node nid001089
Launching rank 8 on remote node nid001092
Launching rank 9 on remote node nid001264
Launching rank 10 on remote node nid001265
Launching rank 11 on remote node nid001268
Launching rank 12 on remote node nid001269
Launching rank 13 on remote node nid001341
Launching rank 14 on remote node nid001344
Launching rank 15 on remote node nid001345
Launching rank 16 on remote node nid001348
Launching rank 17 on remote node nid001349
Launching rank 18 on remote node nid001352
Launching rank 19 on remote node nid001353
Launching rank 20 on remote node nid001356
Launching rank 21 on remote node nid001357
Launching rank 22 on remote node nid001428
Launching rank 23 on remote node nid001429
Launching rank 24 on remote node nid001432
Launching rank 25 on remote node nid001433
Launching rank 26 on remote node nid001436
Launching rank 27 on remote node nid001437
Launching rank 28 on remote node nid001440
Launching rank 29 on remote node nid001441
Launching rank 30 on remote node nid001444
Launching rank 31 on remote node nid001452
Launching rank 32 on remote node nid001453
Launching rank 33 on remote node nid001456
Launching rank 34 on remote node nid001457
Launching rank 35 on remote node nid001460
Launching rank 36 on remote node nid001461
Launching rank 37 on remote node nid001464
Launching rank 38 on remote node nid001465
Launching rank 39 on remote node nid001468
Launching rank 40 on remote node nid001469
Launching rank 41 on remote node nid001472
Launching rank 42 on remote node nid001709
Launching rank 43 on remote node nid001712
Launching rank 44 on remote node nid001713
Launching rank 45 on remote node nid001716
Launching rank 46 on remote node nid001717
Launching rank 47 on remote node nid001720
Launching rank 48 on remote node nid001721
Launching rank 49 on remote node nid001724
Launching rank 50 on remote node nid001725
Launching rank 51 on remote node nid001728
Launching rank 52 on remote node nid001729
Launching rank 53 on remote node nid001741
Launching rank 54 on remote node nid001744
Launching rank 55 on remote node nid001745
Launching rank 56 on remote node nid001748
Launching rank 57 on remote node nid001749
Launching rank 58 on remote node nid001752
Launching rank 59 on remote node nid001753
Launching rank 60 on remote node nid001756
Launching rank 61 on remote node nid001757
Launching rank 62 on remote node nid001760
Launching rank 63 on remote node nid001761
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.6038) train/accuracy tensor(0.0097) train/lr 0.5890624999999999 val/loss tensor(6.9741) val/accuracy tensor(0.0041)
epoch 2 train/loss tensor(6.1604) train/accuracy tensor(0.0282) train/lr 1.166796875 val/loss tensor(6.4577) val/accuracy tensor(0.0197)
epoch 3 train/loss tensor(5.8208) train/accuracy tensor(0.0531) train/lr 1.7445312499999999 val/loss tensor(5.9843) val/accuracy tensor(0.0418)
epoch 4 train/loss tensor(5.5724) train/accuracy tensor(0.0770) train/lr 2.322265625 val/loss tensor(5.7662) val/accuracy tensor(0.0615)
epoch 5 train/loss tensor(5.3120) train/accuracy tensor(0.1066) train/lr 2.586728395061728 val/loss tensor(5.6469) val/accuracy tensor(0.0789)
epoch 6 train/loss tensor(5.0390) train/accuracy tensor(0.1429) train/lr 2.526222222222222 val/loss tensor(5.2341) val/accuracy tensor(0.1197)
epoch 7 train/loss tensor(4.8014) train/accuracy tensor(0.1766) train/lr 2.4664320987654325 val/loss tensor(5.8903) val/accuracy tensor(0.0824)
epoch 8 train/loss tensor(4.6222) train/accuracy tensor(0.2052) train/lr 2.4073580246913577 val/loss tensor(5.1593) val/accuracy tensor(0.1532)
epoch 9 train/loss tensor(4.4347) train/accuracy tensor(0.2363) train/lr 2.349 val/loss tensor(5.3481) val/accuracy tensor(0.1610)
epoch 10 train/loss tensor(4.3038) train/accuracy tensor(0.2595) train/lr 2.2913580246913576 val/loss tensor(5.1636) val/accuracy tensor(0.1675)
epoch 11 train/loss tensor(4.1626) train/accuracy tensor(0.2836) train/lr 2.2344320987654323 val/loss tensor(4.7048) val/accuracy tensor(0.2019)
epoch 12 train/loss tensor(4.0256) train/accuracy tensor(0.3091) train/lr 2.1782222222222223 val/loss tensor(4.5318) val/accuracy tensor(0.2232)
epoch 13 train/loss tensor(3.9196) train/accuracy tensor(0.3292) train/lr 2.1227283950617286 val/loss tensor(4.7782) val/accuracy tensor(0.2465)
epoch 14 train/loss tensor(3.8270) train/accuracy tensor(0.3480) train/lr 2.0679506172839504 val/loss tensor(4.9197) val/accuracy tensor(0.2067)
epoch 15 train/loss tensor(3.7407) train/accuracy tensor(0.3652) train/lr 2.0138888888888893 val/loss tensor(4.1409) val/accuracy tensor(0.2768)
epoch 16 train/loss tensor(3.6658) train/accuracy tensor(0.3801) train/lr 1.960543209876543 val/loss tensor(4.0455) val/accuracy tensor(0.2999)
epoch 17 train/loss tensor(3.5864) train/accuracy tensor(0.3952) train/lr 1.9079135802469136 val/loss tensor(4.1356) val/accuracy tensor(0.2948)
epoch 18 train/loss tensor(3.5317) train/accuracy tensor(0.4075) train/lr 1.8560000000000003 val/loss tensor(4.1701) val/accuracy tensor(0.2921)
epoch 19 train/loss tensor(3.4673) train/accuracy tensor(0.4205) train/lr 1.8048024691358022 val/loss tensor(4.0431) val/accuracy tensor(0.3269)
epoch 20 train/loss tensor(3.4016) train/accuracy tensor(0.4338) train/lr 1.754320987654321 val/loss tensor(4.0618) val/accuracy tensor(0.3005)
epoch 21 train/loss tensor(3.3566) train/accuracy tensor(0.4433) train/lr 1.7045555555555554 val/loss tensor(3.7189) val/accuracy tensor(0.3734)
epoch 22 train/loss tensor(3.3045) train/accuracy tensor(0.4547) train/lr 1.655506172839506 val/loss tensor(3.7412) val/accuracy tensor(0.3645)
epoch 23 train/loss tensor(3.2443) train/accuracy tensor(0.4683) train/lr 1.6071728395061728 val/loss tensor(3.5944) val/accuracy tensor(0.3905)
epoch 24 train/loss tensor(3.1991) train/accuracy tensor(0.4775) train/lr 1.5595555555555558 val/loss tensor(3.9197) val/accuracy tensor(0.3423)
epoch 25 train/loss tensor(3.1591) train/accuracy tensor(0.4867) train/lr 1.5126543209876542 val/loss tensor(3.6863) val/accuracy tensor(0.3682)
epoch 26 train/loss tensor(3.1137) train/accuracy tensor(0.4960) train/lr 1.466469135802469 val/loss tensor(3.5717) val/accuracy tensor(0.3862)
epoch 27 train/loss tensor(3.0779) train/accuracy tensor(0.5046) train/lr 1.4209999999999998 val/loss tensor(3.7980) val/accuracy tensor(0.3518)
epoch 28 train/loss tensor(3.0435) train/accuracy tensor(0.5123) train/lr 1.3762469135802469 val/loss tensor(3.4151) val/accuracy tensor(0.4298)
epoch 29 train/loss tensor(3.0021) train/accuracy tensor(0.5219) train/lr 1.33220987654321 val/loss tensor(3.3712) val/accuracy tensor(0.4300)
epoch 30 train/loss tensor(2.9634) train/accuracy tensor(0.5307) train/lr 1.2888888888888892 val/loss tensor(3.5908) val/accuracy tensor(0.3863)
epoch 31 train/loss tensor(2.9379) train/accuracy tensor(0.5358) train/lr 1.2462839506172838 val/loss tensor(3.3093) val/accuracy tensor(0.4406)
epoch 32 train/loss tensor(2.9061) train/accuracy tensor(0.5433) train/lr 1.2043950617283947 val/loss tensor(3.5098) val/accuracy tensor(0.3971)
epoch 33 train/loss tensor(2.8767) train/accuracy tensor(0.5501) train/lr 1.1632222222222222 val/loss tensor(3.2288) val/accuracy tensor(0.4623)
epoch 34 train/loss tensor(2.8458) train/accuracy tensor(0.5574) train/lr 1.1227654320987654 val/loss tensor(3.1952) val/accuracy tensor(0.4656)
epoch 35 train/loss tensor(2.8217) train/accuracy tensor(0.5627) train/lr 1.0830246913580248 val/loss tensor(3.1520) val/accuracy tensor(0.4771)
epoch 36 train/loss tensor(2.7909) train/accuracy tensor(0.5698) train/lr 1.044 val/loss tensor(3.2521) val/accuracy tensor(0.4521)
epoch 37 train/loss tensor(2.7640) train/accuracy tensor(0.5759) train/lr 1.0056913580246916 val/loss tensor(3.2572) val/accuracy tensor(0.4501)
epoch 38 train/loss tensor(2.7408) train/accuracy tensor(0.5817) train/lr 0.9680987654320986 val/loss tensor(3.0035) val/accuracy tensor(0.5144)
epoch 39 train/loss tensor(2.7144) train/accuracy tensor(0.5880) train/lr 0.9312222222222221 val/loss tensor(2.8808) val/accuracy tensor(0.5403)
epoch 40 train/loss tensor(2.6889) train/accuracy tensor(0.5938) train/lr 0.8950617283950618 val/loss tensor(2.9591) val/accuracy tensor(0.5253)
epoch 41 train/loss tensor(2.6662) train/accuracy tensor(0.5990) train/lr 0.8596172839506174 val/loss tensor(2.8002) val/accuracy tensor(0.5545)
epoch 42 train/loss tensor(2.6409) train/accuracy tensor(0.6050) train/lr 0.8248888888888889 val/loss tensor(2.8152) val/accuracy tensor(0.5461)
epoch 43 train/loss tensor(2.6171) train/accuracy tensor(0.6109) train/lr 0.7908765432098763 val/loss tensor(2.8102) val/accuracy tensor(0.5513)
epoch 44 train/loss tensor(2.5964) train/accuracy tensor(0.6156) train/lr 0.7575802469135801 val/loss tensor(2.7650) val/accuracy tensor(0.5672)
epoch 45 train/loss tensor(2.5789) train/accuracy tensor(0.6199) train/lr 0.725 val/loss tensor(2.8218) val/accuracy tensor(0.5562)
epoch 46 train/loss tensor(2.5534) train/accuracy tensor(0.6264) train/lr 0.6931358024691359 val/loss tensor(2.6667) val/accuracy tensor(0.5860)
epoch 47 train/loss tensor(2.5342) train/accuracy tensor(0.6310) train/lr 0.6619876543209875 val/loss tensor(2.8337) val/accuracy tensor(0.5460)
epoch 48 train/loss tensor(2.5109) train/accuracy tensor(0.6364) train/lr 0.6315555555555555 val/loss tensor(2.7419) val/accuracy tensor(0.5663)
epoch 49 train/loss tensor(2.4879) train/accuracy tensor(0.6414) train/lr 0.6018395061728397 val/loss tensor(2.5949) val/accuracy tensor(0.6046)
epoch 50 train/loss tensor(2.4725) train/accuracy tensor(0.6455) train/lr 0.5728395061728394 val/loss tensor(2.6215) val/accuracy tensor(0.6014)
epoch 51 train/loss tensor(2.4466) train/accuracy tensor(0.6517) train/lr 0.5445555555555556 val/loss tensor(2.6427) val/accuracy tensor(0.5932)
epoch 52 train/loss tensor(2.4279) train/accuracy tensor(0.6557) train/lr 0.5169876543209878 val/loss tensor(2.6375) val/accuracy tensor(0.6007)
epoch 53 train/loss tensor(2.4132) train/accuracy tensor(0.6599) train/lr 0.49013580246913574 val/loss tensor(2.5606) val/accuracy tensor(0.6173)
epoch 54 train/loss tensor(2.3923) train/accuracy tensor(0.6647) train/lr 0.4640000000000001 val/loss tensor(2.5003) val/accuracy tensor(0.6255)
epoch 55 train/loss tensor(2.3728) train/accuracy tensor(0.6697) train/lr 0.4385802469135801 val/loss tensor(2.4580) val/accuracy tensor(0.6379)
epoch 56 train/loss tensor(2.3530) train/accuracy tensor(0.6740) train/lr 0.4138765432098765 val/loss tensor(2.4167) val/accuracy tensor(0.6468)
epoch 57 train/loss tensor(2.3344) train/accuracy tensor(0.6791) train/lr 0.38988888888888895 val/loss tensor(2.4633) val/accuracy tensor(0.6407)
epoch 58 train/loss tensor(2.3162) train/accuracy tensor(0.6836) train/lr 0.3666172839506172 val/loss tensor(2.3879) val/accuracy tensor(0.6544)
epoch 59 train/loss tensor(2.2964) train/accuracy tensor(0.6888) train/lr 0.3440617283950617 val/loss tensor(2.4172) val/accuracy tensor(0.6497)
epoch 60 train/loss tensor(2.2833) train/accuracy tensor(0.6916) train/lr 0.3222222222222223 val/loss tensor(2.3707) val/accuracy tensor(0.6566)
epoch 61 train/loss tensor(2.2653) train/accuracy tensor(0.6967) train/lr 0.3010987654320987 val/loss tensor(2.3240) val/accuracy tensor(0.6726)
epoch 62 train/loss tensor(2.2474) train/accuracy tensor(0.7007) train/lr 0.28069135802469136 val/loss tensor(2.3068) val/accuracy tensor(0.6775)
epoch 63 train/loss tensor(2.2307) train/accuracy tensor(0.7054) train/lr 0.26100000000000007 val/loss tensor(2.2986) val/accuracy tensor(0.6784)
epoch 64 train/loss tensor(2.2127) train/accuracy tensor(0.7100) train/lr 0.24202469135802465 val/loss tensor(2.2461) val/accuracy tensor(0.6896)
epoch 65 train/loss tensor(2.1967) train/accuracy tensor(0.7143) train/lr 0.22376543209876545 val/loss tensor(2.2847) val/accuracy tensor(0.6791)
epoch 66 train/loss tensor(2.1822) train/accuracy tensor(0.7176) train/lr 0.2062222222222223 val/loss tensor(2.2314) val/accuracy tensor(0.6945)
epoch 67 train/loss tensor(2.1677) train/accuracy tensor(0.7213) train/lr 0.18939506172839501 val/loss tensor(2.2088) val/accuracy tensor(0.6986)
epoch 68 train/loss tensor(2.1491) train/accuracy tensor(0.7255) train/lr 0.17328395061728397 val/loss tensor(2.1936) val/accuracy tensor(0.7045)
epoch 69 train/loss tensor(2.1377) train/accuracy tensor(0.7293) train/lr 0.1578888888888888 val/loss tensor(2.1926) val/accuracy tensor(0.7051)
epoch 70 train/loss tensor(2.1230) train/accuracy tensor(0.7328) train/lr 0.14320987654320985 val/loss tensor(2.1600) val/accuracy tensor(0.7111)
epoch 71 train/loss tensor(2.1100) train/accuracy tensor(0.7365) train/lr 0.12924691358024695 val/loss tensor(2.1288) val/accuracy tensor(0.7201)
epoch 72 train/loss tensor(2.0989) train/accuracy tensor(0.7395) train/lr 0.11599999999999994 val/loss tensor(2.1392) val/accuracy tensor(0.7178)
epoch 73 train/loss tensor(2.0842) train/accuracy tensor(0.7429) train/lr 0.10346913580246912 val/loss tensor(2.1111) val/accuracy tensor(0.7237)
epoch 74 train/loss tensor(2.0724) train/accuracy tensor(0.7465) train/lr 0.09165432098765436 val/loss tensor(2.1107) val/accuracy tensor(0.7230)
epoch 75 train/loss tensor(2.0613) train/accuracy tensor(0.7492) train/lr 0.08055555555555552 val/loss tensor(2.0824) val/accuracy tensor(0.7284)
epoch 76 train/loss tensor(2.0505) train/accuracy tensor(0.7522) train/lr 0.07017283950617284 val/loss tensor(2.0822) val/accuracy tensor(0.7295)
epoch 77 train/loss tensor(2.0406) train/accuracy tensor(0.7548) train/lr 0.06050617283950621 val/loss tensor(2.0669) val/accuracy tensor(0.7321)
epoch 78 train/loss tensor(2.0317) train/accuracy tensor(0.7570) train/lr 0.051555555555555535 val/loss tensor(2.0593) val/accuracy tensor(0.7372)
epoch 79 train/loss tensor(2.0227) train/accuracy tensor(0.7596) train/lr 0.04332098765432099 val/loss tensor(2.0533) val/accuracy tensor(0.7364)
epoch 80 train/loss tensor(2.0132) train/accuracy tensor(0.7624) train/lr 0.035802469135802505 val/loss tensor(2.0453) val/accuracy tensor(0.7389)
epoch 81 train/loss tensor(2.0091) train/accuracy tensor(0.7634) train/lr 0.028999999999999984 val/loss tensor(2.0396) val/accuracy tensor(0.7426)
epoch 82 train/loss tensor(2.0016) train/accuracy tensor(0.7651) train/lr 0.02291358024691359 val/loss tensor(2.0365) val/accuracy tensor(0.7434)
epoch 83 train/loss tensor(1.9954) train/accuracy tensor(0.7671) train/lr 0.017543209876543186 val/loss tensor(2.0297) val/accuracy tensor(0.7427)
epoch 84 train/loss tensor(1.9891) train/accuracy tensor(0.7689) train/lr 0.012888888888888884 val/loss tensor(2.0257) val/accuracy tensor(0.7452)
epoch 85 train/loss tensor(1.9859) train/accuracy tensor(0.7698) train/lr 0.008950617283950626 val/loss tensor(2.0257) val/accuracy tensor(0.7453)
epoch 86 train/loss tensor(1.9825) train/accuracy tensor(0.7700) train/lr 0.005728395061728383 val/loss tensor(2.0204) val/accuracy tensor(0.7452)
epoch 87 train/loss tensor(1.9813) train/accuracy tensor(0.7712) train/lr 0.003222222222222221 val/loss tensor(2.0224) val/accuracy tensor(0.7457)
epoch 88 train/loss tensor(1.9783) train/accuracy tensor(0.7717) train/lr 0.0014320987654321028 val/loss tensor(2.0175) val/accuracy tensor(0.7460)
epoch 89 train/loss tensor(1.9782) train/accuracy tensor(0.7716) train/lr 0.0003580246913580222 val/loss tensor(2.0198) val/accuracy tensor(0.7454)
epoch 90 train/loss tensor(1.9763) train/accuracy tensor(0.7725) train/lr 0.0 val/loss tensor(2.0182) val/accuracy tensor(0.7457)

Training time: 0:46:29.140543
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.011 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001076  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.011 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001076
Launching rank 1 on remote node nid001077
Launching rank 2 on remote node nid001080
Launching rank 3 on remote node nid001081
Launching rank 4 on remote node nid001084
Launching rank 5 on remote node nid001085
Launching rank 6 on remote node nid001088
Launching rank 7 on remote node nid001089
Launching rank 8 on remote node nid001092
Launching rank 9 on remote node nid001264
Launching rank 10 on remote node nid001265
Launching rank 11 on remote node nid001268
Launching rank 12 on remote node nid001269
Launching rank 13 on remote node nid001341
Launching rank 14 on remote node nid001344
Launching rank 15 on remote node nid001345
Launching rank 16 on remote node nid001348
Launching rank 17 on remote node nid001349
Launching rank 18 on remote node nid001352
Launching rank 19 on remote node nid001353
Launching rank 20 on remote node nid001356
Launching rank 21 on remote node nid001357
Launching rank 22 on remote node nid001428
Launching rank 23 on remote node nid001429
Launching rank 24 on remote node nid001432
Launching rank 25 on remote node nid001433
Launching rank 26 on remote node nid001436
Launching rank 27 on remote node nid001437
Launching rank 28 on remote node nid001440
Launching rank 29 on remote node nid001441
Launching rank 30 on remote node nid001444
Launching rank 31 on remote node nid001452
Launching rank 32 on remote node nid001453
Launching rank 33 on remote node nid001456
Launching rank 34 on remote node nid001457
Launching rank 35 on remote node nid001460
Launching rank 36 on remote node nid001461
Launching rank 37 on remote node nid001464
Launching rank 38 on remote node nid001465
Launching rank 39 on remote node nid001468
Launching rank 40 on remote node nid001469
Launching rank 41 on remote node nid001472
Launching rank 42 on remote node nid001709
Launching rank 43 on remote node nid001712
Launching rank 44 on remote node nid001713
Launching rank 45 on remote node nid001716
Launching rank 46 on remote node nid001717
Launching rank 47 on remote node nid001720
Launching rank 48 on remote node nid001721
Launching rank 49 on remote node nid001724
Launching rank 50 on remote node nid001725
Launching rank 51 on remote node nid001728
Launching rank 52 on remote node nid001729
Launching rank 53 on remote node nid001741
Launching rank 54 on remote node nid001744
Launching rank 55 on remote node nid001745
Launching rank 56 on remote node nid001748
Launching rank 57 on remote node nid001749
Launching rank 58 on remote node nid001752
Launching rank 59 on remote node nid001753
Launching rank 60 on remote node nid001756
Launching rank 61 on remote node nid001757
Launching rank 62 on remote node nid001760
Launching rank 63 on remote node nid001761
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
epoch 1 train/loss tensor(6.5969) train/accuracy tensor(0.0100) train/lr 0.5890624999999999 val/loss tensor(6.7539) val/accuracy tensor(0.0067)
epoch 2 train/loss tensor(6.2038) train/accuracy tensor(0.0254) train/lr 1.166796875 val/loss tensor(6.4618) val/accuracy tensor(0.0157)
epoch 3 train/loss tensor(5.8623) train/accuracy tensor(0.0500) train/lr 1.7445312499999999 val/loss tensor(6.1235) val/accuracy tensor(0.0419)
epoch 4 train/loss tensor(5.6290) train/accuracy tensor(0.0722) train/lr 2.322265625 val/loss tensor(6.0097) val/accuracy tensor(0.0598)
epoch 5 train/loss tensor(5.3669) train/accuracy tensor(0.1013) train/lr 2.586728395061728 val/loss tensor(5.5927) val/accuracy tensor(0.0875)
epoch 6 train/loss tensor(5.1432) train/accuracy tensor(0.1302) train/lr 2.526222222222222 val/loss tensor(6.5182) val/accuracy tensor(0.0587)
epoch 7 train/loss tensor(4.9513) train/accuracy tensor(0.1565) train/lr 2.4664320987654325 val/loss tensor(5.5294) val/accuracy tensor(0.1116)
epoch 8 train/loss tensor(4.7827) train/accuracy tensor(0.1814) train/lr 2.4073580246913577 val/loss tensor(5.7693) val/accuracy tensor(0.1194)
epoch 9 train/loss tensor(4.6217) train/accuracy tensor(0.2068) train/lr 2.349 val/loss tensor(5.4658) val/accuracy tensor(0.1251)
epoch 10 train/loss tensor(4.4803) train/accuracy tensor(0.2310) train/lr 2.2913580246913576 val/loss tensor(5.1642) val/accuracy tensor(0.1511)
epoch 11 train/loss tensor(4.3601) train/accuracy tensor(0.2507) train/lr 2.2344320987654323 val/loss tensor(4.8713) val/accuracy tensor(0.1781)
epoch 12 train/loss tensor(4.2229) train/accuracy tensor(0.2745) train/lr 2.1782222222222223 val/loss tensor(5.1011) val/accuracy tensor(0.1721)
epoch 13 train/loss tensor(4.1360) train/accuracy tensor(0.2908) train/lr 2.1227283950617286 val/loss tensor(4.9368) val/accuracy tensor(0.1956)
epoch 14 train/loss tensor(4.0211) train/accuracy tensor(0.3116) train/lr 2.0679506172839504 val/loss tensor(4.8045) val/accuracy tensor(0.1901)
epoch 15 train/loss tensor(3.9379) train/accuracy tensor(0.3273) train/lr 2.0138888888888893 val/loss tensor(4.4735) val/accuracy tensor(0.2305)
epoch 16 train/loss tensor(3.8537) train/accuracy tensor(0.3444) train/lr 1.960543209876543 val/loss tensor(4.5306) val/accuracy tensor(0.2281)
epoch 17 train/loss tensor(3.7672) train/accuracy tensor(0.3603) train/lr 1.9079135802469136 val/loss tensor(4.6710) val/accuracy tensor(0.2451)
epoch 18 train/loss tensor(3.6988) train/accuracy tensor(0.3740) train/lr 1.8560000000000003 val/loss tensor(4.3314) val/accuracy tensor(0.2595)
epoch 19 train/loss tensor(3.6345) train/accuracy tensor(0.3869) train/lr 1.8048024691358022 val/loss tensor(4.1556) val/accuracy tensor(0.2874)
epoch 20 train/loss tensor(3.5726) train/accuracy tensor(0.4012) train/lr 1.754320987654321 val/loss tensor(4.2879) val/accuracy tensor(0.2762)
epoch 21 train/loss tensor(3.5144) train/accuracy tensor(0.4128) train/lr 1.7045555555555554 val/loss tensor(3.9690) val/accuracy tensor(0.3263)
epoch 22 train/loss tensor(3.4626) train/accuracy tensor(0.4231) train/lr 1.655506172839506 val/loss tensor(3.7972) val/accuracy tensor(0.3477)
epoch 23 train/loss tensor(3.3980) train/accuracy tensor(0.4362) train/lr 1.6071728395061728 val/loss tensor(3.9534) val/accuracy tensor(0.3108)
epoch 24 train/loss tensor(3.3463) train/accuracy tensor(0.4470) train/lr 1.5595555555555558 val/loss tensor(4.2175) val/accuracy tensor(0.2881)
epoch 25 train/loss tensor(3.2956) train/accuracy tensor(0.4577) train/lr 1.5126543209876542 val/loss tensor(3.8788) val/accuracy tensor(0.3340)
epoch 26 train/loss tensor(3.2449) train/accuracy tensor(0.4692) train/lr 1.466469135802469 val/loss tensor(3.5282) val/accuracy tensor(0.3969)
epoch 27 train/loss tensor(3.2094) train/accuracy tensor(0.4759) train/lr 1.4209999999999998 val/loss tensor(3.9012) val/accuracy tensor(0.3376)
epoch 28 train/loss tensor(3.1648) train/accuracy tensor(0.4871) train/lr 1.3762469135802469 val/loss tensor(3.7839) val/accuracy tensor(0.3483)
epoch 29 train/loss tensor(3.1211) train/accuracy tensor(0.4962) train/lr 1.33220987654321 val/loss tensor(3.5262) val/accuracy tensor(0.3913)
epoch 30 train/loss tensor(3.0803) train/accuracy tensor(0.5055) train/lr 1.2888888888888892 val/loss tensor(3.4733) val/accuracy tensor(0.4131)
epoch 31 train/loss tensor(3.0464) train/accuracy tensor(0.5128) train/lr 1.2462839506172838 val/loss tensor(3.5462) val/accuracy tensor(0.4016)
epoch 32 train/loss tensor(3.0129) train/accuracy tensor(0.5210) train/lr 1.2043950617283947 val/loss tensor(3.3258) val/accuracy tensor(0.4320)
epoch 33 train/loss tensor(2.9799) train/accuracy tensor(0.5286) train/lr 1.1632222222222222 val/loss tensor(3.3194) val/accuracy tensor(0.4412)
epoch 34 train/loss tensor(2.9450) train/accuracy tensor(0.5362) train/lr 1.1227654320987654 val/loss tensor(3.2935) val/accuracy tensor(0.4483)
epoch 35 train/loss tensor(2.9117) train/accuracy tensor(0.5438) train/lr 1.0830246913580248 val/loss tensor(3.1894) val/accuracy tensor(0.4591)
epoch 36 train/loss tensor(2.8852) train/accuracy tensor(0.5493) train/lr 1.044 val/loss tensor(3.2557) val/accuracy tensor(0.4635)
epoch 37 train/loss tensor(2.8529) train/accuracy tensor(0.5569) train/lr 1.0056913580246916 val/loss tensor(3.2045) val/accuracy tensor(0.4664)
epoch 38 train/loss tensor(2.8240) train/accuracy tensor(0.5640) train/lr 0.9680987654320986 val/loss tensor(3.1940) val/accuracy tensor(0.4792)
epoch 39 train/loss tensor(2.7967) train/accuracy tensor(0.5700) train/lr 0.9312222222222221 val/loss tensor(3.0307) val/accuracy tensor(0.5032)
epoch 40 train/loss tensor(2.7702) train/accuracy tensor(0.5761) train/lr 0.8950617283950618 val/loss tensor(3.1357) val/accuracy tensor(0.4977)
epoch 41 train/loss tensor(2.7442) train/accuracy tensor(0.5825) train/lr 0.8596172839506174 val/loss tensor(2.9923) val/accuracy tensor(0.5155)
epoch 42 train/loss tensor(2.7179) train/accuracy tensor(0.5888) train/lr 0.8248888888888889 val/loss tensor(2.8743) val/accuracy tensor(0.5428)
epoch 43 train/loss tensor(2.6902) train/accuracy tensor(0.5954) train/lr 0.7908765432098763 val/loss tensor(2.8398) val/accuracy tensor(0.5470)
epoch 44 train/loss tensor(2.6660) train/accuracy tensor(0.6006) train/lr 0.7575802469135801 val/loss tensor(2.7886) val/accuracy tensor(0.5604)
epoch 45 train/loss tensor(2.6442) train/accuracy tensor(0.6057) train/lr 0.725 val/loss tensor(2.7896) val/accuracy tensor(0.5636)
epoch 46 train/loss tensor(2.6153) train/accuracy tensor(0.6127) train/lr 0.6931358024691359 val/loss tensor(2.6828) val/accuracy tensor(0.5827)
epoch 47 train/loss tensor(2.5959) train/accuracy tensor(0.6169) train/lr 0.6619876543209875 val/loss tensor(2.8111) val/accuracy tensor(0.5580)
epoch 48 train/loss tensor(2.5731) train/accuracy tensor(0.6231) train/lr 0.6315555555555555 val/loss tensor(2.7335) val/accuracy tensor(0.5793)
epoch 49 train/loss tensor(2.5523) train/accuracy tensor(0.6276) train/lr 0.6018395061728397 val/loss tensor(2.7026) val/accuracy tensor(0.5845)
epoch 50 train/loss tensor(2.5294) train/accuracy tensor(0.6329) train/lr 0.5728395061728394 val/loss tensor(2.6849) val/accuracy tensor(0.5858)
epoch 51 train/loss tensor(2.5045) train/accuracy tensor(0.6392) train/lr 0.5445555555555556 val/loss tensor(2.6394) val/accuracy tensor(0.5987)
epoch 52 train/loss tensor(2.4855) train/accuracy tensor(0.6435) train/lr 0.5169876543209878 val/loss tensor(2.6336) val/accuracy tensor(0.6007)
epoch 53 train/loss tensor(2.4636) train/accuracy tensor(0.6488) train/lr 0.49013580246913574 val/loss tensor(2.5596) val/accuracy tensor(0.6191)
epoch 54 train/loss tensor(2.4432) train/accuracy tensor(0.6538) train/lr 0.4640000000000001 val/loss tensor(2.6211) val/accuracy tensor(0.6009)
epoch 55 train/loss tensor(2.4235) train/accuracy tensor(0.6591) train/lr 0.4385802469135801 val/loss tensor(2.4993) val/accuracy tensor(0.6275)
epoch 56 train/loss tensor(2.4024) train/accuracy tensor(0.6641) train/lr 0.4138765432098765 val/loss tensor(2.5156) val/accuracy tensor(0.6200)
epoch 57 train/loss tensor(2.3847) train/accuracy tensor(0.6683) train/lr 0.38988888888888895 val/loss tensor(2.5079) val/accuracy tensor(0.6275)
epoch 58 train/loss tensor(2.3642) train/accuracy tensor(0.6734) train/lr 0.3666172839506172 val/loss tensor(2.4814) val/accuracy tensor(0.6327)
epoch 59 train/loss tensor(2.3444) train/accuracy tensor(0.6786) train/lr 0.3440617283950617 val/loss tensor(2.4241) val/accuracy tensor(0.6459)
epoch 60 train/loss tensor(2.3269) train/accuracy tensor(0.6823) train/lr 0.3222222222222223 val/loss tensor(2.3665) val/accuracy tensor(0.6608)
epoch 61 train/loss tensor(2.3094) train/accuracy tensor(0.6864) train/lr 0.3010987654320987 val/loss tensor(2.3462) val/accuracy tensor(0.6622)
epoch 62 train/loss tensor(2.2907) train/accuracy tensor(0.6910) train/lr 0.28069135802469136 val/loss tensor(2.3416) val/accuracy tensor(0.6699)
epoch 63 train/loss tensor(2.2702) train/accuracy tensor(0.6971) train/lr 0.26100000000000007 val/loss tensor(2.3242) val/accuracy tensor(0.6740)
epoch 64 train/loss tensor(2.2550) train/accuracy tensor(0.7008) train/lr 0.24202469135802465 val/loss tensor(2.2604) val/accuracy tensor(0.6874)
epoch 65 train/loss tensor(2.2391) train/accuracy tensor(0.7048) train/lr 0.22376543209876545 val/loss tensor(2.3125) val/accuracy tensor(0.6831)
epoch 66 train/loss tensor(2.2209) train/accuracy tensor(0.7093) train/lr 0.2062222222222223 val/loss tensor(2.2675) val/accuracy tensor(0.6834)
epoch 67 train/loss tensor(2.2071) train/accuracy tensor(0.7126) train/lr 0.18939506172839501 val/loss tensor(2.2434) val/accuracy tensor(0.6919)
epoch 68 train/loss tensor(2.1900) train/accuracy tensor(0.7174) train/lr 0.17328395061728397 val/loss tensor(2.2126) val/accuracy tensor(0.6996)
epoch 69 train/loss tensor(2.1731) train/accuracy tensor(0.7212) train/lr 0.1578888888888888 val/loss tensor(2.2067) val/accuracy tensor(0.7004)
epoch 70 train/loss tensor(2.1564) train/accuracy tensor(0.7260) train/lr 0.14320987654320985 val/loss tensor(2.1824) val/accuracy tensor(0.7093)
epoch 71 train/loss tensor(2.1451) train/accuracy tensor(0.7288) train/lr 0.12924691358024695 val/loss tensor(2.1609) val/accuracy tensor(0.7117)
epoch 72 train/loss tensor(2.1310) train/accuracy tensor(0.7325) train/lr 0.11599999999999994 val/loss tensor(2.1317) val/accuracy tensor(0.7190)
epoch 73 train/loss tensor(2.1137) train/accuracy tensor(0.7367) train/lr 0.10346913580246912 val/loss tensor(2.1376) val/accuracy tensor(0.7161)
epoch 74 train/loss tensor(2.1031) train/accuracy tensor(0.7399) train/lr 0.09165432098765436 val/loss tensor(2.1199) val/accuracy tensor(0.7220)
epoch 75 train/loss tensor(2.0902) train/accuracy tensor(0.7430) train/lr 0.08055555555555552 val/loss tensor(2.1000) val/accuracy tensor(0.7280)
epoch 76 train/loss tensor(2.0806) train/accuracy tensor(0.7456) train/lr 0.07017283950617284 val/loss tensor(2.0940) val/accuracy tensor(0.7308)
epoch 77 train/loss tensor(2.0708) train/accuracy tensor(0.7488) train/lr 0.06050617283950621 val/loss tensor(2.0791) val/accuracy tensor(0.7317)
epoch 78 train/loss tensor(2.0588) train/accuracy tensor(0.7519) train/lr 0.051555555555555535 val/loss tensor(2.0818) val/accuracy tensor(0.7329)
epoch 79 train/loss tensor(2.0488) train/accuracy tensor(0.7547) train/lr 0.04332098765432099 val/loss tensor(2.0676) val/accuracy tensor(0.7359)
epoch 80 train/loss tensor(2.0403) train/accuracy tensor(0.7564) train/lr 0.035802469135802505 val/loss tensor(2.0581) val/accuracy tensor(0.7396)
epoch 81 train/loss tensor(2.0343) train/accuracy tensor(0.7585) train/lr 0.028999999999999984 val/loss tensor(2.0506) val/accuracy tensor(0.7421)
epoch 82 train/loss tensor(2.0261) train/accuracy tensor(0.7603) train/lr 0.02291358024691359 val/loss tensor(2.0470) val/accuracy tensor(0.7400)
epoch 83 train/loss tensor(2.0206) train/accuracy tensor(0.7618) train/lr 0.017543209876543186 val/loss tensor(2.0417) val/accuracy tensor(0.7414)
epoch 84 train/loss tensor(2.0154) train/accuracy tensor(0.7632) train/lr 0.012888888888888884 val/loss tensor(2.0379) val/accuracy tensor(0.7416)
epoch 85 train/loss tensor(2.0105) train/accuracy tensor(0.7648) train/lr 0.008950617283950626 val/loss tensor(2.0340) val/accuracy tensor(0.7442)
epoch 86 train/loss tensor(2.0069) train/accuracy tensor(0.7656) train/lr 0.005728395061728383 val/loss tensor(2.0300) val/accuracy tensor(0.7462)
epoch 87 train/loss tensor(2.0049) train/accuracy tensor(0.7662) train/lr 0.003222222222222221 val/loss tensor(2.0303) val/accuracy tensor(0.7452)
epoch 88 train/loss tensor(2.0026) train/accuracy tensor(0.7669) train/lr 0.0014320987654321028 val/loss tensor(2.0287) val/accuracy tensor(0.7474)
epoch 89 train/loss tensor(2.0031) train/accuracy tensor(0.7668) train/lr 0.0003580246913580222 val/loss tensor(2.0296) val/accuracy tensor(0.7464)
epoch 90 train/loss tensor(2.0014) train/accuracy tensor(0.7668) train/lr 0.0 val/loss tensor(2.0289) val/accuracy tensor(0.7458)

Training time: 0:45:38.659060
./scripts/run_imagenet.sh --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.012 --kfac-inv-update-steps=0 --epochs=90
Training command: export OMP_NUM_THREADS=4 ;  torchrun --nnodes=64 --nproc_per_node=auto --max_restarts 0 --rdzv_backend=c10d --rdzv_endpoint=nid001076  examples/torch_imagenet_resnet.py --train-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_train/ --val-dir=/pscratch/sd/s/sli/data/ILSVRC2012_img_val/ --batch-size=128 --base-lr=0.01132 --lars --trust-coef=0.012 --kfac-inv-update-steps=0 --epochs=90
Launching rank 0 on local node nid001076
Launching rank 1 on remote node nid001077
Launching rank 2 on remote node nid001080
Launching rank 3 on remote node nid001081
Launching rank 4 on remote node nid001084
Launching rank 5 on remote node nid001085
Launching rank 6 on remote node nid001088
Launching rank 7 on remote node nid001089
Launching rank 8 on remote node nid001092
Launching rank 9 on remote node nid001264
Launching rank 10 on remote node nid001265
Launching rank 11 on remote node nid001268
Launching rank 12 on remote node nid001269
Launching rank 13 on remote node nid001341
Launching rank 14 on remote node nid001344
Launching rank 15 on remote node nid001345
Launching rank 16 on remote node nid001348
Launching rank 17 on remote node nid001349
Launching rank 18 on remote node nid001352
Launching rank 19 on remote node nid001353
Launching rank 20 on remote node nid001356
Launching rank 21 on remote node nid001357
Launching rank 22 on remote node nid001428
Launching rank 23 on remote node nid001429
Launching rank 24 on remote node nid001432
Launching rank 25 on remote node nid001433
Launching rank 26 on remote node nid001436
Launching rank 27 on remote node nid001437
Launching rank 28 on remote node nid001440
Launching rank 29 on remote node nid001441
Launching rank 30 on remote node nid001444
Launching rank 31 on remote node nid001452
Launching rank 32 on remote node nid001453
Launching rank 33 on remote node nid001456
Launching rank 34 on remote node nid001457
Launching rank 35 on remote node nid001460
Launching rank 36 on remote node nid001461
Launching rank 37 on remote node nid001464
Launching rank 38 on remote node nid001465
Launching rank 39 on remote node nid001468
Launching rank 40 on remote node nid001469
Launching rank 41 on remote node nid001472
Launching rank 42 on remote node nid001709
Launching rank 43 on remote node nid001712
Launching rank 44 on remote node nid001713
Launching rank 45 on remote node nid001716
Launching rank 46 on remote node nid001717
Launching rank 47 on remote node nid001720
Launching rank 48 on remote node nid001721
Launching rank 49 on remote node nid001724
Launching rank 50 on remote node nid001725
Launching rank 51 on remote node nid001728
Launching rank 52 on remote node nid001729
Launching rank 53 on remote node nid001741
Launching rank 54 on remote node nid001744
Launching rank 55 on remote node nid001745
Launching rank 56 on remote node nid001748
Launching rank 57 on remote node nid001749
Launching rank 58 on remote node nid001752
Launching rank 59 on remote node nid001753
Launching rank 60 on remote node nid001756
Launching rank 61 on remote node nid001757
Launching rank 62 on remote node nid001760
Launching rank 63 on remote node nid001761
Collecting env info...
PyTorch version: 1.11.0
Is debug build: False
CUDA used to build PyTorch: 11.5
ROCM used to build PyTorch: N/A

OS: SUSE Linux Enterprise Server 15 SP3 (x86_64)
GCC version: (GCC) 11.2.0 20210728 (Cray Inc.)
Clang version: Could not collect
CMake version: version 3.17.0
Libc version: glibc-2.31

Python version: 3.9.7 (default, Sep 16 2021, 13:09:58)  [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.3.18-150300.59.43_11.0.51-cray_shasta_c-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.5.119
GPU models and configuration: 
GPU 0: NVIDIA A100-SXM4-40GB
GPU 1: NVIDIA A100-SXM4-40GB
GPU 2: NVIDIA A100-SXM4-40GB
GPU 3: NVIDIA A100-SXM4-40GB

Nvidia driver version: 515.48.07
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A

Versions of relevant libraries:
[pip3] kfac-pytorch==0.4.1
[pip3] numpy==1.21.2
[pip3] pytorch-lightning==1.5.10
[pip3] torch==1.11.0
[pip3] torch-cluster==1.6.0
[pip3] torch-geometric==2.0.4
[pip3] torch-scatter==2.0.9
[pip3] torch-sparse==0.6.13
[pip3] torch-tb-profiler==0.4.0
[pip3] torchinfo==1.5.2
[pip3] torchmetrics==0.7.3
[pip3] torchvision==0.12.0a0+9b5a3fe
[conda] Could not collect

Global rank 0 initialized: local_rank = 0, world_size = 256
Global rank 1 initialized: local_rank = 1, world_size = 256
Global rank 2 initialized: local_rank = 2, world_size = 256
Global rank 3 initialized: local_rank = 3, world_size = 256
Global rank 4 initialized: local_rank = 0, world_size = 256
Global rank 5 initialized: local_rank = 1, world_size = 256
Global rank 6 initialized: local_rank = 2, world_size = 256
Global rank 7 initialized: local_rank = 3, world_size = 256
Global rank 8 initialized: local_rank = 0, world_size = 256
Global rank 9 initialized: local_rank = 1, world_size = 256
Global rank 10 initialized: local_rank = 2, world_size = 256
Global rank 11 initialized: local_rank = 3, world_size = 256
Global rank 12 initialized: local_rank = 0, world_size = 256
Global rank 13 initialized: local_rank = 1, world_size = 256
Global rank 14 initialized: local_rank = 2, world_size = 256
Global rank 15 initialized: local_rank = 3, world_size = 256
Global rank 16 initialized: local_rank = 0, world_size = 256
Global rank 17 initialized: local_rank = 1, world_size = 256
Global rank 18 initialized: local_rank = 2, world_size = 256
Global rank 19 initialized: local_rank = 3, world_size = 256
Global rank 20 initialized: local_rank = 0, world_size = 256
Global rank 21 initialized: local_rank = 1, world_size = 256
Global rank 22 initialized: local_rank = 2, world_size = 256
Global rank 23 initialized: local_rank = 3, world_size = 256
Global rank 24 initialized: local_rank = 0, world_size = 256
Global rank 25 initialized: local_rank = 1, world_size = 256
Global rank 26 initialized: local_rank = 2, world_size = 256
Global rank 27 initialized: local_rank = 3, world_size = 256
Global rank 28 initialized: local_rank = 0, world_size = 256
Global rank 29 initialized: local_rank = 1, world_size = 256
Global rank 30 initialized: local_rank = 2, world_size = 256
Global rank 31 initialized: local_rank = 3, world_size = 256
Global rank 32 initialized: local_rank = 0, world_size = 256
Global rank 33 initialized: local_rank = 1, world_size = 256
Global rank 34 initialized: local_rank = 2, world_size = 256
Global rank 35 initialized: local_rank = 3, world_size = 256
Global rank 36 initialized: local_rank = 0, world_size = 256
Global rank 37 initialized: local_rank = 1, world_size = 256
Global rank 38 initialized: local_rank = 2, world_size = 256
Global rank 39 initialized: local_rank = 3, world_size = 256
Global rank 40 initialized: local_rank = 0, world_size = 256
Global rank 41 initialized: local_rank = 1, world_size = 256
Global rank 42 initialized: local_rank = 2, world_size = 256
Global rank 43 initialized: local_rank = 3, world_size = 256
Global rank 44 initialized: local_rank = 0, world_size = 256
Global rank 45 initialized: local_rank = 1, world_size = 256
Global rank 46 initialized: local_rank = 2, world_size = 256
Global rank 47 initialized: local_rank = 3, world_size = 256
Global rank 48 initialized: local_rank = 0, world_size = 256
Global rank 49 initialized: local_rank = 1, world_size = 256
Global rank 50 initialized: local_rank = 2, world_size = 256
Global rank 51 initialized: local_rank = 3, world_size = 256
Global rank 52 initialized: local_rank = 0, world_size = 256
Global rank 53 initialized: local_rank = 1, world_size = 256
Global rank 54 initialized: local_rank = 2, world_size = 256
Global rank 55 initialized: local_rank = 3, world_size = 256
Global rank 56 initialized: local_rank = 0, world_size = 256
Global rank 57 initialized: local_rank = 1, world_size = 256
Global rank 58 initialized: local_rank = 2, world_size = 256
Global rank 59 initialized: local_rank = 3, world_size = 256
Global rank 60 initialized: local_rank = 0, world_size = 256
Global rank 61 initialized: local_rank = 1, world_size = 256
Global rank 62 initialized: local_rank = 2, world_size = 256
Global rank 63 initialized: local_rank = 3, world_size = 256
Global rank 64 initialized: local_rank = 0, world_size = 256
Global rank 65 initialized: local_rank = 1, world_size = 256
Global rank 66 initialized: local_rank = 2, world_size = 256
Global rank 67 initialized: local_rank = 3, world_size = 256
Global rank 68 initialized: local_rank = 0, world_size = 256
Global rank 69 initialized: local_rank = 1, world_size = 256
Global rank 70 initialized: local_rank = 2, world_size = 256
Global rank 71 initialized: local_rank = 3, world_size = 256
Global rank 72 initialized: local_rank = 0, world_size = 256
Global rank 73 initialized: local_rank = 1, world_size = 256
Global rank 74 initialized: local_rank = 2, world_size = 256
Global rank 75 initialized: local_rank = 3, world_size = 256
Global rank 76 initialized: local_rank = 0, world_size = 256
Global rank 77 initialized: local_rank = 1, world_size = 256
Global rank 78 initialized: local_rank = 2, world_size = 256
Global rank 79 initialized: local_rank = 3, world_size = 256
Global rank 80 initialized: local_rank = 0, world_size = 256
Global rank 81 initialized: local_rank = 1, world_size = 256
Global rank 82 initialized: local_rank = 2, world_size = 256
Global rank 83 initialized: local_rank = 3, world_size = 256
Global rank 84 initialized: local_rank = 0, world_size = 256
Global rank 85 initialized: local_rank = 1, world_size = 256
Global rank 86 initialized: local_rank = 2, world_size = 256
Global rank 87 initialized: local_rank = 3, world_size = 256
Global rank 88 initialized: local_rank = 0, world_size = 256
Global rank 89 initialized: local_rank = 1, world_size = 256
Global rank 90 initialized: local_rank = 2, world_size = 256
Global rank 91 initialized: local_rank = 3, world_size = 256
Global rank 92 initialized: local_rank = 0, world_size = 256
Global rank 93 initialized: local_rank = 1, world_size = 256
Global rank 94 initialized: local_rank = 2, world_size = 256
Global rank 95 initialized: local_rank = 3, world_size = 256
Global rank 96 initialized: local_rank = 0, world_size = 256
Global rank 97 initialized: local_rank = 1, world_size = 256
Global rank 98 initialized: local_rank = 2, world_size = 256
Global rank 99 initialized: local_rank = 3, world_size = 256
Global rank 100 initialized: local_rank = 0, world_size = 256
Global rank 101 initialized: local_rank = 1, world_size = 256
Global rank 102 initialized: local_rank = 2, world_size = 256
Global rank 103 initialized: local_rank = 3, world_size = 256
Global rank 104 initialized: local_rank = 0, world_size = 256
Global rank 105 initialized: local_rank = 1, world_size = 256
Global rank 106 initialized: local_rank = 2, world_size = 256
Global rank 107 initialized: local_rank = 3, world_size = 256
Global rank 108 initialized: local_rank = 0, world_size = 256
Global rank 109 initialized: local_rank = 1, world_size = 256
Global rank 110 initialized: local_rank = 2, world_size = 256
Global rank 111 initialized: local_rank = 3, world_size = 256
Global rank 112 initialized: local_rank = 0, world_size = 256
Global rank 113 initialized: local_rank = 1, world_size = 256
Global rank 114 initialized: local_rank = 2, world_size = 256
Global rank 115 initialized: local_rank = 3, world_size = 256
Global rank 116 initialized: local_rank = 0, world_size = 256
Global rank 117 initialized: local_rank = 1, world_size = 256
Global rank 118 initialized: local_rank = 2, world_size = 256
Global rank 119 initialized: local_rank = 3, world_size = 256
Global rank 120 initialized: local_rank = 0, world_size = 256
Global rank 121 initialized: local_rank = 1, world_size = 256
Global rank 122 initialized: local_rank = 2, world_size = 256
Global rank 123 initialized: local_rank = 3, world_size = 256
Global rank 124 initialized: local_rank = 0, world_size = 256
Global rank 125 initialized: local_rank = 1, world_size = 256
Global rank 126 initialized: local_rank = 2, world_size = 256
Global rank 127 initialized: local_rank = 3, world_size = 256
Global rank 128 initialized: local_rank = 0, world_size = 256
Global rank 129 initialized: local_rank = 1, world_size = 256
Global rank 130 initialized: local_rank = 2, world_size = 256
Global rank 131 initialized: local_rank = 3, world_size = 256
Global rank 132 initialized: local_rank = 0, world_size = 256
Global rank 133 initialized: local_rank = 1, world_size = 256
Global rank 134 initialized: local_rank = 2, world_size = 256
Global rank 135 initialized: local_rank = 3, world_size = 256
Global rank 136 initialized: local_rank = 0, world_size = 256
Global rank 137 initialized: local_rank = 1, world_size = 256
Global rank 138 initialized: local_rank = 2, world_size = 256
Global rank 139 initialized: local_rank = 3, world_size = 256
Global rank 140 initialized: local_rank = 0, world_size = 256
Global rank 141 initialized: local_rank = 1, world_size = 256
Global rank 142 initialized: local_rank = 2, world_size = 256
Global rank 143 initialized: local_rank = 3, world_size = 256
Global rank 144 initialized: local_rank = 0, world_size = 256
Global rank 145 initialized: local_rank = 1, world_size = 256
Global rank 146 initialized: local_rank = 2, world_size = 256
Global rank 147 initialized: local_rank = 3, world_size = 256
Global rank 148 initialized: local_rank = 0, world_size = 256
Global rank 149 initialized: local_rank = 1, world_size = 256
Global rank 150 initialized: local_rank = 2, world_size = 256
Global rank 151 initialized: local_rank = 3, world_size = 256
Global rank 152 initialized: local_rank = 0, world_size = 256
Global rank 153 initialized: local_rank = 1, world_size = 256
Global rank 154 initialized: local_rank = 2, world_size = 256
Global rank 155 initialized: local_rank = 3, world_size = 256
Global rank 156 initialized: local_rank = 0, world_size = 256
Global rank 157 initialized: local_rank = 1, world_size = 256
Global rank 158 initialized: local_rank = 2, world_size = 256
Global rank 159 initialized: local_rank = 3, world_size = 256
Global rank 160 initialized: local_rank = 0, world_size = 256
Global rank 161 initialized: local_rank = 1, world_size = 256
Global rank 162 initialized: local_rank = 2, world_size = 256
Global rank 163 initialized: local_rank = 3, world_size = 256
Global rank 164 initialized: local_rank = 0, world_size = 256
Global rank 165 initialized: local_rank = 1, world_size = 256
Global rank 166 initialized: local_rank = 2, world_size = 256
Global rank 167 initialized: local_rank = 3, world_size = 256
Global rank 168 initialized: local_rank = 0, world_size = 256
Global rank 169 initialized: local_rank = 1, world_size = 256
Global rank 170 initialized: local_rank = 2, world_size = 256
Global rank 171 initialized: local_rank = 3, world_size = 256
Global rank 172 initialized: local_rank = 0, world_size = 256
Global rank 173 initialized: local_rank = 1, world_size = 256
Global rank 174 initialized: local_rank = 2, world_size = 256
Global rank 175 initialized: local_rank = 3, world_size = 256
Global rank 176 initialized: local_rank = 0, world_size = 256
Global rank 177 initialized: local_rank = 1, world_size = 256
Global rank 178 initialized: local_rank = 2, world_size = 256
Global rank 179 initialized: local_rank = 3, world_size = 256
Global rank 180 initialized: local_rank = 0, world_size = 256
Global rank 181 initialized: local_rank = 1, world_size = 256
Global rank 182 initialized: local_rank = 2, world_size = 256
Global rank 183 initialized: local_rank = 3, world_size = 256
Global rank 184 initialized: local_rank = 0, world_size = 256
Global rank 185 initialized: local_rank = 1, world_size = 256
Global rank 186 initialized: local_rank = 2, world_size = 256
Global rank 187 initialized: local_rank = 3, world_size = 256
Global rank 188 initialized: local_rank = 0, world_size = 256
Global rank 189 initialized: local_rank = 1, world_size = 256
Global rank 190 initialized: local_rank = 2, world_size = 256
Global rank 191 initialized: local_rank = 3, world_size = 256
Global rank 192 initialized: local_rank = 0, world_size = 256
Global rank 193 initialized: local_rank = 1, world_size = 256
Global rank 194 initialized: local_rank = 2, world_size = 256
Global rank 195 initialized: local_rank = 3, world_size = 256
Global rank 196 initialized: local_rank = 0, world_size = 256
Global rank 197 initialized: local_rank = 1, world_size = 256
Global rank 198 initialized: local_rank = 2, world_size = 256
Global rank 199 initialized: local_rank = 3, world_size = 256
Global rank 200 initialized: local_rank = 0, world_size = 256
Global rank 201 initialized: local_rank = 1, world_size = 256
Global rank 202 initialized: local_rank = 2, world_size = 256
Global rank 203 initialized: local_rank = 3, world_size = 256
Global rank 204 initialized: local_rank = 0, world_size = 256
Global rank 205 initialized: local_rank = 1, world_size = 256
Global rank 206 initialized: local_rank = 2, world_size = 256
Global rank 207 initialized: local_rank = 3, world_size = 256
Global rank 208 initialized: local_rank = 0, world_size = 256
Global rank 209 initialized: local_rank = 1, world_size = 256
Global rank 210 initialized: local_rank = 2, world_size = 256
Global rank 211 initialized: local_rank = 3, world_size = 256
Global rank 212 initialized: local_rank = 0, world_size = 256
Global rank 213 initialized: local_rank = 1, world_size = 256
Global rank 214 initialized: local_rank = 2, world_size = 256
Global rank 215 initialized: local_rank = 3, world_size = 256
Global rank 216 initialized: local_rank = 0, world_size = 256
Global rank 217 initialized: local_rank = 1, world_size = 256
Global rank 218 initialized: local_rank = 2, world_size = 256
Global rank 219 initialized: local_rank = 3, world_size = 256
Global rank 220 initialized: local_rank = 0, world_size = 256
Global rank 221 initialized: local_rank = 1, world_size = 256
Global rank 222 initialized: local_rank = 2, world_size = 256
Global rank 223 initialized: local_rank = 3, world_size = 256
Global rank 224 initialized: local_rank = 0, world_size = 256
Global rank 225 initialized: local_rank = 1, world_size = 256
Global rank 226 initialized: local_rank = 2, world_size = 256
Global rank 227 initialized: local_rank = 3, world_size = 256
Global rank 228 initialized: local_rank = 0, world_size = 256
Global rank 229 initialized: local_rank = 1, world_size = 256
Global rank 230 initialized: local_rank = 2, world_size = 256
Global rank 231 initialized: local_rank = 3, world_size = 256
Global rank 232 initialized: local_rank = 0, world_size = 256
Global rank 233 initialized: local_rank = 1, world_size = 256
Global rank 234 initialized: local_rank = 2, world_size = 256
Global rank 235 initialized: local_rank = 3, world_size = 256
Global rank 236 initialized: local_rank = 0, world_size = 256
Global rank 237 initialized: local_rank = 1, world_size = 256
Global rank 238 initialized: local_rank = 2, world_size = 256
Global rank 239 initialized: local_rank = 3, world_size = 256
Global rank 240 initialized: local_rank = 0, world_size = 256
Global rank 241 initialized: local_rank = 1, world_size = 256
Global rank 242 initialized: local_rank = 2, world_size = 256
Global rank 243 initialized: local_rank = 3, world_size = 256
Global rank 244 initialized: local_rank = 0, world_size = 256
Global rank 245 initialized: local_rank = 1, world_size = 256
Global rank 246 initialized: local_rank = 2, world_size = 256
Global rank 247 initialized: local_rank = 3, world_size = 256
Global rank 248 initialized: local_rank = 0, world_size = 256
Global rank 249 initialized: local_rank = 1, world_size = 256
Global rank 250 initialized: local_rank = 2, world_size = 256
Global rank 251 initialized: local_rank = 3, world_size = 256
Global rank 252 initialized: local_rank = 0, world_size = 256
Global rank 253 initialized: local_rank = 1, world_size = 256
Global rank 254 initialized: local_rank = 2, world_size = 256
Global rank 255 initialized: local_rank = 3, world_size = 256
