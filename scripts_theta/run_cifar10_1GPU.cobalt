#!/bin/bash
#COBALT -t 300
#COBALT -n 1
#COBALT -q full-node
#COBALT -A SuperBERT
#COBALT -O cifar10_$jobid
#COBALT -M sli@tacc.utexas.edu
#COBALT --attrs enable_ssh=1:filesystems=theta-fs0



#LARS
./scripts/run_cifar10_1GPU.sh --kfac-inv-update-steps=0 \
    --batch-size=128 --base-lr=0.1 --kfac-inv-update-step=0 --epochs=200 --lars --trust-coef=0.02
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/checkpoint_*
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/events*
#SGD
./scripts/run_cifar10_1GPU.sh --kfac-inv-update-steps=0 \
    --batch-size=128 --base-lr=0.1  --kfac-inv-update-step=0 --epochs=200 --lr-decay 100 150
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/checkpoint_*
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/events*
#KFAC
./scripts/run_cifar10_1GPU.sh
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/checkpoint_*
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/events*
#KFAC + Damping reverse decay
./scripts/run_cifar10_1GPU.sh --decay
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/checkpoint_*
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/events*
#KFAC + Damping reverse decay + LARS
./scripts/run_cifar10_1GPU.sh --decay --lars  --trust-coef=0.02
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/checkpoint_*
rm /projects/SuperBERT/sikanli/kfac_pytorch/logs/torch_cifar10/events*
